
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="In this article, we discuss how to develop a secure, scalable, messaging Java application with Kafka">
  <meta name="keywords" content="kafka, mobile app, java, Spring Framework, Spring Security, cluster, command">

  <meta property="og:description" content="In this article, we discuss how to develop a secure, scalable, messaging Java application with Kafka">
  <meta property="og:site_name" content="dzone.com">
  <meta property="og:title" content="Develop a Java Application With Kafka - DZone Java">
  <meta property="og:url" content="https://dzone.com/articles/develop-a-java-app-with-kafka">
  <meta property="og:image" content="https://dz2cdn1.dzone.com/storage/article-thumb/13118100-thumb.jpg">
  <meta property="og:type" content="article">

  <meta name="twitter:site" content="@DZoneInc">
  <meta name="twitter:image" content="https://dz2cdn1.dzone.com/storage/article-thumb/13118100-thumb.jpg">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:description" content="In this article, we discuss how to develop a secure, scalable, messaging Java application with Kafka">
  <meta name="twitter:title" content="Develop a Java Application With Kafka - DZone Java">

  <meta name="referrer" content="origin-when-cross-origin">
  <meta name="google-site-verification" content="kndbhxcupfEqWmZclhCpB6vlgOs7QSmx2UHAGGnP2mA">
  <meta name="df-verify" content="df0d76632b4543">

  <link rel="icon" type="image/x-icon" href="https://dz2cdn1.dzone.com/themes/dz20/images/favicon.png">
  <link rel="image_src" href="https://dz2cdn1.dzone.com/storage/article-thumb/13118100-thumb.jpg">
  <link rel="canonical" href="https://dzone.com/articles/develop-a-java-app-with-kafka">

  <title>Develop a Java Application With Kafka - DZone Java</title>

  <link rel="preload" href="https://fonts.dzone.com/themes/dz20/font/fontello.woff?11773374" as="font" type="font/woff" crossorigin="anonymous">

  <link rel="stylesheet" media="all" href="https://dz2cdn1.dzone.com/themes/dz20/ftl/icons.css">
  <link rel="stylesheet" media="all" href="https://dz2cdn1.dzone.com/themes/dz20/lib/static/bootstrap/bootstrap.min.css">
  <link rel="stylesheet" media="all" href="https://dz2cdn1.dzone.com/themes/dz20/ftl/article/global.css">
  <link rel="stylesheet" media="all" href="https://dz2cdn1.dzone.com/themes/dz20/ftl/header/styles.css">
</head>
<body>
<div id="ftl-header">
  <div class="container-fluid header">
    <div class="row">
      <div class="col-md-12" style="padding: 0;">
        <div class="header-top">
          <div class="header-container">
            <div class="pull-left logo-container">
              <div class="logo">
                <a class="inner" href="/">
                  <picture>
                    <source srcset="https://dz2cdn1.dzone.com/themes/dz20/images/dz_logo_2021_cropped.webp" type="image/webp">
                    <source srcset="https://dz2cdn1.dzone.com/themes/dz20/images/dz_logo_2021_cropped.png" type="image/png">
                    <img src="https://dz2cdn1.dzone.com/themes/dz20/images/dz_logo_2021_cropped.png" width="160" height="52" alt="DZone">
                  </picture>
                </a>
              </div>

                <div class="active-portal"><a href="/java-jdk-development-tutorials-tools-news">Java Zone</a></div>
            </div>

            <div class="pull-right login-and-search">
              <div id="authenticated-block" class="logged-in">
                <div class="welcome-back">Thanks for visiting DZone today,</div>
                <div id="user-header" class="user-info">
                  <button class="user-avatar">
                    <span id="header-username" class="username"></span>
                    <img id="header-avatar" src="" alt="user avatar">
                  </button>
                  <div id="user-dropdown" class="browse-user-menu">
                    <div class="user-content">
                      <a id="header-user-plug" href="#" class="user-description"></a>
                      <a id="header-user-edit" href="#" class="edit-profile">Edit Profile</a>
                    </div>
                    <ul class="user-actions">
                      <li id="first-user-action"><a id="header-dropdown-manage-email" href="#">Manage Email Subscriptions</a></li>
                      <li>
                        <a href="/articles/how-to-submit-a-post-to-dzone?utm_source=DZone&utm_medium=user_dropdown&utm_campaign=how_to_post">
                          How to Post to DZone
                        </a>
                      </li>
                      <li>
                        <a href="/articles/dzones-article-submission-guidelines">
                          Article Submission Guidelines
                        </a>
                      </li>
                    </ul>
                    <div class="bottom">
                      <a href="/users/logout.html" class="sign-out">Sign Out</a>
                      <a id="dropdown-view-profile" href="#" class="view-profile">View Profile</a>
                    </div>
                  </div>
                </div>

                <div class="post-content">
                  <button id="post-button" class="post-content--button">
                    <span class="post-class">Post</span>
                    <i class="icon-plus"></i>
                  </button>

                  <div id="post-menu" class="posting-links">
                    <div class="posting-links-menu">
                      <ul>
                        <li>
                          <img src="/themes/dz20/images/dz-postarticle.svg">
                          <a href="/content/article/post.html">Post an Article</a>
                        </li>
                        <li>
                          <a id="drafts-link" href="#">Manage My Drafts</a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>

              <div id="unauthenticated-block">
                <div class="dz-intro">Over 2 million developers have joined DZone.</div>
                <div class="mobile-invisible sign-in-join">
                  <a href="/users/login.html">Log In</a>
                  <span class="dz-intro-span">/</span>
                  <a href="/static/registration.html">Join</a>
                </div>
                <a class="join-icon" href="/users/login.html"><i class="icon-user"></i></a>
              </div>
              <div class="headerSearch">
                <a class="icon-search dropdown-toggle" href="/search"></a>
              </div>
            </div>
          </div>
        </div>

        <div class="header-bottom">


          <ul class="portals header-container scrollable-ul">
            <li>
              <a href="/refcardz" id="header-refcardz">
                <em>Refcardz</em>
              </a>
            </li>
            <li>
              <a href="/trendreports" id="header-research">
                <em>Trend Reports</em>
              </a>
            </li>
            <li>
              <a href="/webinars" id="header-webinars">
                <em>Webinars</em>
              </a>
            </li>
            <li class="last-portal-link">
              <a href="#" id="header-portals">
                <em>
                  Zones
                  <span id="zone-arrow" class="collapsible-toggle">
                    <i class="icon-angle-down"></i>
                    <i class="icon-angle-up"></i>
                  </span>
                </em>
              </a>
            </li>

            <li class="separator" aria-hidden="true" style="color: #d9dcdd;">|</li>
            <li id="portal-list" class="portal-topics">
              <ul>
                  <li>
                    <a href="/agile-methodology-training-tools-news" id="header-2">Agile</a>
                  </li>
                  <li>
                    <a href="/artificial-intelligence-tutorials-tools-news" id="header-4001">AI</a>
                  </li>
                  <li>
                    <a href="/big-data-analytics-tutorials-tools-news" id="header-3">Big Data</a>
                  </li>
                  <li>
                    <a href="/cloud-computing-tutorials-tools-news" id="header-4">Cloud</a>
                  </li>
                  <li>
                    <a href="/database-sql-nosql-tutorials-tools-news" id="header-5">Database</a>
                  </li>
                  <li>
                    <a href="/devops-tutorials-tools-news" id="header-6">DevOps</a>
                  </li>
                  <li>
                    <a href="/enterprise-integration-training-tools-news" id="header-7">Integration</a>
                  </li>
                  <li>
                    <a href="/iot-developer-tutorials-tools-news-reviews" id="header-8">IoT</a>
                  </li>
                  <li>
                    <a href="/java-jdk-development-tutorials-tools-news" id="header-1">Java</a>
                  </li>
                  <li>
                    <a href="/microservices-news-tutorials-tools" id="header-6001">Microservices</a>
                  </li>
                  <li>
                    <a href="/open-source-news-tutorials-tools" id="header-7001">Open Source</a>
                  </li>
                  <li>
                    <a href="/apm-tools-performance-monitoring-optimization" id="header-10">Performance</a>
                  </li>
                  <li>
                    <a href="/application-web-network-security" id="header-2001">Security</a>
                  </li>
                  <li>
                    <a href="/web-development-programming-tutorials-tools-news" id="header-11">Web Dev</a>
                  </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<script async src="https://dz2cdn1.dzone.com/themes/dz20/ftl/header/bundle.js"></script><link rel="stylesheet" media="all" href="https://dz2cdn1.dzone.com/themes/dz20/ftl/article/styles.css">




<div id="ftl-article" >
  <div class="container-fluid body">
    <div class="row">
      <div class="col-md-12">
        <div class="articles-wrap">
              <div class="ad-container">
                <div id="div-gpt-ad-1435246566686-0" class="ads-billboard-article" data-gpt-slot="top"></div>
              </div>


          <div class="article-stream widget-top-border">
                <div class="content-right-images">
                  <div id="div-gpt-ad-1435246566686-2" class="sidebar-ad" data-gpt-desktop="true" data-gpt-slot="sidebar1"></div>
                </div>

                <script type="application/ld+json">
                  {
                    "@context": "http://schema.org",
                    "@type": "Article",
                    "headline": "Develop a Java Application With Kafka",
                    "author": {
                      "@type": "Person",
                      "name": "Daniel Pereira"
                    },
                    "audience": "software developers",
                    "keywords": "oauth,tutorial,authentication,java,kafka,spring boot,big data",
                    "timeRequired": "PT12M",
                    "commentCount": 1,
                    "wordCount": "2929",
                    "accessMode": "textual, visual",
                    "dateCreated": "2020-03-11T12:40:28Z",
                    "datePublished": "2020-03-11T00:00:00Z",
                    "dateModified": "2020-06-09T13:29:46Z",
                    "articleSection": "java-jdk-development-tutorials-tools-news",
                    "publisher": {
                      "@type": "Organization",
                      "name": "DZone",
                      "url": "https://dzone.com",
                      "logo": {
                        "@type": "ImageObject",
                        "url": "https://dzone.com/themes/dz20/images/dz_logo_2021_cropped.png"
                      }
                    },
                    "articleBody": "Today’s app users demand the very best user experience. They are accustomed to accessing their apps from all their devices (computers, mobile phones, tablets, etc). As platforms continue to transition to Software as a Service (SaaS), developers are constantly collaborating with powerful tools that scope to handle thousands of requests every second. This is where Apache Kafka, a robust tool that is known for handling highly intense environments, comes in. In this post, we’ll introduce you to the basics of Apache Kafka and move on to building a secure, scalable messaging app with Java and Kafka. Prerequisites: Java 8+, an internet connection, and a free Okta developer account. A Brief Overview of Apache Kafka Apache Kafka is a distributed streaming platform that utilizes the publish/subscribe message pattern to interact with applications; it’s designed to create durable messages. Let’s break down those concepts in more detail. Distributed Streaming Platform When you want to run Kafka, you need to start its broker: a simple instance of Kafka running on a machine, just like any other server. The broker is responsible to send, receive, and store messages into the disk. A single broker is not enough to ensure Kafka can handle a high-throughput of messages. That goal is achieved through many brokers working together at the same time, communicating and coordinating with each other. A Kafka cluster groups together one or more brokers. Instead of connecting to a single node, your application connects to a cluster that manages all the distributed details for you. You may also like: A Kafka Tutorial for Everyone, no Matter Your Stage in Development. Publish/Subscribe Messaging System With Durable Messages The publish/subscribe is a common pattern in distributed systems. The image below illustrates the basic structure of this pattern within Kafka: Kafka Producers and Consumers The image includes two components not mentioned so far: Producers and Consumers. A Producer is an application that sends messages to the cluster. In this example, Producer 1, 2, and 3 are sending messages. The cluster then elects which broker should store them and sends it to the ones selected. On the other side, you have consumers. A consumer is an application that connects to the cluster and receives the messages posted from producers. Any application that is interested in consuming messages sent by producers must connect into the Kafka consumer. As Kafka stores messages for long durations (the default value is seven days), you can have many consumers receiving the same message even if they were not there when the message was sent! Kafka Topics When you send a message to a Kafka broker, you need to specify where the message will be sent by specifying a topic. A topic is a category of messages that a consumer can subscribe to. This mechanism ensures that consumers only receive messages relevant to them, rather than receiving every message published to the cluster. Now that you understand Kafka’s basic architecture, let’s download and install it. Install and Run Kafka To download Kafka, go to the Kafka website. Extract the contents of this compressed file into a folder of your preference. Inside the Kafka directory, go to the bin folder. Here, you’ll find many bash scripts that will be useful for running a Kafka application. If you are using Windows, you also have the same scripts inside the windows folder. This tutorial uses Linux commands, but you just need to use the equivalent Windows version if you’re running a Microsoft OS. Start Zookeeper to Manage Your Kafka Cluster Apache Kafka is always run as a distributed application. This means your cluster has to deal with some distributed challenges along the way, like synchronizing configurations or electing a leader to take care of the cluster. Kafka uses Zookeeper to keep track of those details. Don’t worry about downloading it, though. Kafka already ships with Zookeeper, allowing you to get up and running very fast. Let’s start a Zookeeper instance! Inside the bin folder in your Kafka directory, run the following command: Shell x 1 ./zookeeper-server-start.sh ../config/zookeeper.properties This command starts a Zookeeper server on port 2181 by default. Zookeeper is responsible to coordinate the Kafka brokers inside your cluster. You’ll use the default configurations inside the Kafka project for this tutorial, but you can always change those values as needed. Run a Kafka Broker The next step is to run the broker itself. From another terminal, run the following command from the bin folder: Shell xxxxxxxxxx 1 1 ./kafka-server-start.sh ../config/server.properties As you might have guessed, this command runs the Kafka server with the default configurations on the default port, 9092. Create a Kafka Topic Now that you have the broker and Zookeeper running, you can specify a topic to start sending messages from a producer. You’re going to run a command inside the bin folder, just like you did in the previous steps: Shell xxxxxxxxxx 1 1 ./kafka-topics.sh --create --topic myTopic -zookeeper \\ 2 localhost:2181 --replication-factor 1 --partitions 1 This command creates a topic named myTopic pointing to the Zookeeper instance you started with the first command. There are also two different parameters you have to specify: replication-factor and partitions. Don’t worry about them right now; they are used to control specific aspects related to distributed systems in Kafka. As you are running a simple setup, you can specify “1” for both parameters. Now that you have everything up and running, you can start integrating Kafka with a Java application! Create a Java + Kafka Application Let’s start with the project structure, using Spring Initializer to create the application. Go to https://start.spring.io and fill in the following information: Project: Maven Project. Language: Java. Group: com.okta.javakafka Artifact: kafka-java Dependencies: Spring Web. Spring for Apache Kafka. You can also generate the project using the command line. Paste the following command in your terminal, and it will download the project with the same configurations defined above: Shell xxxxxxxxxx 1 1 curl https://start.spring.io/starter.zip -d language=java \\ 2 -d dependencies=web,kafka \\ 3 -d packageName=com.okta.javakafka \\ 4 -d name=kafka-java \\ 5 -d type=maven-project \\ 6 -o kafka-java.zip This tutorial uses Maven, but you can easily follow it with Gradle if you prefer. That’s it! Now, your Java project structure is created, and you can start developing your app. Push Messages to a Kafka Topic in Your Java App The first step to create a producer that can push messages is to configure the producers inside your Java application. Let’s create a configuration class to do just that. Create a src/main/java/com/okta/javakafka/configuration folder, and a ProducerConfiguration class in it: Java xxxxxxxxxx 1 38 1 import org.apache.kafka.clients.producer.ProducerConfig; 2 import org.apache.kafka.common.serialization.StringSerializer; 3 import org.springframework.context.annotation.Bean; 4 import org.springframework.context.annotation.Configuration; 5 import org.springframework.kafka.core.DefaultKafkaProducerFactory; 6 import org.springframework.kafka.core.KafkaTemplate; 7 import org.springframework.kafka.core.ProducerFactory; 8 9 import java.util.HashMap; 10 import java.util.Map; 11 12 @Configuration 13 public class ProducerConfiguration { 14 15 private static final String KAFKA_BROKER = \"localhost:9092\"; 16 17 @Bean 18 public ProducerFactory&lt;String, String&gt; producerFactory() { 19 return new DefaultKafkaProducerFactory&lt;&gt;(producerConfigurations()); 20 } 21 22 @Bean 23 public Map&lt;String, Object&gt; producerConfigurations() { 24 Map&lt;String, Object&gt; configurations = new HashMap&lt;&gt;(); 25 26 configurations.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, KAFKA_BROKER); 27 configurations.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class); 28 configurations.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class); 29 30 return configurations; 31 } 32 33 @Bean 34 public KafkaTemplate&lt;String, String&gt; kafkaTemplate() { 35 return new KafkaTemplate&lt;&gt;(producerFactory()); 36 } 37 38 } This class creates a ProducerFactory which knows how to create producers based on the configurations you provided. You’ve also specified to connect to your local Kafka broker and to serialize both the key and the values with String. You also declared a KafkaTemplate bean to perform high-level operations on your producer. In other words, the template is able to do operations such as sending a message to a topic and efficiently hides under-the-hood details from you. The next step is to create the endpoint to send the message to the producer. Inside the src/main/java/com/okta/javakafka/controller package, create the following class: Java x 21 1 import org.springframework.kafka.core.KafkaTemplate; 2 import org.springframework.web.bind.annotation.GetMapping; 3 import org.springframework.web.bind.annotation.RequestParam; 4 import org.springframework.web.bind.annotation.RestController; 5 6 import java.util.List; 7 8 @RestController 9 public class KafkaController { 10 11 private KafkaTemplate&lt;String, String&gt; template; 12 13 public KafkaController(KafkaTemplate&lt;String, String&gt; template) { 14 this.template = template; 15 } 16 17 @GetMapping(\"/kafka/produce\") 18 public void produce(@RequestParam String message) { 19 template.send(\"myTopic\", message); 20 } 21 Note: Since you’re sending data to be processed, the produce() method really ought to be a POST. For demo purposes, it’s easier to leave it as a GET so you can exercise it in the browser. As you can see, this endpoint is very simple. It injects the KafkaTemplate configured earlier and sends a message to myTopic when a GET request is made to /kafka/produce. Let’s test if everything is working as expected. Run the main method inside the JavaKafkaApplication class. To run from the command line, execute the following command: Shell xxxxxxxxxx 1 1 ./mvnw spring-boot:run Your server should be running on port 8080, and you can already make API requests against it! Go to your web browser and access http://localhost:8080/kafka/produce?message=This is my message. When you make a call with the command above, your application will execute the /kafka/produce endpoint, which sends a message to myTopic topic inside Kafka. But how do you know the command successfully sent a message to the topic? Right now, you don’t consume messages inside your app, which means you cannot be sure! Fortunately, there is an easy way to create a consumer to test right away. Inside the bin folder of your Kafka directory, run the following command: Shell xxxxxxxxxx 1 1 ./kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic myTopic Access http://localhost:8080/kafka/produce?message=This is my message again to see the following message in the terminal running the Kafka consumer: Shell xxxxxxxxxx 1 1 This is my message Great job! You can stop this command for now. Instead of executing from a terminal, let’s add some Java code to consume the messages inside your app. Consume Messages From a Kafka Topic in a Java App As with the producer, you need to add configurations to enable the consumer to find the Kafka Broker. Inside the src/main/java/com/okta/javakafka/configuration create the following class: Java xxxxxxxxxx 1 42 1 import org.apache.kafka.clients.consumer.ConsumerConfig; 2 import org.apache.kafka.common.serialization.StringDeserializer; 3 import org.springframework.context.annotation.Bean; 4 import org.springframework.context.annotation.Configuration; 5 import org.springframework.kafka.config.ConcurrentKafkaListenerContainerFactory; 6 import org.springframework.kafka.core.ConsumerFactory; 7 import org.springframework.kafka.core.DefaultKafkaConsumerFactory; 8 9 import java.util.HashMap; 10 import java.util.Map; 11 12 @Configuration 13 public class ConsumerConfiguration { 14 15 private static final String KAFKA_BROKER = \"localhost:9092\"; 16 private static final String GROUP_ID = \"kafka-sandbox\"; 17 18 @Bean 19 public ConsumerFactory&lt;String, String&gt; consumerFactory() { 20 return new DefaultKafkaConsumerFactory&lt;&gt;(consumerConfigurations()); 21 } 22 23 @Bean 24 public Map&lt;String, Object&gt; consumerConfigurations() { 25 Map&lt;String, Object&gt; configurations = new HashMap&lt;&gt;(); 26 27 configurations.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, KAFKA_BROKER); 28 configurations.put(ConsumerConfig.GROUP_ID_CONFIG, GROUP_ID); 29 configurations.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class); 30 configurations.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class); 31 32 return configurations; 33 } 34 35 @Bean 36 ConcurrentKafkaListenerContainerFactory&lt;String, String&gt; kafkaListenerContainerFactory() { 37 ConcurrentKafkaListenerContainerFactory&lt;String, String&gt; factory = new ConcurrentKafkaListenerContainerFactory&lt;&gt;(); 38 factory.setConsumerFactory(consumerFactory()); 39 return factory; 40 } 41 42 } The code above creates a factory that knows how to connect to your local broker. It also configures your consumer to deserialize a String for both the key and the value, matching the producer configuration. The Group ID is mandatory and used by Kafka to allow parallel data consumption. The ConcurrentKafkaListenerContainerFactory bean allows your app to consume messages in more than one thread. Now that your Java app is configured to find consumers inside your Kafka broker, let’s start listening to the messages sent to the topic. Create a src/main/java/com/okta/javakafka/consumer directory, and the following class in it: Java xxxxxxxxxx 1 23 1 import org.springframework.kafka.annotation.KafkaListener; 2 import org.springframework.stereotype.Component; 3 4 import java.util.ArrayList; 5 import java.util.List; 6 7 @Component 8 public class MyTopicConsumer { 9 10 private final List&lt;String&gt; messages = new ArrayList&lt;&gt;(); 11 12 @KafkaListener(topics = \"myTopic\", groupId = \"kafka-sandbox\") 13 public void listen(String message) { 14 synchronized (messages) { 15 messages.add(message); 16 } 17 } 18 19 public List&lt;String&gt; getMessages() { 20 return messages; 21 } 22 23 } This class is responsible for listening to changes inside the myTopic topic. It does so by using the KafkaListener annotation. Every time a new message is sent from a producer to the topic, your app receives a message inside this class. It adds a message to the list of messages received, making it available to other classes through the getMessages() method. Next, let’s create an endpoint that displays a list of consumed messages. Go back to the KafkaController to add MyTopicConsumer as a dependency and a getMessages() method. Java xxxxxxxxxx 1 30 1 import com.okta.javakafka.consumer.MyTopicConsumer; 2 import org.springframework.kafka.core.KafkaTemplate; 3 import org.springframework.web.bind.annotation.GetMapping; 4 import org.springframework.web.bind.annotation.RequestParam; 5 import org.springframework.web.bind.annotation.RestController; 6 7 import java.util.List; 8 9 @RestController 10 public class KafkaController { 11 12 private KafkaTemplate&lt;String, String&gt; template; 13 private MyTopicConsumer myTopicConsumer; 14 15 public KafkaController(KafkaTemplate&lt;String, String&gt; template, MyTopicConsumer myTopicConsumer) { 16 this.template = template; 17 this.myTopicConsumer = myTopicConsumer; 18 } 19 20 @GetMapping(\"/kafka/produce\") 21 public void produce(@RequestParam String message) { 22 template.send(\"myTopic\", message); 23 } 24 25 @GetMapping(\"/kafka/messages\") 26 public List&lt;String&gt; getMessages() { 27 return myTopicConsumer.getMessages(); 28 } 29 30 } This class now has a new endpoint to display the messages stored in your consumer. When this endpoint is called, it sends the current messages it already processed from the Kafka topic. Your Java app now has both a Kafka producer and a consumer, so let’s test it all together! Restart your application, and go to http://localhost:8080/kafka/messages. Right now, no information is being returned. The reason is pretty simple: your consumer is configured only to receive new messages and you haven’t sent a new message yet. Let’s fix this problem by going to your web browser and accessing http://localhost:8080/kafka/produce?message=Message sent by my App!. When Kafka receives the message, it will let your consumer know about it right away. Go ahead and go to http://localhost:8080/kafka/messages in your browser. You will now see that your message was successfully received! Message successfully retrieved Great job! You have a Java app capable of producing and consuming messages from Kafka! Before we call it a day though, there is one last step and it’s a very important one. Secure Your Java Kafka Application Your app is not very secure right now. Although you are prepared to handle many messages in a distributed environment, those messages are still available to anyone who can find the link to your endpoints. This is a critical vulnerability, so let’s make sure it’s addressed the right way. You’re going to use OAuth 2.0 to make sure only authenticated users can see your endpoints. The best part? It’s going to take only 5 minutes to add this feature in your app by using Okta to authenticate your users! Create an Okta Account If you don’t already have an Okta account, go ahead and create one. After completing registration, go through the following steps: Login to your account. Go to Applications &gt; Add Application. You will be redirected to the following page: Adding application to Okta account Select Web and click Next. Fill in the following options in the form: Name: Bootiful Kafka Base URIs: http://localhost:8080 Login redirect URLs: http://localhost:8080/login/oauth2/code/okta Click Done. Now that you have your Okta application, you can use it to authenticate users in your Java + Kafka app. Secure Your Java App With User Auth Let’s start by adding Okta’s library to your project. Open your pom.xml and add the following dependency inside the &lt;dependencies&gt; tag: XML xxxxxxxxxx 1 1 &lt;dependency&gt; 2 &lt;groupId&gt;com.okta.spring&lt;/groupId&gt; 3 &lt;artifactId&gt;okta-spring-boot-starter&lt;/artifactId&gt; 4 &lt;version&gt;1.3.0&lt;/version&gt; 5 &lt;/dependency&gt; This library will integrate with the Okta app you just created. It will also add Spring Security to your current application. Configure it with the following variables in src/main/resources/application.properties: Properties files xxxxxxxxxx 1 1 okta.oauth2.issuer: https://{yourOktaDomain}/oauth2/default 2 okta.oauth2.client-id: {yourClientID} 3 okta.oauth2.client-secret: {yourClientSecret} IMPORTANT: This file should only be used locally. Do not commit your client’s secret to Git or any other Version Control System. To avoid accidentally exposing these credentials, you can also specify your Okta application’s values as environment variables. Create an okta.env file in the root directory of your app with the following environment variables. Then run source okta.env before starting your app. Shell xxxxxxxxxx 1 1 export OKTA_OAUTH2_ISSUER=https://{yourOktaDomain}/oauth2/default 2 export OKTA_OAUTH2_CLIENT_ID={yourClientID} 3 export OKTA_OAUTH2_CLIENT_SECRET={yourClientSecret} You can find {yourClientID} and {yourClientSecret} in the Okta UI’s applications page. To access it, follow the steps below: In your Okta menu, go to Applications. Select the Bootiful Kafka application. Click on the General tab. You should see both values inside the Client Credentials area. Retrieving client credentials The value {yourOktaDomain} for will be visible in your Okta dashboard, just click on the Dashboard on the menu. You will see the Org URL in the right upper corner. That’s it! Restart your Spring Boot application and go to http://localhost:8080/kafka/messages. Your app will now redirect you to the login page: Final sign-in page NOTE: If you’re not prompted to log in, it’s because you’re already logged in. Open your app in an incognito window, and you’ll see the login screen shown above. Enter your username and password. If your login attempt is successful, you’ll be redirected back to your application again. Congratulations! You now have a secure Java application that can produce and consume messages from Kafka. If you want to check out the complete source code for this tutorial, head over to oktadeveloper/okta-java-kafka-example on GitHub. Want to learn more about Java, security, and OAuth 2.0? Here are a few links you might be interested in: OAuth 2.0 Java Guide: Secure Your App in 5 Minutes An Illustrated Guide to OAuth and OpenID Connect Secure Reactive Microservices with Spring Cloud Gateway For more articles like this one, follow @oktadev on Twitter. We also regularly publish screencasts to our YouTube channel! Further Reading Kafka Architecture. How to Setup a Kafka Cluster. An Overview of the Kafka Distributed Message System (Part 2).",
                    "mainEntityOfPage": {
                      "@type": "WebPage",
                      "@id": "https://dzone.com/articles/develop-a-java-app-with-kafka"
                    },
                    "image": {
                      "@type": "ImageObject",
                      "url": "https://dzone.com//dz2cdn1.dzone.com/storage/article-thumb/13118100-thumb.jpg"
                    }
                  }
                </script>

                  <script type="application/ld+json">
                    {
                      "@context": "https://schema.org",
                      "@type": "BreadcrumbList",
                      "itemListElement": [{
                        "@type": "ListItem",
                        "position": 1,
                        "name": "DZone",
                        "item": "https://dzone.com"
                      }, {
                        "@type": "ListItem",
                        "position": 2,
                        "name": "Java Zone",
                        "item": "https://dzone.com/java-jdk-development-tutorials-tools-news"
                      }, {
                        "@type": "ListItem",
                        "position": 3,
                        "name": "Develop a Java Application With Kafka",
                        "item": "https://dzone.com/articles/develop-a-java-app-with-kafka"
                      }]
                    }
                  </script>

            <article>
              <div class="content">
                <div class="header">
                  <div class="col-xs-12 breadcrumb-padding">
                    <a href="/">DZone</a>
                    >
                      <a href="/java-jdk-development-tutorials-tools-news">Java Zone</a>
                      >
                      <a href="#">Develop a Java Application With Kafka</a>
                  </div>


                  <div class="header-title">
                    <div class="title">
                      <h1 class="article-title">Develop a Java Application With Kafka</h1>
                    </div>

                    <div class="subhead">
                      <h3></h3>
                    </div>

                    <div class="publish-meta">
                        <div class="article-author-meta">
                          <img src="https://dz2cdn2.dzone.com/thumbnail?fid=12565046&w=80" class="avatar" alt="Daniel Pereira user avatar" width="40">
                          by

                          <div class="author-info">
                            <span class="author-name">
                              <a href="/users/3948972/denieus.html" rel="nofollow">Daniel Pereira</a>
                            </span>
                          </div>




                          &middot;
                        </div>
                      <span class="author-date">
                        Mar. 11, 20
                      </span>
                      &middot;
                        <a href="/java-jdk-development-tutorials-tools-news" id="portal-name">
                          <span class="portal-name">Java Zone</span>
                        </a>
                      &middot;
                      <span>Tutorial</span>
                    </div>
                  </div>
                </div>

                <div class="author-n-useraction">
                  <div class="like action">
                    <div id="activity-like-icon" class="dz-like icon-thumbs-up">
                      <span class="action-label">
                        <span id="activity-like-text">Like</span>
                      </span>
                      <a href="#">
                        <span id="activity-like-counter">(11)</span>
                      </a>
                    </div>
                  </div>

                  <div class="action">

                    <button class="comment">
                      <i class="icon-comment"></i>
                      Comment
                      <span id="activity-comment-counter" class="comment-count"></span>
                    </button>
                  </div>

                  <div class="save action">
                    <div id="activity-save-icon" class="save icon-star-empty">
                      <span id="activity-save-text" class="action-label">Save</span>
                    </div>
                  </div>

                  <div class="tweet action">
                    <a id="tweet-link" href="" class="title" target="_blank">
                      <span><i class="icon-twitter"></i></span>
                      <span class="action-label">Tweet</span>
                    </a>
                  </div>

                  <div class="pull-right">
                    <div id="activity-view-container" class="article-views action">
                      <i class="icon-eye"></i> 45.43K
                      <span class="action-label">Views</span>
                    </div>
                  </div>
                </div>

                    <div class="signin-prompt">
                      <p>Join the DZone community and get the full member experience.</p>
                      <a id="article-signin-prompt" href="/static/registration.html">Join For Free</a>
                    </div>
                    <div class="arrow-down"></div>

                  <div id="top-bumper-container"></div>

                <div>
                  <div class="content-html"><p dir="ltr"><img src="https://dz2cdn1.dzone.com/storage/temp/12890982-pic-woman-texting-iphone.jpg" style="width: 700px; display: block; vertical-align: top; margin: 5px auto; text-align: center;" data-image="true" data-new="false" data-sizeformatted="119.8 kB" data-mimetype="image/jpeg" data-creationdate="1577976636451" data-creationdateformatted="01/02/2020 02:50 PM" data-type="temp" data-url="/storage/temp/12890982-pic-woman-texting-iphone.jpg" data-modificationdate="null" data-size="119839" data-name="pic-woman-texting-iphone.jpg" data-id="12890982"></p> 
<p dir="ltr">Today’s app users demand the very best user experience. They are accustomed to accessing their apps from all their devices (computers, mobile phones, tablets, etc). As platforms continue to transition to Software as a Service (SaaS), developers are constantly collaborating with powerful tools that scope to handle thousands of requests every second. This is where Apache Kafka, a robust tool that is known for handling highly intense environments, comes in.&nbsp;</p> 
<p dir="ltr">In this post, we’ll introduce you to the basics of <a href="https://dzone.com/articles/an-introduction-to-apache-kafka">Apache Kafka</a> and move on to building a secure, scalable messaging app with Java and Kafka.&nbsp;</p> 
<p><strong>Prerequisites:</strong>&nbsp;Java 8+, an internet connection, and a&nbsp;<a href="https://developer.okta.com/signup" rel="noopener noreferrer" target="_blank">free Okta developer account</a>.</p> 
<h2>A Brief Overview of Apache Kafka</h2> 
<p>Apache Kafka is a distributed streaming platform that utilizes the publish/subscribe message pattern to interact with applications; it’s designed to create durable messages.</p> 
<p>Let’s break down those concepts in more detail.</p> 
<h3>Distributed Streaming Platform</h3> 
<p>When you want to run Kafka, you need to start its broker: a simple instance of Kafka running on a machine, just like any other server. The broker is responsible to send, receive, and store messages into the disk.</p> 
<p>A single broker is not enough to ensure Kafka can handle a high-throughput of messages. That goal is achieved through many brokers working together at the same time, communicating and coordinating with each other.</p> 
<p>A Kafka cluster groups together one or more brokers. Instead of connecting to a single node, your application connects to a cluster that manages all the distributed details for you.</p> 
<blockquote>
  You may also like: 
 <a href="https://dzone.com/articles/kafka-cluster-1">A Kafka Tutorial for Everyone, no Matter Your Stage in Development</a>. 
</blockquote> 
<h3>Publish/Subscribe Messaging System With Durable Messages</h3> 
<p>The publish/subscribe is a common pattern in distributed systems. The image below illustrates the basic structure of this pattern within Kafka:</p> 
<p><span class="fr-img-caption" style="width: 602px; display: block; vertical-align: top; margin: 5px auto; text-align: center;"><span class="fr-img-wrap"><img src="https://dz2cdn1.dzone.com/storage/temp/12868462-screen-shot-2019-12-23-at-103122-am.png" data-image="true" data-new="false" data-sizeformatted="101.2 kB" data-mimetype="image/png" data-creationdate="1577125901206" data-creationdateformatted="12/23/2019 06:31 PM" data-type="temp" data-url="/storage/temp/12868462-screen-shot-2019-12-23-at-103122-am.png" data-modificationdate="null" data-size="101179" data-name="screen-shot-2019-12-23-at-103122-am.png" data-id="12868462" alt="Kafka Producers and Consumers" style="width: 602px;"></span></span></p> 
<figcaption class="fr-inner" contenteditable="true" style="text-align:center;"> 
 <em>Kafka Producers and Consumers</em> 
</figcaption> 
<p> The image includes two components not mentioned so far: Producers and Consumers. </p> 
<p>A Producer is an application that sends messages to the cluster. In this example, Producer 1, 2, and 3 are sending messages. The cluster then elects which broker should store them and sends it to the ones selected.</p> 
<p>On the other side, you have consumers. A consumer is an application that connects to the cluster and receives the messages posted from producers. Any application that is interested in consuming messages sent by producers must connect into the Kafka consumer.</p> 
<p>As Kafka stores messages for long durations (the default value is seven days), you can have many consumers receiving the same message even if they were not there when the message was sent!</p> 
<h3>Kafka Topics</h3> 
<p>When you send a message to a <a href="https://dzone.com/articles/kafka-producer-and-consumer-example">Kafka broker</a>, you need to specify where the message will be sent by specifying a topic. A topic is a category of messages that a consumer can subscribe to. This mechanism ensures that consumers only receive messages relevant to them, rather than receiving every message published to the cluster.</p> 
<p>Now that you understand Kafka’s basic architecture, let’s download and install it.</p> 
<h2>Install and Run Kafka</h2> 
<p>To download Kafka,&nbsp;<a href="https://kafka.apache.org/downloads" rel="noopener noreferrer" target="_blank">go to the Kafka website</a>. Extract the contents of this compressed file into a folder of your preference.</p> 
<p>Inside the Kafka directory, go to the&nbsp;<code>bin</code>&nbsp;folder. Here, you’ll find many bash scripts that will be useful for running a Kafka application. If you are using Windows, you also have the same scripts inside the&nbsp;<code>windows</code>&nbsp;folder. This tutorial uses Linux commands, but you just need to use the equivalent Windows version if you’re running a Microsoft OS.</p> 
<h2>Start Zookeeper to Manage Your Kafka Cluster</h2> 
<p>Apache Kafka is always run as a distributed application. This means your cluster has to deal with some distributed challenges along the way, like synchronizing configurations or electing a leader to take care of the cluster.</p> 
<p>Kafka uses&nbsp;<a href="https://dzone.com/articles/an-introduction-to-zookeeper-1" rel="noopener noreferrer" target="_blank">Zookeeper</a>&nbsp;to keep track of those details. Don’t worry about downloading it, though. Kafka already ships with Zookeeper, allowing you to get up and running very fast.</p> 
<p>Let’s start a Zookeeper instance! Inside the&nbsp;<code>bin</code>&nbsp;folder in your Kafka directory, run the following command:</p> 
<div class="codeMirror-wrapper"> 
 <div> 
  <div class="codeHeader"> 
   <div class="nameLanguage">
     Shell 
   </div> 
   <i class="icon-cancel-circled-1 cm-remove"> </i> 
  </div> 
  <div class="codeMirror-code--wrapper" data-code="./zookeeper-server-start.sh ../config/zookeeper.properties" data-lang="text/x-sh"> 
   <div class="CodeMirror cm-s-default CodeMirror-wrap"> 
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98047px; left: 35.9766px;"> 
     <textarea value="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" spellcheck="false"></textarea> 
    </div> 
    <div class="CodeMirror-vscrollbar" style="width: 18px; pointer-events: none;"> 
     <div style="min-width: 1px; height: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-hscrollbar" style="height: 18px; pointer-events: none;"> 
     <div style="height: 100%; min-height: 1px; width: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-scrollbar-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-gutter-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-scroll" tabindex="-1"> 
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: 0px; border-right-width: 30px; min-height: 30px; padding-right: 0px; padding-bottom: 0px;"> 
      <div style="position: relative; top: 0px;"> 
       <div class="CodeMirror-lines"> 
        <div style="position: relative; outline: none;"> 
         <div class="CodeMirror-measure"> 
          <span>x</span> 
         </div> 
         <div class="CodeMirror-measure"> 
          <br> 
         </div> 
         <div style="position: relative; z-index: 1;"> 
          <br> 
         </div> 
         <div class="CodeMirror-cursors"> 
          <div class="CodeMirror-cursor" style="left: 3.98438px; top: 0px; height: 22.5px;">
            &nbsp; 
          </div> 
         </div> 
         <div class="CodeMirror-code"> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              1 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;">./zookeeper-server-start.sh ../config/zookeeper.properties</span></pre> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
     <div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 30px;"> 
      <br> 
     </div> 
     <div class="CodeMirror-gutters" style="height: 60px; left: 0.00390625px;"> 
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;"> 
       <br> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<p> <br> </p> 
<p>This command starts a Zookeeper server on port 2181 by default. Zookeeper is responsible to coordinate the Kafka brokers inside your cluster. You’ll use the default configurations inside the Kafka project for this tutorial, but you can always change those values as needed.</p> 
<h2>Run a Kafka Broker</h2> 
<p>The next step is to run the broker itself. From another terminal, run the following command from the&nbsp;<code>bin</code>&nbsp;folder:</p> 
<div class="codeMirror-wrapper"> 
 <div> 
  <div class="codeHeader"> 
   <div class="nameLanguage">
     Shell 
   </div> 
   <i class="icon-cancel-circled-1 cm-remove"> </i> 
  </div> 
  <div class="codeMirror-code--wrapper" data-code="./kafka-server-start.sh ../config/server.properties" data-lang="text/x-sh"> 
   <div class="CodeMirror cm-s-default CodeMirror-wrap"> 
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98047px; left: 35.9766px;"> 
     <textarea value="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" spellcheck="false"></textarea> 
    </div> 
    <div class="CodeMirror-vscrollbar" style="width: 18px; pointer-events: none;"> 
     <div style="min-width: 1px; height: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-hscrollbar" style="height: 18px; pointer-events: none;"> 
     <div style="height: 100%; min-height: 1px; width: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-scrollbar-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-gutter-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-scroll" tabindex="-1"> 
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: 0px; border-right-width: 30px; min-height: 30px; padding-right: 0px; padding-bottom: 0px;"> 
      <div style="position: relative; top: 0px;"> 
       <div class="CodeMirror-lines"> 
        <div style="position: relative; outline: none;"> 
         <div class="CodeMirror-measure"> 
          <pre><span>xxxxxxxxxx</span></pre> 
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
           <div>
             1 
           </div> 
          </div> 
         </div> 
         <div class="CodeMirror-measure"> 
          <br> 
         </div> 
         <div style="position: relative; z-index: 1;"> 
          <br> 
         </div> 
         <div class="CodeMirror-cursors"> 
          <div class="CodeMirror-cursor" style="left: 3.98438px; top: 0px; height: 22.5px;">
            &nbsp; 
          </div> 
         </div> 
         <div class="CodeMirror-code"> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              1 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;">./kafka-server-start.sh ../config/server.properties</span></pre> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
     <div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 30px;"> 
      <br> 
     </div> 
     <div class="CodeMirror-gutters" style="height: 60px; left: 0.00390625px;"> 
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;"> 
       <br> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<p> <br> </p> 
<p>As you might have guessed, this command runs the Kafka server with the default configurations on the default port, 9092.</p> 
<h2>Create a Kafka Topic</h2> 
<p>Now that you have the broker and Zookeeper running, you can specify a topic to start sending messages from a producer. You’re going to run a command inside the&nbsp;<code>bin</code>&nbsp;folder, just like you did in the previous steps:</p> 
<div class="codeMirror-wrapper"> 
 <div> 
  <div class="codeHeader"> 
   <div class="nameLanguage">
     Shell 
   </div> 
   <i class="icon-cancel-circled-1 cm-remove"> </i> 
  </div> 
  <div class="codeMirror-code--wrapper" data-code="./kafka-topics.sh --create --topic myTopic -zookeeper \
 localhost:2181 --replication-factor 1 --partitions 1" data-lang="text/x-sh"> 
   <div class="CodeMirror cm-s-default CodeMirror-wrap"> 
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98047px; left: 35.9766px;"> 
     <textarea value="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" spellcheck="false"></textarea> 
    </div> 
    <div class="CodeMirror-vscrollbar" style="width: 18px; pointer-events: none;"> 
     <div style="min-width: 1px; height: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-hscrollbar" style="height: 18px; pointer-events: none;"> 
     <div style="height: 100%; min-height: 1px; width: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-scrollbar-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-gutter-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-scroll" tabindex="-1"> 
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: 0px; border-right-width: 30px; min-height: 53px; padding-right: 0px; padding-bottom: 0px;"> 
      <div style="position: relative; top: 0px;"> 
       <div class="CodeMirror-lines"> 
        <div style="position: relative; outline: none;"> 
         <div class="CodeMirror-measure"> 
          <pre><span>xxxxxxxxxx</span></pre> 
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
           <div>
             1 
           </div> 
          </div> 
         </div> 
         <div class="CodeMirror-measure"> 
          <br> 
         </div> 
         <div style="position: relative; z-index: 1;"> 
          <br> 
         </div> 
         <div class="CodeMirror-cursors"> 
          <div class="CodeMirror-cursor" style="left: 3.98438px; top: 0px; height: 22.5px;">
            &nbsp; 
          </div> 
         </div> 
         <div class="CodeMirror-code"> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              1 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;">./kafka-topics.sh <span class="cm-attribute">--create</span> <span class="cm-attribute">--topic</span> myTopic <span class="cm-attribute">-zookeeper</span> \</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              2 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> localhost:2181 <span class="cm-attribute">--replication-factor</span> <span class="cm-number">1</span> <span class="cm-attribute">--partitions</span> <span class="cm-number">1</span></span></pre> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
     <div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 53px;"> 
      <br> 
     </div> 
     <div class="CodeMirror-gutters" style="height: 83px; left: 0.00390625px;"> 
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;"> 
       <br> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<p> <br> </p> 
<p>This command creates a topic named&nbsp;<code>myTopic</code>&nbsp;pointing to the Zookeeper instance you started with the first command. There are also two different parameters you have to specify:&nbsp;<code>replication-factor</code>&nbsp;and&nbsp;<code>partitions</code>. Don’t worry about them right now; they are used to control specific aspects related to distributed systems in Kafka. As you are running a simple setup, you can specify “1” for both parameters.</p> 
<p>Now that you have everything up and running, you can start integrating Kafka with a Java application!</p> 
<h2>Create a Java + Kafka Application</h2> 
<p>Let’s start with the project structure, using&nbsp;<a href="https://start.spring.io/" rel="noopener noreferrer" target="_blank">Spring Initializer</a>&nbsp;to create the application.</p> 
<p>Go to&nbsp;<a href="https://start.spring.io/" rel="noopener noreferrer" target="_blank">https://start.spring.io</a>&nbsp;and fill in the following information:</p> 
<ul> 
 <li>Project: Maven Project.</li> 
 <li>Language: Java.</li> 
 <li>Group:&nbsp;<code>com.okta.javakafka</code></li> 
 <li>Artifact:&nbsp;<code>kafka-java</code></li> 
 <li>Dependencies: 
  <ul> 
   <li>Spring Web.</li> 
   <li>Spring for Apache Kafka.</li> 
  </ul> </li> 
</ul> 
<p>You can also generate the project using the command line. Paste the following command in your terminal, and it will download the project with the same configurations defined above:</p> 
<div class="codeMirror-wrapper"> 
 <div> 
  <div class="codeHeader"> 
   <div class="nameLanguage">
     Shell 
   </div> 
   <i class="icon-cancel-circled-1 cm-remove"> </i> 
  </div> 
  <div class="codeMirror-code--wrapper" data-code="curl https://start.spring.io/starter.zip -d language=java \
 -d dependencies=web,kafka \
 -d packageName=com.okta.javakafka \
 -d name=kafka-java \
 -d type=maven-project \
 -o kafka-java.zip" data-lang="text/x-sh"> 
   <div class="CodeMirror cm-s-default CodeMirror-wrap"> 
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98047px; left: 35.9766px;"> 
     <textarea value="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" spellcheck="false"></textarea> 
    </div> 
    <div class="CodeMirror-vscrollbar" style="width: 18px; pointer-events: none;"> 
     <div style="min-width: 1px; height: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-hscrollbar" style="height: 18px; pointer-events: none;"> 
     <div style="height: 100%; min-height: 1px; width: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-scrollbar-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-gutter-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-scroll" tabindex="-1"> 
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: 0px; border-right-width: 30px; min-height: 143px; padding-right: 0px; padding-bottom: 0px;"> 
      <div style="position: relative; top: 0px;"> 
       <div class="CodeMirror-lines"> 
        <div style="position: relative; outline: none;"> 
         <div class="CodeMirror-measure"> 
          <pre><span>xxxxxxxxxx</span></pre> 
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
           <div>
             1 
           </div> 
          </div> 
         </div> 
         <div class="CodeMirror-measure"> 
          <br> 
         </div> 
         <div style="position: relative; z-index: 1;"> 
          <br> 
         </div> 
         <div class="CodeMirror-cursors"> 
          <div class="CodeMirror-cursor" style="left: 3.98438px; top: 0px; height: 22.5px;">
            &nbsp; 
          </div> 
         </div> 
         <div class="CodeMirror-code"> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              1 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-builtin">curl</span> https://start.spring.io/starter.zip <span class="cm-attribute">-d</span> <span class="cm-def">language</span><span class="cm-operator">=</span>java \</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              2 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> <span class="cm-attribute">-d</span> <span class="cm-def">dependencies</span><span class="cm-operator">=</span>web,kafka \</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              3 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> <span class="cm-attribute">-d</span> <span class="cm-def">packageName</span><span class="cm-operator">=</span>com.okta.javakafka \</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              4 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> <span class="cm-attribute">-d</span> <span class="cm-def">name</span><span class="cm-operator">=</span>kafka-java \</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              5 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> <span class="cm-attribute">-d</span> <span class="cm-def">type</span><span class="cm-operator">=</span>maven-project \</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              6 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> <span class="cm-attribute">-o</span> kafka-java.zip</span></pre> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
     <div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 143px;"> 
      <br> 
     </div> 
     <div class="CodeMirror-gutters" style="height: 173px; left: 0.00390625px;"> 
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;"> 
       <br> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<p> <br> </p> 
<p>This tutorial uses Maven, but you can easily follow it with Gradle if you prefer.</p> 
<p>That’s it! Now, your Java project structure is created, and you can start developing your app.</p> 
<h2>Push Messages to a Kafka Topic in Your Java App</h2> 
<p>The first step to create a producer that can push messages is to configure the producers inside your Java application. Let’s create a configuration class to do just that.</p> 
<p>Create a&nbsp;<code>src/main/java/com/okta/javakafka/configuration</code>&nbsp;folder, and a&nbsp;<code>ProducerConfiguration</code>&nbsp;class in it:</p> 
<div class="codeMirror-wrapper"> 
 <div> 
  <div class="codeHeader"> 
   <div class="nameLanguage">
     Java 
   </div> 
   <i class="icon-cancel-circled-1 cm-remove"> </i> 
  </div> 
  <div class="codeMirror-code--wrapper" data-code="import org.apache.kafka.clients.producer.ProducerConfig;
import org.apache.kafka.common.serialization.StringSerializer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.kafka.core.DefaultKafkaProducerFactory;
import org.springframework.kafka.core.KafkaTemplate;
import org.springframework.kafka.core.ProducerFactory;

import java.util.HashMap;
import java.util.Map;

@Configuration
public class ProducerConfiguration {

    private static final String KAFKA_BROKER = &quot;localhost:9092&quot;;

    @Bean
    public ProducerFactory<String, String> producerFactory() {
        return new DefaultKafkaProducerFactory<>(producerConfigurations());
    }

    @Bean
    public Map<String, Object> producerConfigurations() {
        Map<String, Object> configurations = new HashMap<>();

        configurations.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, KAFKA_BROKER);
        configurations.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class);
        configurations.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class);

        return configurations;
    }

    @Bean
    public KafkaTemplate<String, String> kafkaTemplate() {
        return new KafkaTemplate<>(producerFactory());
    }

}" data-lang="text/x-java"> 
   <div class="CodeMirror cm-s-default CodeMirror-wrap"> 
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98047px; left: 35.9766px;"> 
     <textarea value="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" spellcheck="false"></textarea> 
    </div> 
    <div class="CodeMirror-vscrollbar" style="width: 18px; pointer-events: none; display: block; bottom: 0px;"> 
     <div style="min-width: 1px; height: 930px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-hscrollbar" style="height: 18px; pointer-events: none;"> 
     <div style="height: 100%; min-height: 1px; width: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-scrollbar-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-gutter-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-scroll" tabindex="-1"> 
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: 0px; border-right-width: 30px; min-height: 930px; padding-right: 0px; padding-bottom: 0px;"> 
      <div style="position: relative; top: 0px;"> 
       <div class="CodeMirror-lines"> 
        <div style="position: relative; outline: none;"> 
         <div class="CodeMirror-measure"> 
          <pre><span>xxxxxxxxxx</span></pre> 
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
           <div>
             1 
           </div> 
          </div> 
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
           <div>
             38 
           </div> 
          </div> 
         </div> 
         <div class="CodeMirror-measure"> 
          <br> 
         </div> 
         <div style="position: relative; z-index: 1;"> 
          <br> 
         </div> 
         <div class="CodeMirror-cursors"> 
          <div class="CodeMirror-cursor" style="left: 3.98438px; top: 0px; height: 22.5px;">
            &nbsp; 
          </div> 
         </div> 
         <div class="CodeMirror-code"> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              1 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">apache</span>.<span class="cm-variable">kafka</span>.<span class="cm-variable">clients</span>.<span class="cm-variable">producer</span>.<span class="cm-variable">ProducerConfig</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              2 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">apache</span>.<span class="cm-variable">kafka</span>.<span class="cm-variable">common</span>.<span class="cm-variable">serialization</span>.<span class="cm-variable">StringSerializer</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              3 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">context</span>.<span class="cm-variable">annotation</span>.<span class="cm-variable">Bean</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              4 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">context</span>.<span class="cm-variable">annotation</span>.<span class="cm-variable">Configuration</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              5 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">kafka</span>.<span class="cm-variable">core</span>.<span class="cm-variable">DefaultKafkaProducerFactory</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              6 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">kafka</span>.<span class="cm-variable">core</span>.<span class="cm-variable">KafkaTemplate</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              7 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">kafka</span>.<span class="cm-variable">core</span>.<span class="cm-variable">ProducerFactory</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              8 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              9 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">java</span>.<span class="cm-variable">util</span>.<span class="cm-variable">HashMap</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              10 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">java</span>.<span class="cm-variable">util</span>.<span class="cm-variable">Map</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              11 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              12 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-meta">@Configuration</span></span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              13 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">ProducerConfiguration</span> {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              14 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              15 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-keyword">static</span> <span class="cm-keyword">final</span> <span class="cm-type">String</span> <span class="cm-variable">KAFKA_BROKER</span> <span class="cm-operator">=</span> <span class="cm-string">"localhost:9092"</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              16 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              17 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-meta">@Bean</span></span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              18 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">ProducerFactory</span><span class="cm-operator">&lt;</span><span class="cm-type">String</span>, <span class="cm-type">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">producerFactory</span>() {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              19 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-keyword">new</span> <span class="cm-variable">DefaultKafkaProducerFactory</span><span class="cm-operator">&lt;&gt;</span>(<span class="cm-variable">producerConfigurations</span>());</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              20 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              21 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              22 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-meta">@Bean</span></span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              23 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">Map</span><span class="cm-operator">&lt;</span><span class="cm-type">String</span>, <span class="cm-type">Object</span><span class="cm-operator">&gt;</span> <span class="cm-variable">producerConfigurations</span>() {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              24 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">Map</span><span class="cm-operator">&lt;</span><span class="cm-type">String</span>, <span class="cm-type">Object</span><span class="cm-operator">&gt;</span> <span class="cm-variable">configurations</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">HashMap</span><span class="cm-operator">&lt;&gt;</span>();</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              25 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              26 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">configurations</span>.<span class="cm-variable">put</span>(<span class="cm-variable">ProducerConfig</span>.<span class="cm-variable">BOOTSTRAP_SERVERS_CONFIG</span>, <span class="cm-variable">KAFKA_BROKER</span>);</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              27 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">configurations</span>.<span class="cm-variable">put</span>(<span class="cm-variable">ProducerConfig</span>.<span class="cm-variable">KEY_SERIALIZER_CLASS_CONFIG</span>, <span class="cm-variable">StringSerializer</span>.<span class="cm-keyword">class</span>);</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              28 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">configurations</span>.<span class="cm-variable">put</span>(<span class="cm-variable">ProducerConfig</span>.<span class="cm-variable">VALUE_SERIALIZER_CLASS_CONFIG</span>, <span class="cm-variable">StringSerializer</span>.<span class="cm-keyword">class</span>);</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              29 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              30 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">configurations</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              31 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              32 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              33 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-meta">@Bean</span></span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              34 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">KafkaTemplate</span><span class="cm-operator">&lt;</span><span class="cm-type">String</span>, <span class="cm-type">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">kafkaTemplate</span>() {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              35 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-keyword">new</span> <span class="cm-variable">KafkaTemplate</span><span class="cm-operator">&lt;&gt;</span>(<span class="cm-variable">producerFactory</span>());</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              36 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              37 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              38 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;">}</span></pre> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
     <div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 930px;"> 
      <br> 
     </div> 
     <div class="CodeMirror-gutters" style="height: 960px; left: 0.00390625px;"> 
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;"> 
       <br> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<p> <br> </p> 
<p>This class creates a&nbsp;<code>ProducerFactory</code>&nbsp;which knows how to create producers based on the configurations you provided. You’ve also specified to connect to your local Kafka broker and to serialize both the key and the values with&nbsp;<code>String</code>.</p> 
<p>You also declared a&nbsp;<code>KafkaTemplate</code>&nbsp;bean to perform high-level operations on your producer. In other words, the template is able to do operations such as sending a message to a topic and efficiently hides under-the-hood details from you.</p> 
<p>The next step is to create the endpoint to send the message to the producer. Inside the&nbsp;<code>src/main/java/com/okta/javakafka/controller</code>&nbsp;package, create the following class:</p> 
<div class="codeMirror-wrapper"> 
 <div contenteditable="false"> 
  <div class="codeHeader"> 
   <div class="nameLanguage">
     Java 
   </div> 
   <i class="icon-cancel-circled-1 cm-remove"> </i> 
  </div> 
  <div class="codeMirror-code--wrapper" data-code="import org.springframework.kafka.core.KafkaTemplate;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import java.util.List;

@RestController
public class KafkaController {

    private KafkaTemplate<String, String> template;

    public KafkaController(KafkaTemplate<String, String> template) {
        this.template = template;
    }

    @GetMapping(&quot;/kafka/produce&quot;)
    public void produce(@RequestParam String message) {
        template.send(&quot;myTopic&quot;, message);
    }
" data-lang="text/x-java"> 
   <div class="CodeMirror cm-s-default CodeMirror-wrap"> 
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 36px;"> 
     <textarea spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="0" value=""></textarea> 
    </div> 
    <div class="CodeMirror-vscrollbar" style="display: block; bottom: 0px;"> 
     <div style="min-width: 1px; height: 491px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-hscrollbar"> 
     <div style="height: 100%; min-height: 1px; width: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-scrollbar-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-gutter-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-scroll" tabindex="-1"> 
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: -15px; border-right-width: 15px; min-height: 491px; padding-right: 15px; padding-bottom: 0px;"> 
      <div style="position: relative; top: 0px;"> 
       <div class="CodeMirror-lines"> 
        <div style="position: relative; outline: none;"> 
         <div class="CodeMirror-measure"> 
          <span>x</span> 
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
           <div>
             21 
           </div> 
          </div> 
         </div> 
         <div class="CodeMirror-measure"> 
          <br> 
         </div> 
         <div style="position: relative; z-index: 1;"> 
          <br> 
         </div> 
         <div class="CodeMirror-cursors"> 
          <div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 23px;">
            &nbsp; 
          </div> 
         </div> 
         <div class="CodeMirror-code"> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              1 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">kafka</span>.<span class="cm-variable">core</span>.<span class="cm-variable">KafkaTemplate</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              2 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">web</span>.<span class="cm-variable">bind</span>.<span class="cm-variable">annotation</span>.<span class="cm-variable">GetMapping</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              3 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">web</span>.<span class="cm-variable">bind</span>.<span class="cm-variable">annotation</span>.<span class="cm-variable">RequestParam</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              4 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">web</span>.<span class="cm-variable">bind</span>.<span class="cm-variable">annotation</span>.<span class="cm-variable">RestController</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              5 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              6 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">java</span>.<span class="cm-variable">util</span>.<span class="cm-variable">List</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              7 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              8 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-meta">@RestController</span></span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              9 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">KafkaController</span> {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              10 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              11 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable">KafkaTemplate</span><span class="cm-operator">&lt;</span><span class="cm-type">String</span>, <span class="cm-type">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">template</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              12 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              13 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">KafkaController</span>(<span class="cm-variable">KafkaTemplate</span><span class="cm-operator">&lt;</span><span class="cm-type">String</span>, <span class="cm-type">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">template</span>) {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              14 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">this</span>.<span class="cm-variable">template</span> <span class="cm-operator">=</span> <span class="cm-variable">template</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              15 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              16 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              17 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-meta">@GetMapping</span>(<span class="cm-string">"/kafka/produce"</span>)</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              18 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-type">void</span> <span class="cm-variable">produce</span>(<span class="cm-meta">@RequestParam</span> <span class="cm-type">String</span> <span class="cm-variable">message</span>) {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              19 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">template</span>.<span class="cm-variable">send</span>(<span class="cm-string">"myTopic"</span>, <span class="cm-variable">message</span>);</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              20 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
              21 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "></pre> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
     <div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 491px;"> 
      <br> 
     </div> 
     <div class="CodeMirror-gutters" style="height: 506px; left: 0px;"> 
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;"> 
       <br> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<p> <br> </p> 
<p><strong>Note:</strong>&nbsp;Since you’re sending data to be processed, the&nbsp;<code>produce()</code>&nbsp;method really ought to be a POST. For demo purposes, it’s easier to leave it as a GET so you can exercise it in the browser.</p> 
<p>As you can see, this endpoint is very simple. It injects the&nbsp;<code>KafkaTemplate</code>&nbsp;configured earlier and sends a message to&nbsp;<code>myTopic</code>&nbsp;when a&nbsp;<code>GET</code>&nbsp;request is made to&nbsp;<code>/kafka/produce</code>.</p> 
<p>Let’s test if everything is working as expected. Run the&nbsp;<code>main</code>&nbsp;method inside the&nbsp;<code>JavaKafkaApplication</code>&nbsp;class. To run from the command line, execute the following command:</p> 
<div class="codeMirror-wrapper"> 
 <div> 
  <div class="codeHeader"> 
   <div class="nameLanguage">
     Shell 
   </div> 
   <i class="icon-cancel-circled-1 cm-remove"> </i> 
  </div> 
  <div class="codeMirror-code--wrapper" data-code="./mvnw spring-boot:run" data-lang="text/x-sh"> 
   <div class="CodeMirror cm-s-default CodeMirror-wrap"> 
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98047px; left: 35.9766px;"> 
     <textarea value="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" spellcheck="false"></textarea> 
    </div> 
    <div class="CodeMirror-vscrollbar" style="width: 18px; pointer-events: none;"> 
     <div style="min-width: 1px; height: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-hscrollbar" style="height: 18px; pointer-events: none;"> 
     <div style="height: 100%; min-height: 1px; width: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-scrollbar-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-gutter-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-scroll" tabindex="-1"> 
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: 0px; border-right-width: 30px; min-height: 30px; padding-right: 0px; padding-bottom: 0px;"> 
      <div style="position: relative; top: 0px;"> 
       <div class="CodeMirror-lines"> 
        <div style="position: relative; outline: none;"> 
         <div class="CodeMirror-measure"> 
          <pre><span>xxxxxxxxxx</span></pre> 
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
           <div>
             1 
           </div> 
          </div> 
         </div> 
         <div class="CodeMirror-measure"> 
          <br> 
         </div> 
         <div style="position: relative; z-index: 1;"> 
          <br> 
         </div> 
         <div class="CodeMirror-cursors"> 
          <div class="CodeMirror-cursor" style="left: 3.98438px; top: 0px; height: 22.5px;">
            &nbsp; 
          </div> 
         </div> 
         <div class="CodeMirror-code"> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              1 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;">./mvnw spring-boot:run</span></pre> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
     <div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 30px;"> 
      <br> 
     </div> 
     <div class="CodeMirror-gutters" style="height: 60px; left: 0.00390625px;"> 
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;"> 
       <br> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<p> <br> </p> 
<p>Your server should be running on port 8080, and you can already make API requests against it!</p> 
<p>Go to your web browser and access&nbsp;<a href="http://localhost:8080/kafka/produce?message=This%20is%20my%20message" rel="noopener noreferrer" target="_blank">http://localhost:8080/kafka/produce?message=This is my message</a>.</p> 
<p>When you make a call with the command above, your application will execute the&nbsp;<code>/kafka/produce</code>&nbsp;endpoint, which sends a message to&nbsp;<code>myTopic</code>&nbsp;topic inside Kafka.</p> 
<p>But how do you know the command successfully sent a message to the topic? Right now, you don’t consume messages inside your app, which means you cannot be sure!</p> 
<p>Fortunately, there is an easy way to create a consumer to test right away. Inside the&nbsp;<code>bin</code>&nbsp;folder of your Kafka directory, run the following command:</p> 
<div class="codeMirror-wrapper"> 
 <div> 
  <div class="codeHeader"> 
   <div class="nameLanguage">
     Shell 
   </div> 
   <i class="icon-cancel-circled-1 cm-remove"> </i> 
  </div> 
  <div class="codeMirror-code--wrapper" data-code="./kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic myTopic" data-lang="text/x-sh"> 
   <div class="CodeMirror cm-s-default CodeMirror-wrap"> 
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98047px; left: 35.9766px;"> 
     <textarea value="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" spellcheck="false"></textarea> 
    </div> 
    <div class="CodeMirror-vscrollbar" style="width: 18px; pointer-events: none;"> 
     <div style="min-width: 1px; height: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-hscrollbar" style="height: 18px; pointer-events: none;"> 
     <div style="height: 100%; min-height: 1px; width: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-scrollbar-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-gutter-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-scroll" tabindex="-1"> 
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: 0px; border-right-width: 30px; min-height: 30px; padding-right: 0px; padding-bottom: 0px;"> 
      <div style="position: relative; top: 0px;"> 
       <div class="CodeMirror-lines"> 
        <div style="position: relative; outline: none;"> 
         <div class="CodeMirror-measure"> 
          <pre><span>xxxxxxxxxx</span></pre> 
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
           <div>
             1 
           </div> 
          </div> 
         </div> 
         <div class="CodeMirror-measure"> 
          <br> 
         </div> 
         <div style="position: relative; z-index: 1;"> 
          <br> 
         </div> 
         <div class="CodeMirror-cursors"> 
          <div class="CodeMirror-cursor" style="left: 3.98438px; top: 0px; height: 22.5px;">
            &nbsp; 
          </div> 
         </div> 
         <div class="CodeMirror-code"> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              1 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;">./kafka-console-consumer.sh <span class="cm-attribute">--bootstrap-server</span> localhost:9092 <span class="cm-attribute">--topic</span> myTopic</span></pre> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
     <div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 30px;"> 
      <br> 
     </div> 
     <div class="CodeMirror-gutters" style="height: 60px; left: 0.00390625px;"> 
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;"> 
       <br> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<p> <br> </p> 
<p>Access&nbsp;<a href="http://localhost:8080/kafka/produce?message=This%20is%20my%20message" rel="noopener noreferrer" target="_blank">http://localhost:8080/kafka/produce?message=This is my message</a>&nbsp;again to see the following message in the terminal running the Kafka consumer:</p> 
<div class="codeMirror-wrapper"> 
 <div> 
  <div class="codeHeader"> 
   <div class="nameLanguage">
     Shell 
   </div> 
   <i class="icon-cancel-circled-1 cm-remove"> </i> 
  </div> 
  <div class="codeMirror-code--wrapper" data-code="This is my message" data-lang="text/x-sh"> 
   <div class="CodeMirror cm-s-default CodeMirror-wrap"> 
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98047px; left: 35.9766px;"> 
     <textarea value="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" spellcheck="false"></textarea> 
    </div> 
    <div class="CodeMirror-vscrollbar" style="width: 18px; pointer-events: none;"> 
     <div style="min-width: 1px; height: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-hscrollbar" style="height: 18px; pointer-events: none;"> 
     <div style="height: 100%; min-height: 1px; width: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-scrollbar-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-gutter-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-scroll" tabindex="-1"> 
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: 0px; border-right-width: 30px; min-height: 30px; padding-right: 0px; padding-bottom: 0px;"> 
      <div style="position: relative; top: 0px;"> 
       <div class="CodeMirror-lines"> 
        <div style="position: relative; outline: none;"> 
         <div class="CodeMirror-measure"> 
          <pre><span>xxxxxxxxxx</span></pre> 
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
           <div>
             1 
           </div> 
          </div> 
         </div> 
         <div class="CodeMirror-measure"> 
          <br> 
         </div> 
         <div style="position: relative; z-index: 1;"> 
          <br> 
         </div> 
         <div class="CodeMirror-cursors"> 
          <div class="CodeMirror-cursor" style="left: 3.98438px; top: 0px; height: 22.5px;">
            &nbsp; 
          </div> 
         </div> 
         <div class="CodeMirror-code"> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              1 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;">This is my message</span></pre> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
     <div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 30px;"> 
      <br> 
     </div> 
     <div class="CodeMirror-gutters" style="height: 60px; left: 0.00390625px;"> 
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;"> 
       <br> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<p> <br> </p> 
<p>Great job! You can stop this command for now.</p> 
<p>Instead of executing from a terminal, let’s add some Java code to consume the messages inside your app.</p> 
<h2>Consume Messages From a Kafka Topic in a Java App</h2> 
<p>As with the producer, you need to add configurations to enable the consumer to find the Kafka Broker.</p> 
<p>Inside the&nbsp;<code>src/main/java/com/okta/javakafka/configuration</code>&nbsp;create the following class:</p> 
<div class="codeMirror-wrapper"> 
 <div> 
  <div class="codeHeader"> 
   <div class="nameLanguage">
     Java 
   </div> 
   <i class="icon-cancel-circled-1 cm-remove"> </i> 
  </div> 
  <div class="codeMirror-code--wrapper" data-code="import org.apache.kafka.clients.consumer.ConsumerConfig;
import org.apache.kafka.common.serialization.StringDeserializer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.kafka.config.ConcurrentKafkaListenerContainerFactory;
import org.springframework.kafka.core.ConsumerFactory;
import org.springframework.kafka.core.DefaultKafkaConsumerFactory;

import java.util.HashMap;
import java.util.Map;

@Configuration
public class ConsumerConfiguration {

    private static final String KAFKA_BROKER = &quot;localhost:9092&quot;;
    private static final String GROUP_ID = &quot;kafka-sandbox&quot;;

    @Bean
    public ConsumerFactory<String, String> consumerFactory() {
        return new DefaultKafkaConsumerFactory<>(consumerConfigurations());
    }

    @Bean
    public Map<String, Object> consumerConfigurations() {
        Map<String, Object> configurations = new HashMap<>();

        configurations.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, KAFKA_BROKER);
        configurations.put(ConsumerConfig.GROUP_ID_CONFIG, GROUP_ID);
        configurations.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);
        configurations.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);

        return configurations;
    }

    @Bean
    ConcurrentKafkaListenerContainerFactory<String, String> kafkaListenerContainerFactory() {
        ConcurrentKafkaListenerContainerFactory<String, String> factory = new ConcurrentKafkaListenerContainerFactory<>();
        factory.setConsumerFactory(consumerFactory());
        return factory;
    }

}" data-lang="text/x-java"> 
   <div class="CodeMirror cm-s-default CodeMirror-wrap"> 
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98047px; left: 35.9766px;"> 
     <textarea value="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" spellcheck="false"></textarea> 
    </div> 
    <div class="CodeMirror-vscrollbar" style="width: 18px; pointer-events: none; display: block; bottom: 0px;"> 
     <div style="min-width: 1px; height: 1065px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-hscrollbar" style="height: 18px; pointer-events: none;"> 
     <div style="height: 100%; min-height: 1px; width: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-scrollbar-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-gutter-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-scroll" tabindex="-1"> 
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: 0px; border-right-width: 30px; min-height: 1065px; padding-right: 0px; padding-bottom: 0px;"> 
      <div style="position: relative; top: 0px;"> 
       <div class="CodeMirror-lines"> 
        <div style="position: relative; outline: none;"> 
         <div class="CodeMirror-measure"> 
          <pre><span>xxxxxxxxxx</span></pre> 
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
           <div>
             1 
           </div> 
          </div> 
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
           <div>
             42 
           </div> 
          </div> 
         </div> 
         <div class="CodeMirror-measure"> 
          <br> 
         </div> 
         <div style="position: relative; z-index: 1;"> 
          <br> 
         </div> 
         <div class="CodeMirror-cursors"> 
          <div class="CodeMirror-cursor" style="left: 3.98438px; top: 0px; height: 22.5px;">
            &nbsp; 
          </div> 
         </div> 
         <div class="CodeMirror-code"> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              1 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">apache</span>.<span class="cm-variable">kafka</span>.<span class="cm-variable">clients</span>.<span class="cm-variable">consumer</span>.<span class="cm-variable">ConsumerConfig</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              2 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">apache</span>.<span class="cm-variable">kafka</span>.<span class="cm-variable">common</span>.<span class="cm-variable">serialization</span>.<span class="cm-variable">StringDeserializer</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              3 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">context</span>.<span class="cm-variable">annotation</span>.<span class="cm-variable">Bean</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              4 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">context</span>.<span class="cm-variable">annotation</span>.<span class="cm-variable">Configuration</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              5 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">kafka</span>.<span class="cm-variable">config</span>.<span class="cm-variable">ConcurrentKafkaListenerContainerFactory</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              6 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">kafka</span>.<span class="cm-variable">core</span>.<span class="cm-variable">ConsumerFactory</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              7 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">kafka</span>.<span class="cm-variable">core</span>.<span class="cm-variable">DefaultKafkaConsumerFactory</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              8 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              9 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">java</span>.<span class="cm-variable">util</span>.<span class="cm-variable">HashMap</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              10 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">java</span>.<span class="cm-variable">util</span>.<span class="cm-variable">Map</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              11 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              12 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-meta">@Configuration</span></span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              13 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">ConsumerConfiguration</span> {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              14 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              15 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-keyword">static</span> <span class="cm-keyword">final</span> <span class="cm-type">String</span> <span class="cm-variable">KAFKA_BROKER</span> <span class="cm-operator">=</span> <span class="cm-string">"localhost:9092"</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              16 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-keyword">static</span> <span class="cm-keyword">final</span> <span class="cm-type">String</span> <span class="cm-variable">GROUP_ID</span> <span class="cm-operator">=</span> <span class="cm-string">"kafka-sandbox"</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              17 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              18 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-meta">@Bean</span></span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              19 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">ConsumerFactory</span><span class="cm-operator">&lt;</span><span class="cm-type">String</span>, <span class="cm-type">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">consumerFactory</span>() {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              20 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-keyword">new</span> <span class="cm-variable">DefaultKafkaConsumerFactory</span><span class="cm-operator">&lt;&gt;</span>(<span class="cm-variable">consumerConfigurations</span>());</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              21 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              22 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              23 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-meta">@Bean</span></span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              24 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">Map</span><span class="cm-operator">&lt;</span><span class="cm-type">String</span>, <span class="cm-type">Object</span><span class="cm-operator">&gt;</span> <span class="cm-variable">consumerConfigurations</span>() {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              25 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">Map</span><span class="cm-operator">&lt;</span><span class="cm-type">String</span>, <span class="cm-type">Object</span><span class="cm-operator">&gt;</span> <span class="cm-variable">configurations</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">HashMap</span><span class="cm-operator">&lt;&gt;</span>();</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              26 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              27 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">configurations</span>.<span class="cm-variable">put</span>(<span class="cm-variable">ConsumerConfig</span>.<span class="cm-variable">BOOTSTRAP_SERVERS_CONFIG</span>, <span class="cm-variable">KAFKA_BROKER</span>);</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              28 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">configurations</span>.<span class="cm-variable">put</span>(<span class="cm-variable">ConsumerConfig</span>.<span class="cm-variable">GROUP_ID_CONFIG</span>, <span class="cm-variable">GROUP_ID</span>);</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              29 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">configurations</span>.<span class="cm-variable">put</span>(<span class="cm-variable">ConsumerConfig</span>.<span class="cm-variable">KEY_DESERIALIZER_CLASS_CONFIG</span>, <span class="cm-variable">StringDeserializer</span>.<span class="cm-keyword">class</span>);</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              30 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">configurations</span>.<span class="cm-variable">put</span>(<span class="cm-variable">ConsumerConfig</span>.<span class="cm-variable">VALUE_DESERIALIZER_CLASS_CONFIG</span>, <span class="cm-variable">StringDeserializer</span>.<span class="cm-keyword">class</span>);</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              31 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              32 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">configurations</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              33 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              34 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              35 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-meta">@Bean</span></span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              36 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">ConcurrentKafkaListenerContainerFactory</span><span class="cm-operator">&lt;</span><span class="cm-type">String</span>, <span class="cm-type">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">kafkaListenerContainerFactory</span>() {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              37 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">ConcurrentKafkaListenerContainerFactory</span><span class="cm-operator">&lt;</span><span class="cm-type">String</span>, <span class="cm-type">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">factory</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">ConcurrentKafkaListenerContainerFactory</span><span class="cm-operator">&lt;&gt;</span>();</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              38 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">factory</span>.<span class="cm-variable">setConsumerFactory</span>(<span class="cm-variable">consumerFactory</span>());</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              39 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">factory</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              40 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              41 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              42 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;">}</span></pre> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
     <div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 1065px;"> 
      <br> 
     </div> 
     <div class="CodeMirror-gutters" style="height: 1095px; left: 0.00390625px;"> 
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;"> 
       <br> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<p> <br> </p> 
<p>The code above creates a factory that knows how to connect to your local broker. It also configures your consumer to deserialize a&nbsp;<code>String</code>&nbsp;for both the key and the value, matching the producer configuration.</p> 
<p>The Group ID is mandatory and used by Kafka to allow parallel data consumption. The&nbsp;<code>ConcurrentKafkaListenerContainerFactory</code>&nbsp;bean allows your app to consume messages in more than one thread.</p> 
<p>Now that your Java app is configured to find consumers inside your Kafka broker, let’s start listening to the messages sent to the topic.</p> 
<p>Create a&nbsp;<code>src/main/java/com/okta/javakafka/consumer</code>&nbsp;directory, and the following class in it:</p> 
<div class="codeMirror-wrapper"> 
 <div contenteditable="false"> 
  <div class="codeHeader"> 
   <div class="nameLanguage">
     Java 
   </div> 
   <i class="icon-cancel-circled-1 cm-remove"> </i> 
  </div> 
  <div class="codeMirror-code--wrapper" data-code="import org.springframework.kafka.annotation.KafkaListener;
import org.springframework.stereotype.Component;

import java.util.ArrayList;
import java.util.List;

@Component
public class MyTopicConsumer {

    private final List<String> messages = new ArrayList<>();

    @KafkaListener(topics = &quot;myTopic&quot;, groupId = &quot;kafka-sandbox&quot;)
    public void listen(String message) {
        synchronized (messages) {
            messages.add(message);
        }
    }

    public List<String> getMessages() {
        return messages;
    }

}" data-lang="text/x-java"> 
   <div class="CodeMirror cm-s-default CodeMirror-wrap"> 
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98047px; left: 35.9766px;"> 
     <textarea spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="0" value=""></textarea> 
    </div> 
    <div class="CodeMirror-vscrollbar" style="width: 18px; pointer-events: none; display: block; bottom: 0px;"> 
     <div style="min-width: 1px; height: 525px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-hscrollbar" style="height: 18px; pointer-events: none;"> 
     <div style="height: 100%; min-height: 1px; width: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-scrollbar-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-gutter-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-scroll" tabindex="-1"> 
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: 0px; border-right-width: 30px; min-height: 525px; padding-right: 0px; padding-bottom: 0px;"> 
      <div style="position: relative; top: 0px;"> 
       <div class="CodeMirror-lines"> 
        <div style="position: relative; outline: none;"> 
         <div class="CodeMirror-measure"> 
          <pre><span>xxxxxxxxxx</span></pre> 
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
           <div>
             1 
           </div> 
          </div> 
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
           <div>
             23 
           </div> 
          </div> 
         </div> 
         <div class="CodeMirror-measure"> 
          <br> 
         </div> 
         <div style="position: relative; z-index: 1;"> 
          <br> 
         </div> 
         <div class="CodeMirror-cursors"> 
          <div class="CodeMirror-cursor" style="left: 3.98438px; top: 0px; height: 22.5px;">
            &nbsp; 
          </div> 
         </div> 
         <div class="CodeMirror-code"> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              1 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">kafka</span>.<span class="cm-variable">annotation</span>.<span class="cm-variable">KafkaListener</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              2 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">stereotype</span>.<span class="cm-variable">Component</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              3 
            </div> 
           </div> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              4 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">java</span>.<span class="cm-variable">util</span>.<span class="cm-variable">ArrayList</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              5 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">java</span>.<span class="cm-variable">util</span>.<span class="cm-variable">List</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              6 
            </div> 
           </div> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              7 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-meta">@Component</span></span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              8 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">MyTopicConsumer</span> {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              9 
            </div> 
           </div> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              10 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-keyword">final</span> <span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-type">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">messages</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">ArrayList</span><span class="cm-operator">&lt;&gt;</span>();</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              11 
            </div> 
           </div> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              12 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-meta">@KafkaListener</span>(<span class="cm-variable">topics</span> <span class="cm-operator">=</span> <span class="cm-string">"myTopic"</span>, <span class="cm-variable">groupId</span> <span class="cm-operator">=</span> <span class="cm-string">"kafka-sandbox"</span>)</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              13 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-type">void</span> <span class="cm-variable">listen</span>(<span class="cm-type">String</span> <span class="cm-variable">message</span>) {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              14 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">synchronized</span> (<span class="cm-variable">messages</span>) {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              15 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">messages</span>.<span class="cm-variable">add</span>(<span class="cm-variable">message</span>);</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              16 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              17 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              18 
            </div> 
           </div> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              19 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-type">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">getMessages</span>() {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              20 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">messages</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              21 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              22 
            </div> 
           </div> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              23 
            </div> 
           </div> 
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
     <div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 525px;"> 
      <br> 
     </div> 
     <div class="CodeMirror-gutters" style="height: 555px; left: 0.00390625px;"> 
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;"> 
       <br> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<p> <br> </p> 
<p>This class is responsible for listening to changes inside the&nbsp;<code>myTopic</code>&nbsp;topic. It does so by using the&nbsp;<code>KafkaListener</code>&nbsp;annotation. Every time a new message is sent from a producer to the topic, your app receives a message inside this class. It adds a message to the list of messages received, making it available to other classes through the&nbsp;<code>getMessages()</code>&nbsp;method.</p> 
<p>Next, let’s create an endpoint that displays a list of consumed messages. Go back to the&nbsp;<code>KafkaController</code>&nbsp;to add&nbsp;<code>MyTopicConsumer</code>&nbsp;as a dependency and a&nbsp;<code>getMessages()</code>&nbsp;method.</p> 
<div class="codeMirror-wrapper"> 
 <div> 
  <div class="codeHeader"> 
   <div class="nameLanguage">
     Java 
   </div> 
   <i class="icon-cancel-circled-1 cm-remove"> </i> 
  </div> 
  <div class="codeMirror-code--wrapper" data-code="import com.okta.javakafka.consumer.MyTopicConsumer;
import org.springframework.kafka.core.KafkaTemplate;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import java.util.List;

@RestController
public class KafkaController {

    private KafkaTemplate<String, String> template;
    private MyTopicConsumer myTopicConsumer;

    public KafkaController(KafkaTemplate<String, String> template, MyTopicConsumer myTopicConsumer) {
        this.template = template;
        this.myTopicConsumer = myTopicConsumer;
    }

    @GetMapping(&quot;/kafka/produce&quot;)
    public void produce(@RequestParam String message) {
        template.send(&quot;myTopic&quot;, message);
    }

    @GetMapping(&quot;/kafka/messages&quot;)
    public List<String> getMessages() {
        return myTopicConsumer.getMessages();
    }

}" data-lang="text/x-java"> 
   <div class="CodeMirror cm-s-default CodeMirror-wrap"> 
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98047px; left: 35.9766px;"> 
     <textarea value="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" spellcheck="false"></textarea> 
    </div> 
    <div class="CodeMirror-vscrollbar" style="width: 18px; pointer-events: none; display: block; bottom: 0px;"> 
     <div style="min-width: 1px; height: 705px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-hscrollbar" style="height: 18px; pointer-events: none;"> 
     <div style="height: 100%; min-height: 1px; width: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-scrollbar-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-gutter-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-scroll" tabindex="-1"> 
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: 0px; border-right-width: 30px; min-height: 705px; padding-right: 0px; padding-bottom: 0px;"> 
      <div style="position: relative; top: 0px;"> 
       <div class="CodeMirror-lines"> 
        <div style="position: relative; outline: none;"> 
         <div class="CodeMirror-measure"> 
          <pre><span>xxxxxxxxxx</span></pre> 
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
           <div>
             1 
           </div> 
          </div> 
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
           <div>
             30 
           </div> 
          </div> 
         </div> 
         <div class="CodeMirror-measure"> 
          <br> 
         </div> 
         <div style="position: relative; z-index: 1;"> 
          <br> 
         </div> 
         <div class="CodeMirror-cursors"> 
          <div class="CodeMirror-cursor" style="left: 3.98438px; top: 0px; height: 22.5px;">
            &nbsp; 
          </div> 
         </div> 
         <div class="CodeMirror-code"> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              1 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">com</span>.<span class="cm-variable">okta</span>.<span class="cm-variable">javakafka</span>.<span class="cm-variable">consumer</span>.<span class="cm-variable">MyTopicConsumer</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              2 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">kafka</span>.<span class="cm-variable">core</span>.<span class="cm-variable">KafkaTemplate</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              3 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">web</span>.<span class="cm-variable">bind</span>.<span class="cm-variable">annotation</span>.<span class="cm-variable">GetMapping</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              4 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">web</span>.<span class="cm-variable">bind</span>.<span class="cm-variable">annotation</span>.<span class="cm-variable">RequestParam</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              5 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">web</span>.<span class="cm-variable">bind</span>.<span class="cm-variable">annotation</span>.<span class="cm-variable">RestController</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              6 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              7 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">java</span>.<span class="cm-variable">util</span>.<span class="cm-variable">List</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              8 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              9 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-meta">@RestController</span></span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              10 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">KafkaController</span> {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              11 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              12 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable">KafkaTemplate</span><span class="cm-operator">&lt;</span><span class="cm-type">String</span>, <span class="cm-type">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">template</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              13 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable">MyTopicConsumer</span> <span class="cm-variable">myTopicConsumer</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              14 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              15 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">KafkaController</span>(<span class="cm-variable">KafkaTemplate</span><span class="cm-operator">&lt;</span><span class="cm-type">String</span>, <span class="cm-type">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">template</span>, <span class="cm-variable">MyTopicConsumer</span> <span class="cm-variable">myTopicConsumer</span>) {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              16 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">this</span>.<span class="cm-variable">template</span> <span class="cm-operator">=</span> <span class="cm-variable">template</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              17 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">this</span>.<span class="cm-variable">myTopicConsumer</span> <span class="cm-operator">=</span> <span class="cm-variable">myTopicConsumer</span>;</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              18 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              19 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              20 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-meta">@GetMapping</span>(<span class="cm-string">"/kafka/produce"</span>)</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              21 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-type">void</span> <span class="cm-variable">produce</span>(<span class="cm-meta">@RequestParam</span> <span class="cm-type">String</span> <span class="cm-variable">message</span>) {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              22 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">template</span>.<span class="cm-variable">send</span>(<span class="cm-string">"myTopic"</span>, <span class="cm-variable">message</span>);</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              23 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              24 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              25 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-meta">@GetMapping</span>(<span class="cm-string">"/kafka/messages"</span>)</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              26 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-type">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">getMessages</span>() {</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              27 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">myTopicConsumer</span>.<span class="cm-variable">getMessages</span>();</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              28 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              29 
            </div> 
           </div> 
           <pre class="CodeMirror-line"></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              30 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;">}</span></pre> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
     <div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 705px;"> 
      <br> 
     </div> 
     <div class="CodeMirror-gutters" style="height: 735px; left: 0.00390625px;"> 
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;"> 
       <br> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<p> <br> </p> 
<p>This class now has a new endpoint to display the messages stored in your consumer. When this endpoint is called, it sends the current messages it already processed from the Kafka topic.</p> 
<p>Your Java app now has both a Kafka producer and a consumer, so let’s test it all together! Restart your application, and go to&nbsp;<a href="http://localhost:8080/kafka/messages" rel="noopener noreferrer" target="_blank">http://localhost:8080/kafka/messages</a>.</p> 
<p>Right now, no information is being returned. The reason is pretty simple: your consumer is configured only to receive new messages and you haven’t sent a new message yet. Let’s fix this problem by going to your web browser and accessing&nbsp;<a href="http://localhost:8080/kafka/produce?message=Message%20sent%20by%20my%20App!" rel="noopener noreferrer" target="_blank">http://localhost:8080/kafka/produce?message=Message sent by my App!</a>.</p> 
<p>When Kafka receives the message, it will let your consumer know about it right away. Go ahead and go to&nbsp;<a href="http://localhost:8080/kafka/messages">http://localhost:8080/kafka/messages</a>&nbsp;in your browser. You will now see that your message was successfully received!</p> 
<p><span class="fr-img-caption" style="width: 518px; display: block; vertical-align: top; margin: 5px auto; text-align: center;"><span class="fr-img-wrap"><img src="https://dz2cdn1.dzone.com/storage/temp/12868468-screen-shot-2019-12-23-at-103603-am.png" data-image="true" data-new="false" data-sizeformatted="36.7 kB" data-mimetype="image/png" data-creationdate="1577126178820" data-creationdateformatted="12/23/2019 06:36 PM" data-type="temp" data-url="/storage/temp/12868468-screen-shot-2019-12-23-at-103603-am.png" data-modificationdate="null" data-size="36712" data-name="screen-shot-2019-12-23-at-103603-am.png" data-id="12868468" alt="Message successfully retrieved" style="width: 518px;"></span></span></p> 
<figcaption class="fr-inner" contenteditable="true" style="text-align:center;"> 
 <em>Message successfully retrieved</em> 
</figcaption> 
<p>Great job! You have a Java app capable of producing and consuming messages from Kafka! Before we call it a day though, there is one last step and it’s a very important one.</p> 
<h2>Secure Your Java Kafka Application</h2> 
<p>Your app is not very secure right now. Although you are prepared to handle many messages in a distributed environment, those messages are still available to anyone who can find the link to your endpoints. This is a critical vulnerability, so let’s make sure it’s addressed the right way.</p> 
<p>You’re going to use OAuth 2.0 to make sure only authenticated users can see your endpoints. The best part? It’s going to take only 5 minutes to add this feature in your app by using Okta to authenticate your users!</p> 
<h3>Create an Okta Account</h3> 
<p>If you don’t already have an Okta account,&nbsp;<a href="https://developer.okta.com/signup" rel="noopener noreferrer" target="_blank">go ahead and create one</a>. After completing registration, go through the following steps:</p> 
<ul> 
 <li>Login to your account.</li> 
 <li>Go to&nbsp;<strong>Applications</strong>&nbsp;&gt;&nbsp;<strong>Add Application</strong>. You will be redirected to the following page:</li> 
</ul> 
<p><span class="fr-img-caption" style="width: 600px; display: block; vertical-align: top; margin: 5px auto; text-align: center;"><span class="fr-img-wrap"><img src="https://dz2cdn1.dzone.com/storage/temp/12868473-screen-shot-2019-12-23-at-103711-am.png" data-image="true" data-new="false" data-sizeformatted="229.8 kB" data-mimetype="image/png" data-creationdate="1577126256573" data-creationdateformatted="12/23/2019 06:37 PM" data-type="temp" data-url="/storage/temp/12868473-screen-shot-2019-12-23-at-103711-am.png" data-modificationdate="null" data-size="229773" data-name="screen-shot-2019-12-23-at-103711-am.png" data-id="12868473" alt="Adding application to Okta account" style="width: 600px;"></span></span></p> 
<figcaption class="fr-inner" contenteditable="true" style="text-align:center;"> 
 <em>Adding application to Okta account</em> 
</figcaption> 
<ul> 
 <li>Select&nbsp;<strong>Web</strong>&nbsp;and click&nbsp;<strong>Next</strong>.</li> 
 <li>Fill in the following options in the form: 
  <ul> 
   <li>Name:&nbsp;<code>Bootiful Kafka</code></li> 
   <li>Base URIs:&nbsp;<code>http://localhost:8080</code></li> 
   <li>Login redirect URLs:&nbsp;<code>http://localhost:8080/login/oauth2/code/okta</code></li> 
  </ul> </li> 
 <li>Click&nbsp;<strong>Done</strong>.</li> 
</ul> 
<p>Now that you have your Okta application, you can use it to authenticate users in your Java + Kafka app.</p> 
<h2>Secure Your Java App With User Auth</h2> 
<p>Let’s start by adding Okta’s library to your project. Open your&nbsp;<code>pom.xml</code>&nbsp;and add the following dependency inside the&nbsp;<code>&lt;dependencies&gt;</code>&nbsp;tag:</p> 
<div class="codeMirror-wrapper"> 
 <div> 
  <div class="codeHeader"> 
   <div class="nameLanguage">
     XML 
   </div> 
   <i class="icon-cancel-circled-1 cm-remove"> </i> 
  </div> 
  <div class="codeMirror-code--wrapper" data-code="<dependency>
    <groupId>com.okta.spring</groupId>
    <artifactId>okta-spring-boot-starter</artifactId>
    <version>1.3.0</version>
</dependency>" data-lang="application/xml"> 
   <div class="CodeMirror cm-s-default CodeMirror-wrap"> 
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98047px; left: 35.9766px;"> 
     <textarea value="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" spellcheck="false"></textarea> 
    </div> 
    <div class="CodeMirror-vscrollbar" style="width: 18px; pointer-events: none;"> 
     <div style="min-width: 1px; height: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-hscrollbar" style="height: 18px; pointer-events: none;"> 
     <div style="height: 100%; min-height: 1px; width: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-scrollbar-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-gutter-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-scroll" tabindex="-1"> 
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: 0px; border-right-width: 30px; min-height: 120px; padding-right: 0px; padding-bottom: 0px;"> 
      <div style="position: relative; top: 0px;"> 
       <div class="CodeMirror-lines"> 
        <div style="position: relative; outline: none;"> 
         <div class="CodeMirror-measure"> 
          <pre><span>xxxxxxxxxx</span></pre> 
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
           <div>
             1 
           </div> 
          </div> 
         </div> 
         <div class="CodeMirror-measure"> 
          <br> 
         </div> 
         <div style="position: relative; z-index: 1;"> 
          <br> 
         </div> 
         <div class="CodeMirror-cursors"> 
          <div class="CodeMirror-cursor" style="left: 3.98438px; top: 0px; height: 22.5px;">
            &nbsp; 
          </div> 
         </div> 
         <div class="CodeMirror-code"> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              1 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">dependency</span><span class="cm-tag cm-bracket">&gt;</span></span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              2 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">groupId</span><span class="cm-tag cm-bracket">&gt;</span>com.okta.spring<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">groupId</span><span class="cm-tag cm-bracket">&gt;</span></span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              3 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">artifactId</span><span class="cm-tag cm-bracket">&gt;</span>okta-spring-boot-starter<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">artifactId</span><span class="cm-tag cm-bracket">&gt;</span></span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              4 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">version</span><span class="cm-tag cm-bracket">&gt;</span>1.3.0<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">version</span><span class="cm-tag cm-bracket">&gt;</span></span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              5 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">dependency</span><span class="cm-tag cm-bracket">&gt;</span></span></pre> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
     <div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 120px;"> 
      <br> 
     </div> 
     <div class="CodeMirror-gutters" style="height: 150px; left: 0.00390625px;"> 
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;"> 
       <br> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<p> <br>This library will integrate with the Okta app you just created. It will also add Spring Security to your current application. Configure it with the following variables in&nbsp;<code>src/main/resources/application.properties</code>:</p> 
<div class="codeMirror-wrapper"> 
 <div> 
  <div class="codeHeader"> 
   <div class="nameLanguage">
     Properties files 
   </div> 
   <i class="icon-cancel-circled-1 cm-remove"> </i> 
  </div> 
  <div class="codeMirror-code--wrapper" data-code="okta.oauth2.issuer: https://{yourOktaDomain}/oauth2/default
okta.oauth2.client-id: {yourClientID}
okta.oauth2.client-secret: {yourClientSecret}" data-lang="text/x-properties"> 
   <div class="CodeMirror cm-s-default CodeMirror-wrap"> 
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98047px; left: 35.9766px;"> 
     <textarea value="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" spellcheck="false"></textarea> 
    </div> 
    <div class="CodeMirror-vscrollbar" style="width: 18px; pointer-events: none;"> 
     <div style="min-width: 1px; height: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-hscrollbar" style="height: 18px; pointer-events: none;"> 
     <div style="height: 100%; min-height: 1px; width: 0px;"> 
      <br> 
     </div> 
    </div> 
    <div class="CodeMirror-scrollbar-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-gutter-filler"> 
     <br> 
    </div> 
    <div class="CodeMirror-scroll" tabindex="-1"> 
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: 0px; border-right-width: 30px; min-height: 75px; padding-right: 0px; padding-bottom: 0px;"> 
      <div style="position: relative; top: 0px;"> 
       <div class="CodeMirror-lines"> 
        <div style="position: relative; outline: none;"> 
         <div class="CodeMirror-measure"> 
          <pre><span>xxxxxxxxxx</span></pre> 
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
           <div>
             1 
           </div> 
          </div> 
         </div> 
         <div class="CodeMirror-measure"> 
          <br> 
         </div> 
         <div style="position: relative; z-index: 1;"> 
          <br> 
         </div> 
         <div class="CodeMirror-cursors"> 
          <div class="CodeMirror-cursor" style="left: 3.98438px; top: 0px; height: 22.5px;">
            &nbsp; 
          </div> 
         </div> 
         <div class="CodeMirror-code"> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              1 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-def">okta.oauth2.issuer</span>:<span class="cm-quote"> https</span>:<span class="cm-quote">//{yourOktaDomain}/oauth2/default</span></span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              2 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-def">okta.oauth2.client-id</span>:<span class="cm-quote"> {yourClientID}</span></span></pre> 
          </div> 
          <div style="position: relative;"> 
           <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px;">
              3 
            </div> 
           </div> 
           <pre class="CodeMirror-line"><span style="padding-right: 0.1px;"><span class="cm-def">okta.oauth2.client-secret</span>:<span class="cm-quote"> {yourClientSecret}</span></span></pre> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
     <div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 75px;"> 
      <br> 
     </div> 
     <div class="CodeMirror-gutters" style="height: 105px; left: 0.00390625px;"> 
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;"> 
       <br> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<p> <br> </p> 
<p><strong>IMPORTANT</strong>: This file should only be used locally. Do not commit your client’s secret to Git or any other Version Control System.</p> 
<blockquote> 
 <p style="text-align: left;">To avoid accidentally exposing these credentials, you can also specify your Okta application’s values as environment variables. Create an&nbsp;<code>okta.env</code>&nbsp;file in the root directory of your app with the following environment variables. Then run&nbsp;<code>source okta.env</code>&nbsp;before starting your app.</p> 
 <div class="codeMirror-wrapper"> 
  <div> 
   <div class="codeHeader"> 
    <div class="nameLanguage" style="text-align: left;">
      Shell 
    </div> 
    <i class="icon-cancel-circled-1 cm-remove"> </i> 
   </div> 
   <div class="codeMirror-code--wrapper" data-code="export OKTA_OAUTH2_ISSUER=https://{yourOktaDomain}/oauth2/default
export OKTA_OAUTH2_CLIENT_ID={yourClientID}
export OKTA_OAUTH2_CLIENT_SECRET={yourClientSecret}" data-lang="text/x-sh"> 
    <div class="CodeMirror cm-s-default CodeMirror-wrap"> 
     <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98047px; left: 35.9766px; text-align: left;"> 
      <textarea value="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" spellcheck="false"></textarea> 
     </div> 
     <div class="CodeMirror-vscrollbar" style="width: 18px; pointer-events: none;"> 
      <div style="min-width: 1px; height: 0px; text-align: left;"> 
       <br> 
      </div> 
     </div> 
     <div class="CodeMirror-hscrollbar" style="height: 18px; pointer-events: none;"> 
      <div style="height: 100%; min-height: 1px; width: 0px; text-align: left;"> 
       <br> 
      </div> 
     </div> 
     <div class="CodeMirror-scrollbar-filler" style="text-align: left;"> 
      <br> 
     </div> 
     <div class="CodeMirror-gutter-filler" style="text-align: left;"> 
      <br> 
     </div> 
     <div class="CodeMirror-scroll" tabindex="-1"> 
      <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: 0px; border-right-width: 30px; min-height: 75px; padding-right: 0px; padding-bottom: 0px;"> 
       <div style="position: relative; top: 0px;"> 
        <div class="CodeMirror-lines"> 
         <div style="position: relative; outline: none;"> 
          <div class="CodeMirror-measure"> 
           <pre style="text-align: left;"><span>xxxxxxxxxx</span></pre> 
           <div class="CodeMirror-linenumber CodeMirror-gutter-elt"> 
            <div style="text-align: left;">
              1 
            </div> 
           </div> 
          </div> 
          <div class="CodeMirror-measure" style="text-align: left;"> 
           <br> 
          </div> 
          <div style="position: relative; z-index: 1; text-align: left;"> 
           <br> 
          </div> 
          <div class="CodeMirror-cursors"> 
           <div class="CodeMirror-cursor" style="left: 3.98438px; top: 0px; height: 22.5px; text-align: left;">
             &nbsp; 
           </div> 
          </div> 
          <div class="CodeMirror-code"> 
           <div style="position: relative;"> 
            <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
             <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px; text-align: left;">
               1 
             </div> 
            </div> 
            <pre class="CodeMirror-line" style="text-align: left;"><span style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">OKTA_OAUTH2_ISSUER</span><span class="cm-operator">=</span>https://{yourOktaDomain}/oauth2/default</span></pre> 
           </div> 
           <div style="position: relative;"> 
            <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
             <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px; text-align: left;">
               2 
             </div> 
            </div> 
            <pre class="CodeMirror-line" style="text-align: left;"><span style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">OKTA_OAUTH2_CLIENT_ID</span><span class="cm-operator">=</span>{yourClientID}</span></pre> 
           </div> 
           <div style="position: relative;"> 
            <div class="CodeMirror-gutter-wrapper" style="left: -30.9961px;"> 
             <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 24px; text-align: left;">
               3 
             </div> 
            </div> 
            <pre class="CodeMirror-line" style="text-align: left;"><span style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">OKTA_OAUTH2_CLIENT_SECRET</span><span class="cm-operator">=</span>{yourClientSecret}</span></pre> 
           </div> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 75px; text-align: left;"> 
       <br> 
      </div> 
      <div class="CodeMirror-gutters" style="height: 105px; left: 0.00390625px;"> 
       <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px; text-align: left;"> 
        <br> 
       </div> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</blockquote> 
<p>You can find&nbsp;<code>{yourClientID}</code>&nbsp;and&nbsp;<code>{yourClientSecret}</code>&nbsp;in the Okta UI’s applications page. To access it, follow the steps below:</p> 
<ul> 
 <li>In your Okta menu, go to&nbsp;<strong>Applications</strong>.</li> 
 <li>Select the&nbsp;<strong>Bootiful Kafka</strong>&nbsp;application.</li> 
 <li>Click on the&nbsp;<strong>General</strong>&nbsp;tab.</li> 
</ul> 
<p>You should see both values inside the Client Credentials area.</p> 
<p><span class="fr-img-caption" style="width: 605px; display: block; vertical-align: top; margin: 5px auto; text-align: center;"><span class="fr-img-wrap"><img src="https://dz2cdn1.dzone.com/storage/temp/12868475-screen-shot-2019-12-23-at-103819-am.png" data-image="true" data-new="false" data-sizeformatted="114.6 kB" data-mimetype="image/png" data-creationdate="1577126313536" data-creationdateformatted="12/23/2019 06:38 PM" data-type="temp" data-url="/storage/temp/12868475-screen-shot-2019-12-23-at-103819-am.png" data-modificationdate="null" data-size="114593" data-name="screen-shot-2019-12-23-at-103819-am.png" data-id="12868475" alt="Retrieving client credentials" style="width: 605px;"></span></span></p> 
<figcaption class="fr-inner" contenteditable="true" style="text-align:center;"> 
 <em>Retrieving client credentials</em> 
</figcaption> 
<p>The value&nbsp;<code>{yourOktaDomain}</code>&nbsp;for will be visible in your Okta dashboard, just click on the Dashboard on the menu. You will see the Org URL in the right upper corner.</p> 
<p>That’s it!</p> 
<p>Restart your Spring Boot application and go to&nbsp;<a href="http://localhost:8080/kafka/messages" rel="noopener noreferrer" target="_blank">http://localhost:8080/kafka/messages</a>. Your app will now redirect you to the login page:</p> 
<p><span class="fr-img-caption" style="width: 380px; display: block; vertical-align: top; margin: 5px auto; text-align: center;"><span class="fr-img-wrap"><img src="https://dz2cdn1.dzone.com/storage/temp/12868476-screen-shot-2019-12-23-at-103855-am.png" data-image="true" data-new="false" data-sizeformatted="59.6 kB" data-mimetype="image/png" data-creationdate="1577126347277" data-creationdateformatted="12/23/2019 06:39 PM" data-type="temp" data-url="/storage/temp/12868476-screen-shot-2019-12-23-at-103855-am.png" data-modificationdate="null" data-size="59577" data-name="screen-shot-2019-12-23-at-103855-am.png" data-id="12868476" alt="Final sign-in page" style="width: 380px;"></span></span></p> 
<figcaption class="fr-inner" contenteditable="true" style="text-align:center;"> 
 <em>Final sign-in page</em> 
</figcaption> 
<p><strong>NOTE:</strong>&nbsp;If you’re not prompted to log in, it’s because you’re already logged in. Open your app in an incognito window, and you’ll see the login screen shown above.</p> 
<p>Enter your username and password. If your login attempt is successful, you’ll be redirected back to your application again.</p> 
<p>Congratulations! You now have a secure Java application that can produce and consume messages from Kafka.</p> 
<p>If you want to check out the complete source code for this tutorial, head over to&nbsp;<a href="https://github.com/oktadeveloper/okta-java-kafka-example" rel="noopener noreferrer" target="_blank">oktadeveloper/okta-java-kafka-example</a>&nbsp;on GitHub.</p> 
<p>Want to learn more about Java, security, and OAuth 2.0? Here are a few links you might be interested in:</p> 
<ul> 
 <li><a href="https://developer.okta.com/blog/2019/10/30/java-oauth2">OAuth 2.0 Java Guide: Secure Your App in 5 Minutes</a></li> 
 <li><a href="https://developer.okta.com/blog/2019/10/21/illustrated-guide-to-oauth-and-oidc">An Illustrated Guide to OAuth and OpenID Connect</a></li> 
 <li><a href="https://developer.okta.com/blog/2019/08/28/reactive-microservices-spring-cloud-gateway">Secure Reactive Microservices with Spring Cloud Gateway</a></li> 
</ul> 
<p>For more articles like this one, follow&nbsp;<a href="https://twitter.com/oktadev">@oktadev on Twitter</a>. We also regularly publish screencasts to&nbsp;<a href="https://youtube.com/c/oktadev">our YouTube channel</a>!</p> 
<p> <br> </p> 
<h2>Further Reading</h2> 
<ul> 
 <li><a href="https://dzone.com/articles/kafka-architecture">Kafka Architecture</a>.</li> 
 <li><a href="https://dzone.com/articles/how-to-setup-kafka-cluster">How to Setup a Kafka Cluster</a>.</li> 
 <li><a href="https://dzone.com/articles/an-overview-of-the-kafka-distributed-message-syste">An Overview of the Kafka Distributed Message System (Part 2)</a>.</li> 
</ul></div>
                </div>

                  <div id="bottom-bumper-container"></div>
                  <div class="article-tag-pill-container">
                      <span class="article-tag-pill">kafka</span>
                      <span class="article-tag-pill">mobile app</span>
                      <span class="article-tag-pill">Java (programming language)</span>
                      <span class="article-tag-pill">Spring Framework</span>
                      <span class="article-tag-pill">Spring Security</span>
                      <span class="article-tag-pill">cluster</span>
                      <span class="article-tag-pill">Command (computing)</span>
                  </div>

                  <div class="attribution">
                      <p>Published at DZone with permission of <span>Daniel Pereira</span>.
                        <span>
                          <a href="https://developer.okta.com/blog/2019/11/19/java-kafka?" target="_blank">See the original article here.
                            <i class="icon-link-ext-alt"></i>
                          </a>
                        </span>
                      </p>
                    <p>Opinions expressed by DZone contributors are their own.</p>
                  </div>

                    <div class="related">
                      <h3>Popular on DZone</h3>
                        <ul>
                            <li class="relateddiv">
                              <a href="/articles/9-extraordinary-terraform-best-practices-that-will?fromrel=true">9 Extraordinary Terraform Best Practices That Will Change Your Infra World</a>
                            </li>
                            <li class="relateddiv">
                              <a href="/articles/debugging-the-java-message-service-jms-api-using-l?fromrel=true">Debugging the Java Message Service (JMS) API Using Lightrun</a>
                            </li>
                            <li class="relateddiv">
                              <a href="/articles/role-of-development-team-in-an-agile-environment?fromrel=true">Role of Development Team in an Agile Environment</a>
                            </li>
                            <li class="relateddiv">
                              <a href="/articles/functional-vs-non-functional-requirements-the-full?fromrel=true">Functional vs. Non-Functional Requirements: The Full Guide, Definitions, and Technical Examples</a>
                            </li>
                        </ul>
                      </div>
<div class="comments-overlay"></div>
<div id="comment-box">
  <div class="comment-box-wrapper">
    <div id="comment-input-editor"></div>
  </div>
  <div class="info hidden"></div>
  <div class="comments-content">
    <div class="comment-header">
      <hr />
      <span class="icon-comment">
        <span class="numOfComments"></span> Comments
      </span>
    </div>
    <div class="comments"></div>
  </div>
</div>
            </article>
          </div>

            <div id="above-pr-ad" class="bottom-ad-container">
              <div id="div-gpt-ad-1435246566686-11" data-gpt-slot="bottom"></div>
            </div>
            <div class="layout-card widget-top-border partner-resources-block" style="width:100%; margin-bottom: 1em;">
              <div class="main-container">
                <div class="featured-header">
                  <h2>
                      Java<span> Partner Resources</span>
                  </h2>
                </div>
                <div class="partner-resources-container">
                  <div id="div-gpt-ad-1435246566686-5" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr1"></div>
                  <div id="div-gpt-ad-1435246566686-6" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr2"></div>
                  <div id="div-gpt-ad-1435246566686-7" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr3"></div>
                </div>
              </div>
            </div>
        </div>
      </div>
    </div>
  </div>

    <div id="bsa-parent" class="bottom-sticky-ad-container hide">
      <div class="container">
        <div class="col-md-9">
          <div class="fixed-bottom-div">
            <div class="inline-block">
              <div id="div-gpt-ad-1635294790718-12" data-gpt-desktop="true" class="bottom-sticky-ad"></div>
            </div>
            <div class="inline-block">
              <span id="close" class="bottom-sticky-ad-close-button" onclick="removeBottomStickyAd()">
                X
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>

  <div class="modal fade bd-example-modal-lg" id="modal-message" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header"></div>
        <div class="modal-body"></div>
      </div>
    </div>
  </div>
</div>

<script async>const articleTitle = 'Develop a Java Application With Kafka'
const articleUrl = 'https://dzone.com/articles/develop-a-java-app-with-kafka'

const retweetLink = document.querySelector('#tweet-link')

function retweet(event) {
    event.preventDefault()
    event.stopPropagation()

    const twitter = 'https://twitter.com/intent/tweet'
    const params = '?text=' + encodeURIComponent(articleTitle) + '&url=' + articleUrl + '&ref=dzone.com&via=DZoneInc'
    const win = window.open(twitter + params, '_blank')
    win.focus()
}

retweetLink.addEventListener('click', retweet);

function showStatusMessage(options) {
  var modal = document.getElementById("modal-message");

  if(modal) {
    modal.classList.add(options.type);
    var modalBody = modal.querySelector(".modal-content .modal-body");
    var modalHeader = modal.querySelector(".modal-content .modal-header");

    modalHeader.innerText = options.header ? options.header : "";
    modalBody.innerText = options.body ? options.body : "" ;

    $(modal).modal("show");

    $(modal).on('hidden.bs.modal', function () {
      modal.classList.remove(options.type);
    });
  }
}

function showConfirmMessage(options) {
  var modal = document.getElementById("modal-message");

  if(modal) {
    modal.classList.add(options.type);
    var modalBody = modal.querySelector(".modal-content .modal-body");
    var modalHeader = modal.querySelector(".modal-content .modal-header");

    modalHeader.innerText = options.header ? options.header : "";
    modalBody.innerText = options.body ? options.body : "" ;

    if (options.textarea) {
      const textareaDiv = document.createElement('div')
      const textareaLabel = document.createElement('label')
      textareaLabel.setAttribute('for', 'modal-textarea')
      textareaLabel.innerText = options.textarea.label

      const textarea = document.createElement('textarea')
      textarea.id = 'modal-textarea'
      textarea.placeholder = (options.textarea.placeholder || '')
      textarea.setAttribute('rows', (options.textarea.rows || 3))
      textarea.classList.add('form-control', 'not-resizable')

      if (options.textarea.maxlength) {
        textarea.maxLength = options.textarea.maxlength
      }

      textareaDiv.appendChild(textareaLabel)
      textareaDiv.appendChild(textarea)
      modalBody.appendChild(textareaDiv)
    }

    var btnContainer = document.createElement("div");
    btnContainer.classList.add("btn-container");

    var noBtn = document.createElement("button");
    noBtn.innerText = options.noBtnText ? options.noBtnText : "No";
    noBtn.classList.add("no-btn");

    var yesBtn = document.createElement("button");
    yesBtn.innerText = options.yesBtnText ? options.yesBtnText : "Yes";
    yesBtn.classList.add("yes-btn");

    btnContainer.appendChild(noBtn);
    btnContainer.appendChild(yesBtn);

    modalBody.appendChild(btnContainer);

    $(modal).modal("show");

    $(noBtn).one("click", function() {
      $(modal).modal("hide");

      if(options.noCallback) {
        $(modal).one('hidden.bs.modal', function () {
          options.noCallback();
        });
      }
    });

    $(yesBtn).one("click", function() {
      $(modal).modal("hide");

      if(options.yesCallback) {
        $(modal).one('hidden.bs.modal', function () {
          options.yesCallback();
        });
      }
    });

    $(modal).on('hidden.bs.modal', function () {
      modal.classList.remove(options.type);
    });
  }
}
</script><link rel="stylesheet" media="all" href="https://dz2cdn1.dzone.com/themes/dz20/ftl/footer/styles.css">

<div id="ftl-footer">
  <div class="container-fluid footerOuter">
    <div class="row">
      <div class="col-md-12">
        <div class="container">
          <div class="row footer">
            <div class="col-md-12 footerWidget">
              <div class="row footerContainer footer">
                <div class="left col-xs-12 col-sm-7">
                  <div class="col-xs-12 social-media-icons footer-mobile">
                    <ul class="icons-only">
                      <li class="rss-icon" id="rss-footer-1">
                        <a href="/pages/feeds" target="_blank" rel="noreferrer noopener">
                          <i class="icon-rss-1"></i>
                        </a>
                      </li>
                      <li class="twitter-icon">
                        <a href="https://twitter.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-twitter"></i>
                        </a>
                      </li>
                      <li class="facebook-icon">
                        <a href="https://www.facebook.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-facebook-1"></i>
                        </a>
                      </li>
                      <li class="linkedin-icon">
                        <a href="https://www.linkedin.com/company/dzone/" target="_blank"
                           rel="noreferrer noopener">
                          <i class="icon-linkedin-1"></i>
                        </a>
                      </li>
                    </ul>
                  </div>

                  <div class="top-section col-xs-12">
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">ABOUT US</p>
                      <ul class="link-group">
                        <li><a href="/pages/about" rel="noreferrer noopener">About DZone</a></li>
                        <li><a href="mailto:support@dzone.com" rel="noreferrer noopener">Send feedback</a></li>
                        <li><a href="https://careers.dzone.com/" target="_blank" rel="noreferrer noopener">Careers</a></li>
                          <li><a href="/sitemap" rel="noreferrer noopener">Sitemap</a></li>
                      </ul>
                    </div>
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">ADVERTISE</p>
                      <ul class="link-group">
                        <li><a href="https://advertise.dzone.com" target="_blank" rel="noreferrer noopener">Advertise with DZone</a></li>
                      </ul>
                    </div>
                  </div>

                  <div class="bottom-section col-xs-12">
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">CONTRIBUTE ON DZONE</p>
                      <ul class="bottom-top-list link-group">
                        <li><a href="/articles/dzones-article-submission-guidelines">Article Submission Guidelines</a></li>
                        <li><a href="/pages/mvb" rel="noreferrer noopener">MVB Program</a></li>
                        <li><a href="/pages/contribute" rel="noreferrer noopener">Become a Contributor</a></li>
                        <li><a href="/writers-zone" rel="noreferrer noopener">Visit the Writers' Zone</a></li>
                      </ul>

                      <p class="section-header">LEGAL</p>
                      <ul class="link-group">
                        <li><a href="/pages/tos" rel="noreferrer noopener">Terms of Service</a></li>
                        <li><a href="/pages/privacy" rel="noreferrer noopener">Privacy Policy</a></li>
                      </ul>
                    </div>
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">CONTACT US</p>
                      <ul class="link-group">
                        <li>600 Park Offices Drive</li>
                        <li>Suite 300</li>
                        <li>Durham, NC 27709</li>
                        <li><a href="mailto:support@dzone.com" rel="noreferrer noopener">support@dzone.com</a></li>
                        <li><a href="tel:+19196780300" rel="noreferrer noopener">+1 (919) 678-0300</a></li>
                      </ul>
                    </div>
                  </div>
                </div>

                <div class="right col-xs-12 col-sm-5">

                  <p class="connect-text">Let's be friends:</p>
                  <div class="col-xs-12 social-media-icons footer-wide">
                    <ul class="icons-only">
                      <li class="rss-icon" id="rss-footer-1">
                        <a href="/pages/feeds" target="_blank" rel="noreferrer noopener">
                          <i class="icon-rss-1"></i>
                        </a>
                      </li>
                      <li class="twitter-icon">
                        <a href="https://twitter.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-twitter"></i>
                        </a>
                      </li>
                      <li class="facebook-icon">
                        <a href="https://www.facebook.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-facebook-1"></i>
                        </a>
                      </li>
                      <li class="linkedin-icon">
                        <a href="https://www.linkedin.com/company/dzone/" target="_blank"
                           rel="noreferrer noopener">
                          <i class="icon-linkedin-1"></i>
                        </a>
                      </li>
                    </ul>
                  </div>

                  <div class="col-xs-12 powered-by">
                    <p>DZone.com is powered by&nbsp;</p>
                    <a href="https://devada.com/answerhub/" rel="noreferrer noopener">
                      <img src=""
                           data-src="https://dz2cdn1.dzone.com/themes/dz20/images/answerhub_logo_white_footer.png"
                           width="150"
                           height="56"
                           class="lazyload"
                           alt="AnswerHub logo">
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
  <script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>

  <script async>
      (function(w, d, s, l, i) {
          w[l] = w[l] || [];
          w[l].push({'gtm.start': new Date().getTime(), event: 'gtm.js'});
          var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
          j.async = true;
          j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
          f.parentNode.insertBefore(j,f);
      })(window, document, 'script', 'dataLayer', 'GTM-K25QL22');
  </script>

  <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-410289-1', 'auto');
      ga('require', 'linkid', 'linkid.js');
      ga('require', 'GTM-TSD9TZP');
      ga('set', 'siteSpeedSampleRate', 25);
  </script>
  <script async src="https://www.google-analytics.com/analytics.js"></script>
  <script async>const analytics = {
    'dimension1': 'java',
    'dimension2': 'article/tutorial',
    'dimension3': '2020-03-11',
    'dimension4': '0',
    'dimension5': '',
    'dimension7': 'kafka, mobile app, java, Spring Framework, Spring Security, cluster, command',
    'dimension8': 'denieus',
    'dimension9': 'undefined',
    'dimension10': 'undefined'
}

if (window.ga) {
    Object.keys(analytics).forEach(function(key) {
        window.ga('set', key, analytics[key])
    })

    window.ga('send', 'pageview')
}</script>

  <script>
      !function (e, o, n, i) {
          if (!e) {
              e = e || {}, window.permutive = e, e.q = [];
              var t = function () {
                  return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, function (e) {
                      return (e ^ (window.crypto || window.msCrypto).getRandomValues(new Uint8Array(1))[0] & 15 >> e / 4).toString(16)
                  })
              };
              e.config = i || {}, e.config.apiKey = o, e.config.workspaceId = n, e.config.environment = e.config.environment || "production", (window.crypto || window.msCrypto) && (e.config.viewId = t());
              for (var g = ["addon", "identify", "track", "trigger", "query", "segment", "segments", "ready", "on", "once", "user", "consent"], r = 0; r < g.length; r++) {
                  var w = g[r];
                  e[w] = function (o) {
                      return function () {
                          var n = Array.prototype.slice.call(arguments, 0);
                          e.q.push({
                              functionName: o,
                              arguments: n
                          })
                      }
                  }(w)
              }
          }
      }(window.permutive, "bca90777-e088-4f2a-96c2-13ad18deeccc", "18ad0c5b-460c-4d19-a729-dc537805538f", {});
      window.googletag = window.googletag || {}, window.googletag.cmd = window.googletag.cmd || [], window.googletag.cmd.push(function () {
          if (0 === window.googletag.pubads().getTargeting("permutive").length) {
              var e = window.localStorage.getItem("_pdfps");
              window.googletag.pubads().setTargeting("permutive", e ? JSON.parse(e) : []);
              var o = window.localStorage.getItem("permutive-id");
              o && (window.googletag.pubads().setTargeting("puid", o), window.googletag.pubads().setTargeting("ptime", Date.now().toString())), window.permutive.config.viewId && window.googletag.pubads().setTargeting("prmtvvid", window.permutive.config.viewId), window.permutive.config.workspaceId && window.googletag.pubads().setTargeting("prmtvwid", window.permutive.config.workspaceId)
          }
      });


      permutive.addon('web', {
          'page': {
              'category': 'Java',
              'node': {
                  'authorCompany': '',
                  'authors': [3948972, ],
                  'publishDate': new Date(1583884800000),
                  'sponsorAuthor': false,
                  'tags': ['kafka', 'mobile app', 'java', 'Spring Framework', 'Spring Security', 'cluster', 'command', ],
                  'title': 'Develop a Java Application With Kafka',
                  'type': 'article',
              },
              'section': 'article',
          }
      });
  </script>
  <script async src="https://18ad0c5b-460c-4d19-a729-dc537805538f.edge.permutive.app/18ad0c5b-460c-4d19-a729-dc537805538f-web.js"></script>

  <script>
      const csrf = '6974485787801004405'
      const articleId = 2927913
      const likes = 11
      const assetDomain = 'https://dz2cdn1.dzone.com'
      const codemirrorVars = {
          modeURI: 'https://dz2cdn1.dzone.com/themes/dz20/lib/codemirror/mode/',
          requiredScripts: [
              'https://dz2cdn1.dzone.com/themes/dz20/lib/codemirror/lib/codemirror.js',
              'https://dz2cdn1.dzone.com/themes/dz20/lib/codemirror/mode/meta.js'
          ]
      }

      const gptTags = {
          'zone': 'java',
          'topicTag': 'kafka,mobile app,java,Spring Framework,Spring Security,cluster,command',
          'company': '',
          'siteSection': 'Zones',
          'articleCategory': 'tutorial',
          'nodeID': '2927913',
          'authorID': '3948972',
          'publishYear': '2020',
          'publishMonth': '03',
          'jobRole': '',
          'companySize': ''
      }

      const minCommentChar = 10;
      const peer39Enabled = true;
  </script>

  <script src="https://dz2cdn1.dzone.com/themes/dz20/lib/static/jquery/jquery.min.js"></script>
  <script async src="https://dz2cdn1.dzone.com/themes/dz20/lib/static/bootstrap/bootstrap.min.js"></script>
  <script async src="https://dz2cdn1.dzone.com/themes/dz20/ftl/article/ads.js"></script>



  <script>
      function loadScript(src) {
          return new Promise(function (resolve, reject) {
              const s = document.createElement('script')
              s.src = src
              s.onload = resolve
              s.onerror = reject
              document.head.appendChild(s)
          })
      }

      function loadStyle(href) {
          const link = document.createElement('link')
          link.rel = 'stylesheet'
          link.href = href
          document.head.appendChild(link)
      }

      function loadScriptsSync(deferred) {
          var p = Promise.resolve()
          for (var i = 0; i < deferred.length; i++) {
              let script = deferred[i]
              p = p.then(function() {
                  return loadScript(script)
              })
          }
          return p
      }

      function loadStyles() {
          const deferred = [
              'https://dz2cdn1.dzone.com/themes/dz20/lib/codemirror/lib/codemirror.css',
              'https://dz2cdn1.dzone.com/themes/dz20/ftl/comments/styles.css',
              'https://dz2cdn1.dzone.com/themes/dz20/lib/froala3/css/froala_editor.pkgd.min.css',
              'https://dz2cdn1.dzone.com/themes/dz20/lib/froala3/css/themes/gray.min.css',
              'https://dz2cdn1.dzone.com/themes/dz20/ftl/article/mini-profile.css'
          ]

          for (var i = 0; i < deferred.length; i++) {
              loadStyle(deferred[i])
          }
      }

      window.addEventListener('load', function(event) {
          loadStyles()
          loadScriptsSync([
              'https://dz2cdn1.dzone.com/themes/dz20/ftl/header/auth-status.js',
              'https://dz2cdn1.dzone.com/themes/dz20/lib/lazysizes.min.js',
              'https://dz2cdn1.dzone.com/themes/dz20/ftl/article/codeblocks.js',
              'https://dz2cdn1.dzone.com/themes/dz20/ftl/article/activity-bar.js',
              'https://dz2cdn1.dzone.com/themes/dz20/lib/froala3/js/froala_editor.pkgd.min.js',
              'https://dz2cdn1.dzone.com/themes/dz20/ftl/froala/content.js',
              'https://dz2cdn1.dzone.com/themes/dz20/ftl/comments/content.js',
              'https://dz2cdn1.dzone.com/themes/dz20/ftl/article/content.js'
          ])
      })
  </script>
</body>
</html>