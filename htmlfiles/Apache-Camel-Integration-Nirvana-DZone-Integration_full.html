
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Take any integration project and you have multiple applications talking over multiple transports on multiple platforms. As you can imagine, in large enterprise...">
  <meta name="keywords" content="Enterprise integration, Apache Camel, Domain-Specific Language, listing, application, Spring Framework, Apache Maven, file IO, java, XML">

  <meta property="og:description" content="Take any integration project and you have multiple applications talking over multiple transports on multiple platforms. As you can imagine, in large enterprise...">
  <meta property="og:site_name" content="dzone.com">
  <meta property="og:title" content="Apache Camel: Integration Nirvana - DZone Integration">
  <meta property="og:url" content="https://dzone.com/articles/apache-camel-integration">
  <meta property="og:image" content="/themes/dz20/images/ArticleImg_6.jpg">
  <meta property="og:type" content="article">

  <meta name="twitter:site" content="@DZoneInc">
  <meta name="twitter:image" content="/themes/dz20/images/ArticleImg_6.jpg">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:description" content="Take any integration project and you have multiple applications talking over multiple transports on multiple platforms. As you can imagine, in large enterprise...">
  <meta name="twitter:title" content="Apache Camel: Integration Nirvana - DZone Integration">

  <meta name="referrer" content="origin-when-cross-origin">
  <meta name="google-site-verification" content="kndbhxcupfEqWmZclhCpB6vlgOs7QSmx2UHAGGnP2mA">
  <meta name="df-verify" content="df0d76632b4543">

  <link rel="icon" type="image/x-icon" href="https://dz2cdn2.dzone.com/themes/dz20/images/favicon.png">
  <link rel="image_src" href="/themes/dz20/images/ArticleImg_6.jpg">
  <link rel="canonical" href="https://dzone.com/articles/apache-camel-integration">

  <title>Apache Camel: Integration Nirvana - DZone Integration</title>

  <link rel="preload" href="https://fonts.dzone.com/themes/dz20/font/fontello.woff?11773374" as="font" type="font/woff" crossorigin="anonymous">

  <link rel="stylesheet" media="all" href="https://dz2cdn2.dzone.com/themes/dz20/ftl/icons.css">
  <link rel="stylesheet" media="all" href="https://dz2cdn2.dzone.com/themes/dz20/lib/static/bootstrap/bootstrap.min.css">
  <link rel="stylesheet" media="all" href="https://dz2cdn2.dzone.com/themes/dz20/ftl/article/global.css">
  <link rel="stylesheet" media="all" href="https://dz2cdn2.dzone.com/themes/dz20/ftl/header/styles.css">
</head>
<body>
<div id="ftl-header">
  <div class="container-fluid header">
    <div class="row">
      <div class="col-md-12" style="padding: 0;">
        <div class="header-top">
          <div class="header-container">
            <div class="pull-left logo-container">
              <div class="logo">
                <a class="inner" href="/">
                  <picture>
                    <source srcset="https://dz2cdn2.dzone.com/themes/dz20/images/dz_logo_2021_cropped.webp" type="image/webp">
                    <source srcset="https://dz2cdn2.dzone.com/themes/dz20/images/dz_logo_2021_cropped.png" type="image/png">
                    <img src="https://dz2cdn2.dzone.com/themes/dz20/images/dz_logo_2021_cropped.png" width="160" height="52" alt="DZone">
                  </picture>
                </a>
              </div>

                <div class="active-portal"><a href="/enterprise-integration-training-tools-news">Integration Zone</a></div>
            </div>

            <div class="pull-right login-and-search">
              <div id="authenticated-block" class="logged-in">
                <div class="welcome-back">Thanks for visiting DZone today,</div>
                <div id="user-header" class="user-info">
                  <button class="user-avatar">
                    <span id="header-username" class="username"></span>
                    <img id="header-avatar" src="" alt="user avatar">
                  </button>
                  <div id="user-dropdown" class="browse-user-menu">
                    <div class="user-content">
                      <a id="header-user-plug" href="#" class="user-description"></a>
                      <a id="header-user-edit" href="#" class="edit-profile">Edit Profile</a>
                    </div>
                    <ul class="user-actions">
                      <li id="first-user-action"><a id="header-dropdown-manage-email" href="#">Manage Email Subscriptions</a></li>
                      <li>
                        <a href="/articles/how-to-submit-a-post-to-dzone?utm_source=DZone&utm_medium=user_dropdown&utm_campaign=how_to_post">
                          How to Post to DZone
                        </a>
                      </li>
                      <li>
                        <a href="/articles/dzones-article-submission-guidelines">
                          Article Submission Guidelines
                        </a>
                      </li>
                    </ul>
                    <div class="bottom">
                      <a href="/users/logout.html" class="sign-out">Sign Out</a>
                      <a id="dropdown-view-profile" href="#" class="view-profile">View Profile</a>
                    </div>
                  </div>
                </div>

                <div class="post-content">
                  <button id="post-button" class="post-content--button">
                    <span class="post-class">Post</span>
                    <i class="icon-plus"></i>
                  </button>

                  <div id="post-menu" class="posting-links">
                    <div class="posting-links-menu">
                      <ul>
                        <li>
                          <img src="/themes/dz20/images/dz-postarticle.svg">
                          <a href="/content/article/post.html">Post an Article</a>
                        </li>
                        <li>
                          <a id="drafts-link" href="#">Manage My Drafts</a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>

              <div id="unauthenticated-block">
                <div class="dz-intro">Over 2 million developers have joined DZone.</div>
                <div class="mobile-invisible sign-in-join">
                  <a href="/users/login.html">Log In</a>
                  <span class="dz-intro-span">/</span>
                  <a href="/static/registration.html">Join</a>
                </div>
                <a class="join-icon" href="/users/login.html"><i class="icon-user"></i></a>
              </div>
              <div class="headerSearch">
                <a class="icon-search dropdown-toggle" href="/search"></a>
              </div>
            </div>
          </div>
        </div>

        <div class="header-bottom">


          <ul class="portals header-container scrollable-ul">
            <li>
              <a href="/refcardz" id="header-refcardz">
                <em>Refcardz</em>
              </a>
            </li>
            <li>
              <a href="/trendreports" id="header-research">
                <em>Trend Reports</em>
              </a>
            </li>
            <li>
              <a href="/webinars" id="header-webinars">
                <em>Webinars</em>
              </a>
            </li>
            <li class="last-portal-link">
              <a href="#" id="header-portals">
                <em>
                  Zones
                  <span id="zone-arrow" class="collapsible-toggle">
                    <i class="icon-angle-down"></i>
                    <i class="icon-angle-up"></i>
                  </span>
                </em>
              </a>
            </li>

            <li class="separator" aria-hidden="true" style="color: #d9dcdd;">|</li>
            <li id="portal-list" class="portal-topics">
              <ul>
                  <li>
                    <a href="/agile-methodology-training-tools-news" id="header-2">Agile</a>
                  </li>
                  <li>
                    <a href="/artificial-intelligence-tutorials-tools-news" id="header-4001">AI</a>
                  </li>
                  <li>
                    <a href="/big-data-analytics-tutorials-tools-news" id="header-3">Big Data</a>
                  </li>
                  <li>
                    <a href="/cloud-computing-tutorials-tools-news" id="header-4">Cloud</a>
                  </li>
                  <li>
                    <a href="/database-sql-nosql-tutorials-tools-news" id="header-5">Database</a>
                  </li>
                  <li>
                    <a href="/devops-tutorials-tools-news" id="header-6">DevOps</a>
                  </li>
                  <li>
                    <a href="/enterprise-integration-training-tools-news" id="header-7">Integration</a>
                  </li>
                  <li>
                    <a href="/iot-developer-tutorials-tools-news-reviews" id="header-8">IoT</a>
                  </li>
                  <li>
                    <a href="/java-jdk-development-tutorials-tools-news" id="header-1">Java</a>
                  </li>
                  <li>
                    <a href="/microservices-news-tutorials-tools" id="header-6001">Microservices</a>
                  </li>
                  <li>
                    <a href="/open-source-news-tutorials-tools" id="header-7001">Open Source</a>
                  </li>
                  <li>
                    <a href="/apm-tools-performance-monitoring-optimization" id="header-10">Performance</a>
                  </li>
                  <li>
                    <a href="/application-web-network-security" id="header-2001">Security</a>
                  </li>
                  <li>
                    <a href="/web-development-programming-tutorials-tools-news" id="header-11">Web Dev</a>
                  </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<script async src="https://dz2cdn2.dzone.com/themes/dz20/ftl/header/bundle.js"></script><link rel="stylesheet" media="all" href="https://dz2cdn2.dzone.com/themes/dz20/ftl/article/styles.css">




<div id="ftl-article" >
  <div class="container-fluid body">
    <div class="row">
      <div class="col-md-12">
        <div class="articles-wrap">
              <div class="ad-container">
                <div id="div-gpt-ad-1435246566686-0" class="ads-billboard-article" data-gpt-slot="top"></div>
              </div>


          <div class="article-stream widget-top-border">
                <div class="content-right-images">
                  <div id="div-gpt-ad-1435246566686-2" class="sidebar-ad" data-gpt-desktop="true" data-gpt-slot="sidebar1"></div>
                </div>

                <script type="application/ld+json">
                  {
                    "@context": "http://schema.org",
                    "@type": "Article",
                    "headline": "Apache Camel: Integration Nirvana",
                    "author": {
                      "@type": "Person",
                      "name": "Jonathan Anstey"
                    },
                    "audience": "software developers",
                    "keywords": "No keywords",
                    "timeRequired": "PT10M",
                    "commentCount": 29,
                    "wordCount": "2469",
                    "accessMode": "textual, visual",
                    "dateCreated": "2009-03-23T12:47:34Z",
                    "datePublished": "2009-03-23T12:47:34Z",
                    "dateModified": "2017-05-09T19:36:17Z",
                    "articleSection": "enterprise-integration-training-tools-news",
                    "publisher": {
                      "@type": "Organization",
                      "name": "DZone",
                      "url": "https://dzone.com",
                      "logo": {
                        "@type": "ImageObject",
                        "url": "https://dzone.com/themes/dz20/images/dz_logo_2021_cropped.png"
                      }
                    },
                    "articleBody": "Take any integration project and you have multiple applications talking over multiple transports on multiple platforms. As you can imagine, in large enterprise applications this can get complex very fast. Much of the complexity stems from two issues: 1. dealing with the specifics of applications and transports, and2. coming up with good solutions to integration problems. Making your applications speak transports and APIs is relatively easy on its own. I'm sure everyone knows how to send JMS messages to their broker of choice; though it still requires in depth knowledge of the JMS specification, which many developers may not have. On top of that, what happens when you want to route that JMS message to another application? You then have to take care of mapping the JMS message to the application plus handle any new concepts related to the application. Add a dozen other applications into the mix and you've got quite a headache on your hands.Ignoring the mechanics of how to connect with multiple transports and APIs, we can focus on the high level design of how applications interact. Fortunately, most solutions to enterprise integration problems have been formalized already. Gregor Hohpe and Bobby Woolfe's book, Enterprise Integration Patterns: Designing, Building, and Deploying Messaging Solutions, boils down years of experience from enterprise architects into a set of sixty five Enterprise Integration Patterns (EIPs). This is great but we still have to hand code all parts of these patterns; these are not packaged solutions, only recommendations. Apache Camel was created with the intention of addressing these two issues. In this article I'll show you how it actually does this. What is Camel? Apache Camel is an open source Java framework that focuses on making integration easier and more accessible to developers. It does this by providing: • concrete implementations of all the widely used EIPs • connectivity to a great variety of transports and APIs• easy to use Domain Specific Language (DSL) to wire EIPs and transports together Figure 1 shows how these three items actually map to Camel concepts. To give you a good understanding of how Camel is organized, we will discuss Components, Endpoints, Processors, and the Domain Specific Language (DSL). There is of course a lot more going on here under the hood but we'll leave that for another discussion. Figure 1: High level view of Camel's architecture.Components are the extension point in Camel to add connectivity to other systems. The core of Camel is very small to keep dependencies low, promote embeddability, etc. and as a result contains only 12 essential components. There are over 60 components outside the core. To expose these systems to the rest of Camel, Components provide an Endpoint interface. By using URIs, you can send or receive messages on Endpoints in a uniform way. For instance, to receive messages from a JMS queue aQueue and send them to a file system directory \"c:/tmp\", you could use URIs like \"jms:aQueue\" and \"file:c:\\tmp\".Processors are used to manipulate and mediate messages in between Endpoints. All of the EIPs are defined as Processors or sets of Processors. As of writing, Camel supports 41 patterns from the EIP book, 6 other integration patterns, and many other useful Processors.To wire Processors and Endpoints together, Camel defines a Java DSL. The term DSL is used a bit loosely here as it usually implies the involvement of a compiler or interpreter that can process keywords specific to a particular domain. In Camel, DSL means a fluent Java API that contains methods named like terms from the EIP book. Its best explained with an example from(\"jms:aQueue\") .filter().xpath(\"/person[@name='Jon']\") .to(\"file:c:\\tmp\"); Here we define a routing rule in a single Java statement that will consume messages from the \"jms:aQueue\" Endpoint, send them through a Message Filter Processor, which will then send on messages passing the XPath condition to the \"file:c:\\tmp\" endpoint. Messages failing the condition will be dropped.You can also configure your routes in a XML-based Spring configuration file. This configuration file is a lot more verbose and less auto complete friendly than the Java DSL; many prefer it though because of its direct access to Spring concepts and no requirement for compilation after changes. Here is what the earlier example would look like in Spring: &lt;camelContext xmlns=\"http://camel.apache.org/schema/spring\"&gt; &lt;route&gt; &lt;from uri=\"jms:aQueue\"/&gt; &lt;filter&gt; &lt;xpath&gt;/person[@name='Jon']&lt;/xpath&gt; &lt;to uri=\"file:c:\\tmp\"/&gt; &lt;/filter&gt; &lt;/route&gt;&lt;/camelContext&gt; These are the concepts that Camel was built upon. Since then many other interesting features have been added. Details of these are left up to the reader to investigate. To get you started, some of these include: • Pluggable data formats and type converters for easy message transformation between Artix Data Services, CSV, EDI, Flatpack, HL7, JAXB, JSON, XmlBeans, XStream, Zip, Camel-bindy, etc. • Pluggable languages to create expressions or predicates for use in the DSL. Some of these languages include: EL, JXPath, Mvel, OGNL, BeanShell, JavaScript, Groovy, Python, PHP, Ruby, SQL, XPath, XQuery, etc. • Support for the integration of beans and POJOs in various places in Camel. • Excellent support for testing distributed and asynchronous systems using a messaging approach• and much more... Example A motorcycle parts business, Rider Auto Parts, supplies parts to motorcycle manufacturers. Over the years they've changed the way they receive orders several times. Initially, orders were placed by uploading CSV files to an FTP server. The message format was later changed to XML. Currently they provide a web site to submit orders as XML messages over HTTP. All of these messages are converted to an internal POJO format before processing.Rider Auto Parts states to any new customers to use the web interface to place orders. However, because of existing agreements with customers, they must keep all the old message formats and interfaces up and running.Solution using EIPs Rider Auto Parts faces a pretty common problem; over years of operation businesses acquire software baggage in the form of transports/data formats that are popular at the time. Using patterns from the EIP book we can envision the solution as something like Figure 2. Figure 2: This shows the solution to Rider Auto Parts integration problem using notation from the Enterprise Integration Patterns book.So we have several patterns in use here.1. There are two Message Endpoints; one for FTP connectivity and another for HTTP.2. Messages from these endpoints are fed into the incomingOrderQueue Message Channel3. The messages are consumed from the incomingOrderQueue and routed by a Content-Based Router to one of two Message Translators. As the EIP name implies, the routing destination depends on the content of the message. In this case we need to route based on whether the content is a CSV or XML file.4. Both Message Translators convert the message content into a POJO, which is fed into the orderQueue Message Channel.The whole section that uses a Content-Based Router and several Message Translators is referred to as a Normalizer. This composite pattern has a unique graphic to depict it but was left out here in favor of its sub-patterns to make things clearer. Implementation using Camel As mentioned before, Camel has a small core set of components included by default. The rest of the components exist as separate modules. In applications that require many types of connectivity it is useful to figure out what Camel modules to include. Listing 1 shows the dependencies using Apache Maven for the Camel implementation of the Rider Auto Parts example. Of course, you don't need to use Apache Maven for dependencies - it is just the easiest way to rapidly add new dependencies to your applications. The list of dependencies includes support for core Camel, ActiveMQ, JAXB marshaling, CSV marshaling, and HTTP. To make the example easier to try out, I've opted to use the File endpoint instead of the FTP. If we were using the FTP endpoint we would need to add a dependency on the camel-ftp module as well.Listing 1: Maven dependencies for the Camel implementation &lt;dependencies&gt; &lt;!-- Core Camel support --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.camel&lt;/groupId&gt; &lt;artifactId&gt;camel-core&lt;/artifactId&gt; &lt;version&gt;${camel-version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.camel&lt;/groupId&gt; &lt;artifactId&gt;camel-spring&lt;/artifactId&gt; &lt;version&gt;${camel-version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- ActiveMQ connectivity for Camel --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.activemq&lt;/groupId&gt; &lt;artifactId&gt;activemq-camel&lt;/artifactId&gt; &lt;version&gt;${activemq-version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Add support for JAXB marshaling --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.camel&lt;/groupId&gt; &lt;artifactId&gt;camel-jaxb&lt;/artifactId&gt; &lt;version&gt;${camel-version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Add support for CSV marshaling --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.camel&lt;/groupId&gt; &lt;artifactId&gt;camel-csv&lt;/artifactId&gt; &lt;version&gt;${camel-version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Add support for HTTP --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.camel&lt;/groupId&gt; &lt;artifactId&gt;camel-jetty&lt;/artifactId&gt; &lt;version&gt;${camel-version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Embedded ActiveMQ broker --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.activemq&lt;/groupId&gt; &lt;artifactId&gt;activemq-core&lt;/artifactId&gt; &lt;version&gt;${activemq-version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.xbean&lt;/groupId&gt; &lt;artifactId&gt;xbean-spring&lt;/artifactId&gt; &lt;version&gt;${xbean-spring-version}&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; While it is perfectly legitimate to use Camel as a standalone Java application, it is often useful to embed it in a container. In this case, we will be loading Camel from Spring. The Spring beans XML file is shown in Listing 2. First we start an embedded Apache ActiveMQ broker and connect Camel to it. We also load up some helper beans that we will reference from the DSL. Finally, the camelContext element tells Camel to look for routes in the org.fusesource.camel package. Routes are Java classes that extend the RouteBuilder class in Camel.Listing 2: Spring XML file that configures an embedded ActiveMQ broker, several beans used in the Camel route, and initializes the Camel Context to search for routes in the org.fusesource.camel package. &lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\" http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd http://activemq.apache.org/camel/schema/spring http://activemq.apache.org/camel/schema/spring/camel-spring.xsd http://activemq.apache.org/schema/core http://activemq.apache.org/schema/core/activemq-core.xsd\"&gt; &lt;broker xmlns=\"http://activemq.apache.org/schema/core\" useJmx=\"false\" persistent=\"false\"&gt; &lt;transportConnectors&gt; &lt;transportConnector uri=\"tcp://localhost:61616\" /&gt; &lt;/transportConnectors&gt; &lt;/broker&gt; &lt;bean id=\"jms\" class=\"org.apache.activemq.camel.component.ActiveMQComponent\"&gt; &lt;property name=\"brokerURL\" value=\"tcp://localhost:61616\"/&gt; &lt;/bean&gt; &lt;bean id=\"normalizer\" class=\"org.fusesource.camel.OrderNormalizer\"/&gt; &lt;bean id=\"orderHelper\" class=\"org.fusesource.camel.OrderHelper\"/&gt; &lt;camelContext xmlns=\"http://activemq.apache.org/camel/schema/spring\"&gt; &lt;package&gt;org.fusesource.camel&lt;/package&gt; &lt;/camelContext&gt;&lt;/beans&gt; The real meat of the Camel implementation lies in the OrderRouter class (shown in Listing 3). This class extends RouteBuilder, so it will be automatically picked up and loaded by Camel's runtime.Looking back at Figure 2, we need to receive orders from an FTP (substituted with File) and HTTP endpoint, formatted as shown in Listing 4. In the DSL we can specify these incoming endpoints with two from elements. Both from elements are connected to a to(\"jms:incomingOrderQueue\") element, which will send the messages to a queue on the ActiveMQ broker.Listing 3: Route definitions for the example. The routing rules are specified using a fluent API, referred to as Camel's DSL. public class OrderRouter extends RouteBuilder { @Override public void configure() throws Exception { JaxbDataFormat jaxb = new JaxbDataFormat(\"org.fusesource.camel\"); // Receive orders from two endpoints from(\"file:src/data?noop=true\").to(\"jms:incomingOrderQueue\"); from(\"jetty:http://localhost:8888/placeorder\") .inOnly().to(\"jms:incomingOrderQueue\") .transform().constant(\"OK\"); // Do the normalization from(\"jms:incomingOrderQueue\") .convertBodyTo(String.class) .choice() .when().method(\"orderHelper\", \"isXml\") .unmarshal(jaxb) .to(\"jms:orderQueue\") .when().method(\"orderHelper\", \"isCsv\") .unmarshal().csv() .to(\"bean:normalizer\") .to(\"jms:orderQueue\"); } In the case of the HTTP endpoint, there are a couple of extra things to mention. First off the HTTP client will be expecting a response from the application so we have to handle that. In Camel, we have full control over what the client gets back from the HTTP endpoint. Each response is determined by the last method in our current route definition (each Java statement is a route definition). In our case we use the transform method to set the response to the constant string \"OK\". Since we handle the response ourselves, we don’t want any response to come from the JMS incomingOrderQueue. To send to this queue in a fire-and-forget fashion we add the inOnly modifier. It is important to note at this point that when writing Camel DSL in a modern Java IDE, selection of the next processing step is easy because of auto complete. The auto complete feature basically gives you a list of processors (i.e. EIPs) to choose from at any point in your route. Since fluent APIs chain methods together, the only method you need to remember is the from; all other methods are shown via auto complete.Listing 4: Incoming message formats; XML on top, CSV below. &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;order name=\"motor\" amount=\"1\"/&gt;\"name\", \"amount\"\"brake pad\", \"2\" The next section of DSL in Listing 3 specifies the Normalizer, complete with Content-Based Router and two Message Translators. First we specify that we want to consume messages from the incomingOrderQueue on the ActiveMQ broker. The content based routing of the messages is done with the choice and when methods. In our case, we want to send CSV messages to one Message Translator and XML messages to another. To check what type of message we have we will be using a simple Java bean shown in Listing 5. Of course, this is demonstration code only; for production cases you would want to add more thorough checking of content types.Listing 5: Java bean that contains helper methods to be used in the DSL. public class OrderHelper { public boolean isCsv(String body) { return !body.contains(\"&lt;?xml\"); } public boolean isXml(String body) { return body.contains(\"&lt;?xml\"); } If the message has XML content, we use the JAXB data format to unmarshal the XML payload into an Order object. As shown in Listing 6, the Order object has JAXB annotations to describe the mapping to XML. You of course don't need to use JAXB here; it just makes things very easy as you don't have to do any nasty XML parsing by hand.Listing 6: The Order domain class with JAXB annotations for easy mapping to and from XML. @XmlRootElement@XmlAccessorType(XmlAccessType.FIELD)public class Order implements Serializable { @XmlAttribute private String name; @XmlAttribute private int amount; public Order() { } public Order(String name, int amount) { this.name = name; this.amount = amount; } @Override public String toString() { return \"Order[\" + name + \" , \" + amount + \"]\"; } For the transformation from CSV to Order object, we don't have a nice JAXB analogue. We do have support in Camel for unmarhsaling CSV content into a List though. We use this in combination with a custom bean to do the complete transformation. The OrderNormalizer bean shown in Listing 7 takes the List of Lists created by the CSV unmarshaler and creates a new Order object from it.Listing 7: Java bean that takes the CSV data and creates a new Order domain object from it. public class OrderNormalizer { public Order fromCsvToOrder(List&lt;List&lt;String&gt;&gt; body) { List&lt;String&gt; orderHeaders = body.get(0); List&lt;String&gt; orderValues = body.get(1); return new Order(orderValues.get(0), Integer.parseInt(orderValues.get(1))); } At this point, successfully normalized messages are sent to the orderQueue for processing by some other application at the Rider Auto Parts business. Conclusion In this article I've shown two common problems that an integration developer may face: dealing with the specifics of applications and transports, and coming up with good solutions to integration problems. The Apache Camel project provides a nice answer to both of these problems. As the example has shown, solving integration problems with Camel is straight forward and results in relatively concise code. In my opinion it is the closest thing to integration nirvana that we have today. Links Apache Camel – http://camel.apache.org FUSE Mediation Router (based on Apache Camel) – http://fusesource.com/products/enterprise-camel Enterprise Integration Patterns – http://www.enterpriseintegrationpatterns.com Jon’s Blog – http://janstey.blogspot.com Camel in Action book - http://www.manning.com/ibsen Article source code - http://repo.fusesource.com/maven2/org/fusesource/examples/rider-auto-example/1.0/rider-auto-example-1.0.zip Author Jonathan Anstey is a senior engineer working for Progress Software Corporation specializing in the enterprise integration space. Jon focuses mostly on Apache Camel and its Progress endorsed likeness, FUSE Mediation Router. He also works on the Apache ActiveMQ and Apache ServiceMix projects",
                    "mainEntityOfPage": {
                      "@type": "WebPage",
                      "@id": "https://dzone.com/articles/apache-camel-integration"
                    },
                    "image": {
                      "@type": "ImageObject",
                      "url": "https://dzone.com/themes/dz20/images/dz_logo_2021_cropped.png"
                    }
                  }
                </script>

                  <script type="application/ld+json">
                    {
                      "@context": "https://schema.org",
                      "@type": "BreadcrumbList",
                      "itemListElement": [{
                        "@type": "ListItem",
                        "position": 1,
                        "name": "DZone",
                        "item": "https://dzone.com"
                      }, {
                        "@type": "ListItem",
                        "position": 2,
                        "name": "Integration Zone",
                        "item": "https://dzone.com/enterprise-integration-training-tools-news"
                      }, {
                        "@type": "ListItem",
                        "position": 3,
                        "name": "Apache Camel: Integration Nirvana",
                        "item": "https://dzone.com/articles/apache-camel-integration"
                      }]
                    }
                  </script>

            <article>
              <div class="content">
                <div class="header">
                  <div class="col-xs-12 breadcrumb-padding">
                    <a href="/">DZone</a>
                    >
                      <a href="/enterprise-integration-training-tools-news">Integration Zone</a>
                      >
                      <a href="#">Apache Camel: Integration Nirvana</a>
                  </div>


                  <div class="header-title">
                    <div class="title">
                      <h1 class="article-title">Apache Camel: Integration Nirvana</h1>
                    </div>

                    <div class="subhead">
                      <h3></h3>
                    </div>

                    <div class="publish-meta">
                        <div class="article-author-meta">
                          <img src="https://secure.gravatar.com/avatar/eee66d2bfce5ea2dd7c561d6000cef72?d=identicon&r=PG" class="avatar" alt="Jonathan Anstey user avatar" width="40">
                          by

                          <div class="author-info">
                            <span class="author-name">
                              <a href="/users/384134/janstey.html" rel="nofollow">Jonathan Anstey</a>
                            </span>
                          </div>




                          &middot;
                        </div>
                      <span class="author-date">
                        Mar. 23, 09
                      </span>
                      &middot;
                        <a href="/enterprise-integration-training-tools-news" id="portal-name">
                          <span class="portal-name">Integration Zone</span>
                        </a>
                      &middot;
                      <span>Interview</span>
                    </div>
                  </div>
                </div>

                <div class="author-n-useraction">
                  <div class="like action">
                    <div id="activity-like-icon" class="dz-like icon-thumbs-up">
                      <span class="action-label">
                        <span id="activity-like-text">Like</span>
                      </span>
                      <a href="#">
                        <span id="activity-like-counter">(8)</span>
                      </a>
                    </div>
                  </div>

                  <div class="action">

                    <button class="comment">
                      <i class="icon-comment"></i>
                      Comment
                      <span id="activity-comment-counter" class="comment-count"></span>
                    </button>
                  </div>

                  <div class="save action">
                    <div id="activity-save-icon" class="save icon-star-empty">
                      <span id="activity-save-text" class="action-label">Save</span>
                    </div>
                  </div>

                  <div class="tweet action">
                    <a id="tweet-link" href="" class="title" target="_blank">
                      <span><i class="icon-twitter"></i></span>
                      <span class="action-label">Tweet</span>
                    </a>
                  </div>

                  <div class="pull-right">
                    <div id="activity-view-container" class="article-views action">
                      <i class="icon-eye"></i> 219.54K
                      <span class="action-label">Views</span>
                    </div>
                  </div>
                </div>

                    <div class="signin-prompt">
                      <p>Join the DZone community and get the full member experience.</p>
                      <a id="article-signin-prompt" href="/static/registration.html">Join For Free</a>
                    </div>
                    <div class="arrow-down"></div>

                  <div id="top-bumper-container"></div>

                <div>
                  <div class="content-html"><p>Take any integration project and you have multiple applications talking over multiple transports on multiple platforms. As you can imagine, in large enterprise applications this can get complex very fast. Much of the complexity stems from two issues:</p><p>1.    dealing with the specifics of applications and transports, and<br />2.    coming up with good solutions to integration problems. <br /><br />Making your applications speak transports and APIs is relatively easy on its own. I'm sure everyone knows how to send JMS messages to their broker of choice; though it still requires in depth knowledge of the JMS specification, which many developers may not have. On top of that, what happens when you want to route that JMS message to another application? You then have to take care of mapping the JMS message to the application plus handle any new concepts related to the application. Add a dozen other applications into the mix and you've got quite a headache on your hands.<br /><br />Ignoring the mechanics of how to connect with multiple transports and APIs, we can focus on the high level design of how applications interact. Fortunately, most solutions to enterprise integration problems have been formalized already. Gregor Hohpe and Bobby Woolfe's book, Enterprise Integration Patterns: Designing, Building, and Deploying Messaging Solutions, boils down years of experience from enterprise architects into a set of sixty five Enterprise Integration Patterns (EIPs). This is great but we still have to hand code all parts of these patterns; these are not packaged solutions, only recommendations.   <br /><br />Apache Camel was created with the intention of addressing these two issues. In this article I'll show you how it actually does this.</p><h3>What is Camel? </h3><p>Apache Camel is an open source Java framework that focuses on making integration easier and more accessible to developers. It does this by providing:</p><p>•    concrete implementations of all the widely used EIPs <br />•    connectivity to a great variety of transports and APIs<br />•    easy to use Domain Specific Language (DSL) to wire EIPs and transports together <br /><br />Figure 1 shows how these three items actually map to Camel concepts. To give you a good understanding of how Camel is organized, we will discuss Components, Endpoints, Processors, and the Domain Specific Language (DSL). There is of course a lot more going on here under the hood but we'll leave that for another discussion.<br /><br />  <br /> <br />

</p><img src="/sites/all/files/camelArch1_0.jpg" alt="" width="600" height="356" />
<p>&nbsp;</p><p><strong>Figure 1: High level view of Camel's architecture.</strong><br /><br />Components are the extension point in Camel to add connectivity to other systems. The core of Camel is very small to keep dependencies low, promote embeddability, etc. and as a result contains only 12 essential components. There are over 60 components outside the core. To expose these systems to the rest of Camel, Components provide an Endpoint interface. By using URIs, you can send or receive messages on Endpoints in a uniform way. For instance, to receive messages from a JMS queue aQueue and send them to a file system directory &quot;c:/tmp&quot;, you could use URIs like &quot;jms:aQueue&quot; and &quot;file:c:\tmp&quot;.<br /><br />Processors are used to manipulate and mediate messages in between Endpoints. All of the EIPs are defined as Processors or sets of Processors. As of writing, Camel supports 41 patterns from the EIP book, 6 other integration patterns, and many other useful Processors.<br /><br />To wire Processors and Endpoints together, Camel defines a Java DSL. The term DSL is used a bit loosely here as it usually implies the involvement of a compiler or interpreter that can process keywords specific to a particular domain. In Camel, DSL means a fluent Java API that contains methods named like terms from the EIP book. Its best explained with an example</p><pre class="brush:shell">from(&quot;jms:aQueue&quot;)<br />  .filter().xpath(&quot;/person[@name='Jon']&quot;)<br />  .to(&quot;file:c:\tmp&quot;);</pre><p><br /><br />Here we define a routing rule in a single Java statement that will consume messages from the &quot;jms:aQueue&quot; Endpoint, send them through a Message Filter Processor, which will then send on messages passing the XPath condition to the &quot;file:c:\tmp&quot; endpoint. Messages failing the condition will be dropped.<br /><br />You can also configure your routes in a XML-based Spring configuration file. This configuration file is a lot more verbose and less auto complete friendly than the Java DSL; many prefer it though because of its direct access to Spring concepts and no requirement for compilation after changes. Here is what the earlier example would look like in Spring:</p><pre class="brush:xml">&lt;camelContext xmlns=&quot;http://camel.apache.org/schema/spring&quot;&gt;<br />  &lt;route&gt;<br />    &lt;from uri=&quot;jms:aQueue&quot;/&gt;<br />    &lt;filter&gt;<br />      &lt;xpath&gt;/person[@name='Jon']&lt;/xpath&gt;<br />      &lt;to uri=&quot;file:c:\tmp&quot;/&gt;<br />    &lt;/filter&gt;<br />  &lt;/route&gt;<br />&lt;/camelContext&gt;</pre><p><br /><br />

<!--pagebreak-->
These are the concepts that Camel was built upon. Since then many other interesting features have been added. Details of these are left up to the reader to investigate. To get you started, some of these include:</p><p>•    Pluggable data formats and type converters for easy message transformation between Artix Data Services, CSV, EDI, Flatpack, HL7, JAXB, JSON, XmlBeans, XStream, Zip, Camel-bindy, etc. <br />•    Pluggable languages to create expressions or predicates for use in the DSL. Some of these languages include: EL, JXPath, Mvel, OGNL, BeanShell, JavaScript, Groovy, Python, PHP, Ruby, SQL, XPath, XQuery, etc.  <br />•    Support for the integration of beans and POJOs in various places in Camel. <br />•    Excellent support for testing distributed and asynchronous systems using a messaging approach<br />•    and much more... </p><h3>Example </h3><p>A motorcycle parts business, Rider Auto Parts, supplies parts to motorcycle manufacturers. Over the years they've changed the way they receive orders several times. Initially, orders were placed by uploading CSV files to an FTP server. The message format was later changed to XML. Currently they provide a web site to submit orders as XML messages over HTTP. All of these messages are converted to an internal POJO format before processing.<br /><br />Rider Auto Parts states to any new customers to use the web interface to place orders. However, because of existing agreements with customers, they must keep all the old message formats and interfaces up and running.<br />Solution using EIPs <br /><br />Rider Auto Parts faces a pretty common problem; over years of operation businesses acquire software baggage in the form of transports/data formats that are popular at the time. Using patterns from the EIP book we can envision the solution as something like Figure 2. <br /><br /> <br />  <br />

</p><img src="/sites/all/files/riderAutoEips1_0.jpg" alt="" width="600" height="396" />
	
	
<p>&nbsp;</p><p><strong>Figure 2: This shows the solution to Rider Auto Parts integration problem using notation from the Enterprise Integration Patterns book.</strong><br /><br />So we have several patterns in use here.<br /><br />1. There are two Message Endpoints; one for FTP connectivity and another for HTTP.<br /><br />2. Messages from these endpoints are fed into the incomingOrderQueue Message Channel<br /><br />3. The messages are consumed from the incomingOrderQueue and routed by a Content-Based Router to one of two Message Translators. As the EIP name implies, the routing destination depends on the content of the message. In this case we need to route based on whether the content is a CSV or XML file.<br /><br />4. Both Message Translators convert the message content into a POJO, which is fed into the orderQueue Message Channel.<br /><br />The whole section that uses a Content-Based Router and several Message Translators is referred to as a Normalizer. This composite pattern has a unique graphic to depict it but was left out here in favor of its sub-patterns to make things clearer. </p><h3>Implementation using Camel </h3><p>As mentioned before, Camel has a small core set of components included by default. The rest of the components exist as separate modules. In applications that require many types of connectivity it is useful to figure out what Camel modules to include. Listing 1 shows the dependencies using Apache Maven for the Camel implementation of the Rider Auto Parts example. Of course, you don't need to use Apache Maven for dependencies - it is just the easiest way to rapidly add new dependencies to your applications. The list of dependencies includes support for core Camel, ActiveMQ, JAXB marshaling, CSV marshaling, and HTTP. To make the example easier to try out, I've opted to use the File endpoint instead of the FTP. If we were using the FTP endpoint we would need to add a dependency on the camel-ftp module as well.<br /><br />Listing 1: Maven dependencies for the Camel implementation</p><pre class="brush:xml">  &lt;dependencies&gt;<br />    &lt;!-- Core Camel support --&gt;     <br />    &lt;dependency&gt;<br />      &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;<br />      &lt;artifactId&gt;camel-core&lt;/artifactId&gt;<br />      &lt;version&gt;${camel-version}&lt;/version&gt;<br />    &lt;/dependency&gt;<br />    &lt;dependency&gt;<br />      &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;<br />      &lt;artifactId&gt;camel-spring&lt;/artifactId&gt;<br />      &lt;version&gt;${camel-version}&lt;/version&gt;<br />    &lt;/dependency&gt;<br />    <br />    &lt;!-- ActiveMQ connectivity for Camel --&gt;            <br />    &lt;dependency&gt;<br />      &lt;groupId&gt;org.apache.activemq&lt;/groupId&gt;<br />      &lt;artifactId&gt;activemq-camel&lt;/artifactId&gt;<br />      &lt;version&gt;${activemq-version}&lt;/version&gt;<br />    &lt;/dependency&gt;<br />    <br />    &lt;!-- Add support for JAXB marshaling --&gt;<br />    &lt;dependency&gt;<br />      &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;<br />      &lt;artifactId&gt;camel-jaxb&lt;/artifactId&gt;<br />      &lt;version&gt;${camel-version}&lt;/version&gt;<br />    &lt;/dependency&gt;<br />    <br />    &lt;!-- Add support for CSV marshaling --&gt;    <br />    &lt;dependency&gt;<br />      &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;<br />      &lt;artifactId&gt;camel-csv&lt;/artifactId&gt;<br />      &lt;version&gt;${camel-version}&lt;/version&gt;<br />   &lt;/dependency&gt;<br />    <br />    &lt;!-- Add support for HTTP --&gt;<br />    &lt;dependency&gt;<br />      &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;<br />      &lt;artifactId&gt;camel-jetty&lt;/artifactId&gt;<br />      &lt;version&gt;${camel-version}&lt;/version&gt;<br />    &lt;/dependency&gt;<br /><br />    &lt;!-- Embedded ActiveMQ broker --&gt;<br />    &lt;dependency&gt;<br />      &lt;groupId&gt;org.apache.activemq&lt;/groupId&gt;<br />      &lt;artifactId&gt;activemq-core&lt;/artifactId&gt;<br />      &lt;version&gt;${activemq-version}&lt;/version&gt;<br />    &lt;/dependency&gt;<br />    &lt;dependency&gt;<br />      &lt;groupId&gt;org.apache.xbean&lt;/groupId&gt;<br />      &lt;artifactId&gt;xbean-spring&lt;/artifactId&gt;<br />      &lt;version&gt;${xbean-spring-version}&lt;/version&gt;<br />    &lt;/dependency&gt;<br />  &lt;/dependencies&gt;</pre><p><br /><br /><br />

<!--pagebreak-->

While it is perfectly legitimate to use Camel as a standalone Java application, it is often useful to embed it in a container. In this case, we will be loading Camel from Spring. The Spring beans XML file is shown in Listing 2. First we start an embedded Apache ActiveMQ broker and connect Camel to it. We also load up some helper beans that we will reference from the DSL. Finally, the camelContext element tells Camel to look for routes in the org.fusesource.camel package. Routes are Java classes that extend the RouteBuilder class in Camel.<br /><br />Listing 2: Spring XML file that configures an embedded ActiveMQ broker, several beans used in the Camel route, and initializes the Camel Context to search for routes in the org.fusesource.camel package.</p><pre class="brush:xml">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;<br />       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;<br />       xsi:schemaLocation=&quot;<br />       http://www.springframework.org/schema/beans<br />       http://www.springframework.org/schema/beans/spring-beans-2.5.xsd<br />       http://activemq.apache.org/camel/schema/spring<br />       http://activemq.apache.org/camel/schema/spring/camel-spring.xsd<br />       http://activemq.apache.org/schema/core<br />       http://activemq.apache.org/schema/core/activemq-core.xsd&quot;&gt;<br /><br />  &lt;broker xmlns=&quot;http://activemq.apache.org/schema/core&quot; useJmx=&quot;false&quot; persistent=&quot;false&quot;&gt;<br />    &lt;transportConnectors&gt;<br />      &lt;transportConnector uri=&quot;tcp://localhost:61616&quot; /&gt;<br />    &lt;/transportConnectors&gt;<br />  &lt;/broker&gt;<br /><br />  &lt;bean id=&quot;jms&quot; class=&quot;org.apache.activemq.camel.component.ActiveMQComponent&quot;&gt;<br />    &lt;property name=&quot;brokerURL&quot; value=&quot;tcp://localhost:61616&quot;/&gt;<br />  &lt;/bean&gt;<br /><br />  &lt;bean id=&quot;normalizer&quot; class=&quot;org.fusesource.camel.OrderNormalizer&quot;/&gt;<br />  &lt;bean id=&quot;orderHelper&quot; class=&quot;org.fusesource.camel.OrderHelper&quot;/&gt;<br /> <br />  &lt;camelContext xmlns=&quot;http://activemq.apache.org/camel/schema/spring&quot;&gt;<br />    &lt;package&gt;org.fusesource.camel&lt;/package&gt;<br />  &lt;/camelContext&gt;<br /><br />&lt;/beans&gt;<br /></pre><p><br /><br />The real meat of the Camel implementation lies in the OrderRouter class (shown in Listing 3). This class extends RouteBuilder, so it will be automatically picked up and loaded by Camel's runtime.<br /><br />Looking back at Figure 2, we need to receive orders from an FTP (substituted with File) and HTTP endpoint, formatted as shown in Listing 4. In the DSL we can specify these incoming endpoints with two from elements. Both from elements are connected to a to(&quot;jms:incomingOrderQueue&quot;) element, which will send the messages to a queue on the ActiveMQ broker.<br /><br /><br /><br />Listing 3: Route definitions for the example. The routing rules are specified using a fluent API, referred to as Camel's DSL.</p><pre class="brush:java">public class OrderRouter extends RouteBuilder {<br /><br />    @Override<br />    public void configure() throws Exception {<br />        JaxbDataFormat jaxb = new JaxbDataFormat(&quot;org.fusesource.camel&quot;);<br />        <br />        // Receive orders from two endpoints<br />        from(&quot;file:src/data?noop=true&quot;).to(&quot;jms:incomingOrderQueue&quot;);<br />        from(&quot;jetty:http://localhost:8888/placeorder&quot;)<br />          .inOnly().to(&quot;jms:incomingOrderQueue&quot;)<br />          .transform().constant(&quot;OK&quot;);<br /><br />        // Do the normalization<br />        from(&quot;jms:incomingOrderQueue&quot;)<br />         .convertBodyTo(String.class)<br />         .choice()<br />           .when().method(&quot;orderHelper&quot;, &quot;isXml&quot;)<br />             .unmarshal(jaxb)<br />             .to(&quot;jms:orderQueue&quot;)<br />           .when().method(&quot;orderHelper&quot;, &quot;isCsv&quot;)<br />             .unmarshal().csv()         <br />             .to(&quot;bean:normalizer&quot;)<br />             .to(&quot;jms:orderQueue&quot;);<br />    }<br /><br />}</pre><p><br /><br />In the case of the HTTP endpoint, there are a couple of extra things to mention. First off the HTTP client will be expecting a response from the application so we have to handle that. In Camel, we have full control over what the client gets back from the HTTP endpoint. Each response is determined by the last method in our current route definition (each Java statement is a route definition). In our case we use the transform method to set the response to the constant string &quot;OK&quot;. Since we handle the response ourselves, we don’t want any response to come from the JMS incomingOrderQueue. To send to this queue in a fire-and-forget fashion we add the inOnly modifier.  <br /><br />It is important to note at this point that when writing Camel DSL in a modern Java IDE, selection of the next processing step is easy because of auto complete. The auto complete feature basically gives you a list of processors (i.e. EIPs) to choose from at any point in your route. Since fluent APIs chain methods together, the only method you need to remember is the from; all other methods are shown via auto complete.<br /><br /><br /><br />Listing 4: Incoming message formats; XML on top, CSV below.</p><pre class="brush:xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br />&lt;order name=&quot;motor&quot; amount=&quot;1&quot;/&gt;<br /><br />&quot;name&quot;, &quot;amount&quot;<br />&quot;brake pad&quot;, &quot;2&quot;<br /></pre><p><br /><br />The next section of DSL in Listing 3 specifies the Normalizer, complete with Content-Based Router and two Message Translators. First we specify that we want to consume messages from the incomingOrderQueue on the ActiveMQ broker. The content based routing of the messages is done with the choice and when methods. In our case, we want to send CSV messages to one Message Translator and XML messages to another. To check what type of message we have we will be using a simple Java bean shown in Listing 5. Of course, this is demonstration code only; for production cases you would want to add more thorough checking of content types.<br /><br />Listing 5: Java bean that contains helper methods to be used in the DSL.</p><pre class="brush:java">public class OrderHelper {<br />    public boolean isCsv(String body) {<br />        return !body.contains(&quot;&lt;?xml&quot;);<br />    }<br />    <br />    public boolean isXml(String body) {<br />        return body.contains(&quot;&lt;?xml&quot;);<br />    }<br />}</pre><p><br /><br />If the message has XML content, we use the JAXB data format to unmarshal the XML payload into an Order object. As shown in Listing 6, the Order object has JAXB annotations to describe the mapping to XML. You of course don't need to use JAXB here; it just makes things very easy as you don't have to do any nasty XML parsing by hand.<br /><br />Listing 6: The Order domain class with JAXB annotations for easy mapping to and from XML.</p><pre class="brush:java">@XmlRootElement<br />@XmlAccessorType(XmlAccessType.FIELD)<br />public class Order implements Serializable {<br />    @XmlAttribute<br />    private String name;<br />    @XmlAttribute<br />    private int amount;<br />    <br />    public Order() {<br />    }<br />    <br />    public Order(String name, int amount) {<br />        this.name = name;<br />        this.amount = amount;<br />    }<br />    <br />    @Override<br />    public String toString() {<br />        return &quot;Order[&quot; + name + &quot; , &quot; + amount + &quot;]&quot;;<br />    }<br />}</pre><p><br /><br />For the transformation from CSV to Order object, we don't have a nice JAXB analogue. We do have support in Camel for unmarhsaling CSV content into a List though. We use this in combination with a custom bean to do the complete transformation. The OrderNormalizer bean shown in Listing 7 takes the List of Lists created by the CSV unmarshaler and creates a new Order object from it.<br /><br />Listing 7: Java bean that takes the CSV data and creates a new Order domain object from it.</p><pre class="brush:java">public class OrderNormalizer {<br />    public Order fromCsvToOrder(List&lt;List&lt;String&gt;&gt; body) {<br />        List&lt;String&gt; orderHeaders = body.get(0);<br />        List&lt;String&gt; orderValues = body.get(1);<br />        return new Order(orderValues.get(0), Integer.parseInt(orderValues.get(1)));<br />    }<br />}</pre><p><br /><br />At this point, successfully normalized messages are sent to the orderQueue for processing by some other application at the Rider Auto Parts business.</p><h3>Conclusion </h3><p>In this article I've shown two common problems that an integration developer may face: dealing with the specifics of applications and transports, and coming up with good solutions to integration problems. The Apache Camel project provides a nice answer to both of these problems. As the example has shown, solving integration problems with Camel is straight forward and results in relatively concise code. In my opinion it is the closest thing to integration nirvana that we have today.</p><h4><strong>Links</strong></h4><ol><li>Apache Camel – <a href="http://camel.apache.org">http://camel.apache.org</a></li><li>FUSE Mediation Router (based on Apache Camel) – <a href="http://fusesource.com/products/enterprise-camel">http://fusesource.com/products/enterprise-camel</a></li><li>Enterprise Integration Patterns – <a href="http://www.enterpriseintegrationpatterns.com">http://www.enterpriseintegrationpatterns.com</a></li><li>Jon’s Blog – <a href="http://janstey.blogspot.com">http://janstey.blogspot.com</a></li><li>Camel in Action book - <a href="http://affiliate.manning.com/idevaffiliate.php?id=1152_215">http://www.manning.com/ibsen </a></li><li>Article source code - <a href="http://repo.fusesource.com/maven2/org/fusesource/examples/rider-auto-example/1.0/rider-auto-example-1.0.zip">http://repo.fusesource.com/maven2/org/fusesource/examples/rider-auto-example/1.0/rider-auto-example-1.0.zip</a></li></ol><h4><strong>Author</strong></h4><p>Jonathan Anstey is a senior engineer working for Progress Software Corporation specializing in the enterprise integration space. Jon focuses mostly on Apache Camel and its Progress endorsed likeness, FUSE Mediation Router. He also works on the Apache ActiveMQ and Apache ServiceMix projects  </p><p>&nbsp;</p></div>
                </div>

                  <div id="bottom-bumper-container"></div>
                  <div class="article-tag-pill-container">
                      <span class="article-tag-pill">Enterprise integration</span>
                      <span class="article-tag-pill">Apache Camel</span>
                      <span class="article-tag-pill">Domain-Specific Language</span>
                      <span class="article-tag-pill">Listing (computer)</span>
                      <span class="article-tag-pill">application</span>
                      <span class="article-tag-pill">Spring Framework</span>
                      <span class="article-tag-pill">Apache Maven</span>
                      <span class="article-tag-pill">file IO</span>
                      <span class="article-tag-pill">Java (programming language)</span>
                      <span class="article-tag-pill">XML</span>
                  </div>

                  <div class="attribution">
                    <p>Opinions expressed by DZone contributors are their own.</p>
                  </div>

                    <div class="related">
                      <h3>Popular on DZone</h3>
                        <ul>
                            <li class="relateddiv">
                              <a href="/articles/maven-nice-and-easy-video?fromrel=true">Maven Tutorial: Nice and Easy [Video]</a>
                            </li>
                            <li class="relateddiv">
                              <a href="/articles/testing-schema-registry-spring-boot-apache-kafka-with-json-schema?fromrel=true">Testing Schema Registry: Spring Boot and Apache Kafka With JSON Schema</a>
                            </li>
                            <li class="relateddiv">
                              <a href="/articles/creating-event-based-architecture-on-top-of-existi?fromrel=true">Creating Event-Based Architecture on Top of Existing API Ecosystem</a>
                            </li>
                            <li class="relateddiv">
                              <a href="/articles/what-is-httpsession-in-servlets-amp-httpsession-at?fromrel=true">What Is HttpSession in Servlets?</a>
                            </li>
                        </ul>
                      </div>
<div class="comments-overlay"></div>
<div id="comment-box">
  <div class="comment-box-wrapper">
    <div id="comment-input-editor"></div>
  </div>
  <div class="info hidden"></div>
  <div class="comments-content">
    <div class="comment-header">
      <hr />
      <span class="icon-comment">
        <span class="numOfComments"></span> Comments
      </span>
    </div>
    <div class="comments"></div>
  </div>
</div>
            </article>
          </div>

            <div id="above-pr-ad" class="bottom-ad-container">
              <div id="div-gpt-ad-1435246566686-11" data-gpt-slot="bottom"></div>
            </div>
            <div class="layout-card widget-top-border partner-resources-block" style="width:100%; margin-bottom: 1em;">
              <div class="main-container">
                <div class="featured-header">
                  <h2>
                      Integration<span> Partner Resources</span>
                  </h2>
                </div>
                <div class="partner-resources-container">
                  <div id="div-gpt-ad-1435246566686-5" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr1"></div>
                  <div id="div-gpt-ad-1435246566686-6" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr2"></div>
                  <div id="div-gpt-ad-1435246566686-7" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr3"></div>
                </div>
              </div>
            </div>
        </div>
      </div>
    </div>
  </div>

    <div id="bsa-parent" class="bottom-sticky-ad-container hide">
      <div class="container">
        <div class="col-md-9">
          <div class="fixed-bottom-div">
            <div class="inline-block">
              <div id="div-gpt-ad-1635294790718-12" data-gpt-desktop="true" class="bottom-sticky-ad"></div>
            </div>
            <div class="inline-block">
              <span id="close" class="bottom-sticky-ad-close-button" onclick="removeBottomStickyAd()">
                X
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>

  <div class="modal fade bd-example-modal-lg" id="modal-message" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header"></div>
        <div class="modal-body"></div>
      </div>
    </div>
  </div>
</div>

<script async>const articleTitle = 'Apache Camel: Integration Nirvana'
const articleUrl = 'https://dzone.com/articles/apache-camel-integration'

const retweetLink = document.querySelector('#tweet-link')

function retweet(event) {
    event.preventDefault()
    event.stopPropagation()

    const twitter = 'https://twitter.com/intent/tweet'
    const params = '?text=' + encodeURIComponent(articleTitle) + '&url=' + articleUrl + '&ref=dzone.com&via=DZoneInc'
    const win = window.open(twitter + params, '_blank')
    win.focus()
}

retweetLink.addEventListener('click', retweet);

function showStatusMessage(options) {
  var modal = document.getElementById("modal-message");

  if(modal) {
    modal.classList.add(options.type);
    var modalBody = modal.querySelector(".modal-content .modal-body");
    var modalHeader = modal.querySelector(".modal-content .modal-header");

    modalHeader.innerText = options.header ? options.header : "";
    modalBody.innerText = options.body ? options.body : "" ;

    $(modal).modal("show");

    $(modal).on('hidden.bs.modal', function () {
      modal.classList.remove(options.type);
    });
  }
}

function showConfirmMessage(options) {
  var modal = document.getElementById("modal-message");

  if(modal) {
    modal.classList.add(options.type);
    var modalBody = modal.querySelector(".modal-content .modal-body");
    var modalHeader = modal.querySelector(".modal-content .modal-header");

    modalHeader.innerText = options.header ? options.header : "";
    modalBody.innerText = options.body ? options.body : "" ;

    if (options.textarea) {
      const textareaDiv = document.createElement('div')
      const textareaLabel = document.createElement('label')
      textareaLabel.setAttribute('for', 'modal-textarea')
      textareaLabel.innerText = options.textarea.label

      const textarea = document.createElement('textarea')
      textarea.id = 'modal-textarea'
      textarea.placeholder = (options.textarea.placeholder || '')
      textarea.setAttribute('rows', (options.textarea.rows || 3))
      textarea.classList.add('form-control', 'not-resizable')

      if (options.textarea.maxlength) {
        textarea.maxLength = options.textarea.maxlength
      }

      textareaDiv.appendChild(textareaLabel)
      textareaDiv.appendChild(textarea)
      modalBody.appendChild(textareaDiv)
    }

    var btnContainer = document.createElement("div");
    btnContainer.classList.add("btn-container");

    var noBtn = document.createElement("button");
    noBtn.innerText = options.noBtnText ? options.noBtnText : "No";
    noBtn.classList.add("no-btn");

    var yesBtn = document.createElement("button");
    yesBtn.innerText = options.yesBtnText ? options.yesBtnText : "Yes";
    yesBtn.classList.add("yes-btn");

    btnContainer.appendChild(noBtn);
    btnContainer.appendChild(yesBtn);

    modalBody.appendChild(btnContainer);

    $(modal).modal("show");

    $(noBtn).one("click", function() {
      $(modal).modal("hide");

      if(options.noCallback) {
        $(modal).one('hidden.bs.modal', function () {
          options.noCallback();
        });
      }
    });

    $(yesBtn).one("click", function() {
      $(modal).modal("hide");

      if(options.yesCallback) {
        $(modal).one('hidden.bs.modal', function () {
          options.yesCallback();
        });
      }
    });

    $(modal).on('hidden.bs.modal', function () {
      modal.classList.remove(options.type);
    });
  }
}
</script><link rel="stylesheet" media="all" href="https://dz2cdn2.dzone.com/themes/dz20/ftl/footer/styles.css">

<div id="ftl-footer">
  <div class="container-fluid footerOuter">
    <div class="row">
      <div class="col-md-12">
        <div class="container">
          <div class="row footer">
            <div class="col-md-12 footerWidget">
              <div class="row footerContainer footer">
                <div class="left col-xs-12 col-sm-7">
                  <div class="col-xs-12 social-media-icons footer-mobile">
                    <ul class="icons-only">
                      <li class="rss-icon" id="rss-footer-1">
                        <a href="/pages/feeds" target="_blank" rel="noreferrer noopener">
                          <i class="icon-rss-1"></i>
                        </a>
                      </li>
                      <li class="twitter-icon">
                        <a href="https://twitter.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-twitter"></i>
                        </a>
                      </li>
                      <li class="facebook-icon">
                        <a href="https://www.facebook.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-facebook-1"></i>
                        </a>
                      </li>
                      <li class="linkedin-icon">
                        <a href="https://www.linkedin.com/company/dzone/" target="_blank"
                           rel="noreferrer noopener">
                          <i class="icon-linkedin-1"></i>
                        </a>
                      </li>
                    </ul>
                  </div>

                  <div class="top-section col-xs-12">
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">ABOUT US</p>
                      <ul class="link-group">
                        <li><a href="/pages/about" rel="noreferrer noopener">About DZone</a></li>
                        <li><a href="mailto:support@dzone.com" rel="noreferrer noopener">Send feedback</a></li>
                        <li><a href="https://careers.dzone.com/" target="_blank" rel="noreferrer noopener">Careers</a></li>
                          <li><a href="/sitemap" rel="noreferrer noopener">Sitemap</a></li>
                      </ul>
                    </div>
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">ADVERTISE</p>
                      <ul class="link-group">
                        <li><a href="https://advertise.dzone.com" target="_blank" rel="noreferrer noopener">Advertise with DZone</a></li>
                      </ul>
                    </div>
                  </div>

                  <div class="bottom-section col-xs-12">
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">CONTRIBUTE ON DZONE</p>
                      <ul class="bottom-top-list link-group">
                        <li><a href="/articles/dzones-article-submission-guidelines">Article Submission Guidelines</a></li>
                        <li><a href="/pages/mvb" rel="noreferrer noopener">MVB Program</a></li>
                        <li><a href="/pages/contribute" rel="noreferrer noopener">Become a Contributor</a></li>
                        <li><a href="/writers-zone" rel="noreferrer noopener">Visit the Writers' Zone</a></li>
                      </ul>

                      <p class="section-header">LEGAL</p>
                      <ul class="link-group">
                        <li><a href="/pages/tos" rel="noreferrer noopener">Terms of Service</a></li>
                        <li><a href="/pages/privacy" rel="noreferrer noopener">Privacy Policy</a></li>
                      </ul>
                    </div>
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">CONTACT US</p>
                      <ul class="link-group">
                        <li>600 Park Offices Drive</li>
                        <li>Suite 300</li>
                        <li>Durham, NC 27709</li>
                        <li><a href="mailto:support@dzone.com" rel="noreferrer noopener">support@dzone.com</a></li>
                        <li><a href="tel:+19196780300" rel="noreferrer noopener">+1 (919) 678-0300</a></li>
                      </ul>
                    </div>
                  </div>
                </div>

                <div class="right col-xs-12 col-sm-5">

                  <p class="connect-text">Let's be friends:</p>
                  <div class="col-xs-12 social-media-icons footer-wide">
                    <ul class="icons-only">
                      <li class="rss-icon" id="rss-footer-1">
                        <a href="/pages/feeds" target="_blank" rel="noreferrer noopener">
                          <i class="icon-rss-1"></i>
                        </a>
                      </li>
                      <li class="twitter-icon">
                        <a href="https://twitter.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-twitter"></i>
                        </a>
                      </li>
                      <li class="facebook-icon">
                        <a href="https://www.facebook.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-facebook-1"></i>
                        </a>
                      </li>
                      <li class="linkedin-icon">
                        <a href="https://www.linkedin.com/company/dzone/" target="_blank"
                           rel="noreferrer noopener">
                          <i class="icon-linkedin-1"></i>
                        </a>
                      </li>
                    </ul>
                  </div>

                  <div class="col-xs-12 powered-by">
                    <p>DZone.com is powered by&nbsp;</p>
                    <a href="https://devada.com/answerhub/" rel="noreferrer noopener">
                      <img src=""
                           data-src="https://dz2cdn2.dzone.com/themes/dz20/images/answerhub_logo_white_footer.png"
                           width="150"
                           height="56"
                           class="lazyload"
                           alt="AnswerHub logo">
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
  <script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>

  <script async>
      (function(w, d, s, l, i) {
          w[l] = w[l] || [];
          w[l].push({'gtm.start': new Date().getTime(), event: 'gtm.js'});
          var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
          j.async = true;
          j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
          f.parentNode.insertBefore(j,f);
      })(window, document, 'script', 'dataLayer', 'GTM-K25QL22');
  </script>

  <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-410289-1', 'auto');
      ga('require', 'linkid', 'linkid.js');
      ga('require', 'GTM-TSD9TZP');
      ga('set', 'siteSpeedSampleRate', 25);
  </script>
  <script async src="https://www.google-analytics.com/analytics.js"></script>
  <script async>const analytics = {
    'dimension1': 'integration',
    'dimension2': 'article/',
    'dimension3': '2009-03-23',
    'dimension4': '0',
    'dimension5': '',
    'dimension7': 'Enterprise integration, Apache Camel, Domain-Specific Language, listing, application, Spring Framework, Apache Maven, file IO, java, XML',
    'dimension8': 'janstey',
    'dimension9': 'undefined',
    'dimension10': 'Progress Software'
}

if (window.ga) {
    Object.keys(analytics).forEach(function(key) {
        window.ga('set', key, analytics[key])
    })

    window.ga('send', 'pageview')
}</script>

  <script>
      !function (e, o, n, i) {
          if (!e) {
              e = e || {}, window.permutive = e, e.q = [];
              var t = function () {
                  return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, function (e) {
                      return (e ^ (window.crypto || window.msCrypto).getRandomValues(new Uint8Array(1))[0] & 15 >> e / 4).toString(16)
                  })
              };
              e.config = i || {}, e.config.apiKey = o, e.config.workspaceId = n, e.config.environment = e.config.environment || "production", (window.crypto || window.msCrypto) && (e.config.viewId = t());
              for (var g = ["addon", "identify", "track", "trigger", "query", "segment", "segments", "ready", "on", "once", "user", "consent"], r = 0; r < g.length; r++) {
                  var w = g[r];
                  e[w] = function (o) {
                      return function () {
                          var n = Array.prototype.slice.call(arguments, 0);
                          e.q.push({
                              functionName: o,
                              arguments: n
                          })
                      }
                  }(w)
              }
          }
      }(window.permutive, "bca90777-e088-4f2a-96c2-13ad18deeccc", "18ad0c5b-460c-4d19-a729-dc537805538f", {});
      window.googletag = window.googletag || {}, window.googletag.cmd = window.googletag.cmd || [], window.googletag.cmd.push(function () {
          if (0 === window.googletag.pubads().getTargeting("permutive").length) {
              var e = window.localStorage.getItem("_pdfps");
              window.googletag.pubads().setTargeting("permutive", e ? JSON.parse(e) : []);
              var o = window.localStorage.getItem("permutive-id");
              o && (window.googletag.pubads().setTargeting("puid", o), window.googletag.pubads().setTargeting("ptime", Date.now().toString())), window.permutive.config.viewId && window.googletag.pubads().setTargeting("prmtvvid", window.permutive.config.viewId), window.permutive.config.workspaceId && window.googletag.pubads().setTargeting("prmtvwid", window.permutive.config.workspaceId)
          }
      });


      permutive.addon('web', {
          'page': {
              'category': 'Integration',
              'node': {
                  'authorCompany': 'Progress Software',
                  'authors': [384134, ],
                  'publishDate': new Date(1237812454000),
                  'sponsorAuthor': false,
                  'tags': ['Enterprise integration', 'Apache Camel', 'Domain-Specific Language', 'listing', 'application', 'Spring Framework', 'Apache Maven', 'file IO', 'java', 'XML', ],
                  'title': 'Apache Camel: Integration Nirvana',
                  'type': 'article',
              },
              'section': 'article',
          }
      });
  </script>
  <script async src="https://18ad0c5b-460c-4d19-a729-dc537805538f.edge.permutive.app/18ad0c5b-460c-4d19-a729-dc537805538f-web.js"></script>

  <script>
      const csrf = '8188225519218794401'
      const articleId = 472020
      const likes = 8
      const assetDomain = 'https://dz2cdn2.dzone.com'
      const codemirrorVars = {
          modeURI: 'https://dz2cdn2.dzone.com/themes/dz20/lib/codemirror/mode/',
          requiredScripts: [
              'https://dz2cdn2.dzone.com/themes/dz20/lib/codemirror/lib/codemirror.js',
              'https://dz2cdn2.dzone.com/themes/dz20/lib/codemirror/mode/meta.js'
          ]
      }

      const gptTags = {
          'zone': 'integration',
          'topicTag': 'Enterprise integration,Apache Camel,Domain-Specific Language,listing,application,Spring Framework,Apache Maven,file IO,java,XML',
          'company': '',
          'siteSection': 'Zones',
          'articleCategory': '',
          'nodeID': '472020',
          'authorID': '384134',
          'publishYear': '2009',
          'publishMonth': '03',
          'jobRole': '',
          'companySize': ''
      }

      const minCommentChar = 10;
      const peer39Enabled = true;
  </script>

  <script src="https://dz2cdn2.dzone.com/themes/dz20/lib/static/jquery/jquery.min.js"></script>
  <script async src="https://dz2cdn2.dzone.com/themes/dz20/lib/static/bootstrap/bootstrap.min.js"></script>
  <script async src="https://dz2cdn2.dzone.com/themes/dz20/ftl/article/ads.js"></script>



  <script>
      function loadScript(src) {
          return new Promise(function (resolve, reject) {
              const s = document.createElement('script')
              s.src = src
              s.onload = resolve
              s.onerror = reject
              document.head.appendChild(s)
          })
      }

      function loadStyle(href) {
          const link = document.createElement('link')
          link.rel = 'stylesheet'
          link.href = href
          document.head.appendChild(link)
      }

      function loadScriptsSync(deferred) {
          var p = Promise.resolve()
          for (var i = 0; i < deferred.length; i++) {
              let script = deferred[i]
              p = p.then(function() {
                  return loadScript(script)
              })
          }
          return p
      }

      function loadStyles() {
          const deferred = [
              'https://dz2cdn2.dzone.com/themes/dz20/lib/codemirror/lib/codemirror.css',
              'https://dz2cdn2.dzone.com/themes/dz20/ftl/comments/styles.css',
              'https://dz2cdn2.dzone.com/themes/dz20/lib/froala3/css/froala_editor.pkgd.min.css',
              'https://dz2cdn2.dzone.com/themes/dz20/lib/froala3/css/themes/gray.min.css',
              'https://dz2cdn2.dzone.com/themes/dz20/ftl/article/mini-profile.css'
          ]

          for (var i = 0; i < deferred.length; i++) {
              loadStyle(deferred[i])
          }
      }

      window.addEventListener('load', function(event) {
          loadStyles()
          loadScriptsSync([
              'https://dz2cdn2.dzone.com/themes/dz20/ftl/header/auth-status.js',
              'https://dz2cdn2.dzone.com/themes/dz20/lib/lazysizes.min.js',
              'https://dz2cdn2.dzone.com/themes/dz20/ftl/article/codeblocks.js',
              'https://dz2cdn2.dzone.com/themes/dz20/ftl/article/activity-bar.js',
              'https://dz2cdn2.dzone.com/themes/dz20/lib/froala3/js/froala_editor.pkgd.min.js',
              'https://dz2cdn2.dzone.com/themes/dz20/ftl/froala/content.js',
              'https://dz2cdn2.dzone.com/themes/dz20/ftl/comments/content.js',
              'https://dz2cdn2.dzone.com/themes/dz20/ftl/article/content.js'
          ])
      })
  </script>
</body>
</html>