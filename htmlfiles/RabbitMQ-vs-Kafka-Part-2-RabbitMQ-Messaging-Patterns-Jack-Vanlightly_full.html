<!doctype html>
<html xmlns:og="http://opengraphprotocol.org/schema/" xmlns:fb="http://www.facebook.com/2008/fbml" lang="en-US"  class="touch-styles">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- This is Squarespace. --><!-- jack-vanlightly-ay5j -->
<base href="">
<meta charset="utf-8" />
<title>RabbitMQ vs Kafka Part 2 - RabbitMQ Messaging Patterns &mdash; Jack Vanlightly</title>
<link rel="shortcut icon" type="image/x-icon" href="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1548695273661-8N6YB3OPIPU0DYE0BD7F/favicon.ico"/>
<link rel="canonical" href="https://jack-vanlightly.com/blog/2017/12/5/rabbitmq-vs-kafka-part-2-rabbitmq-messaging-patterns-and-topologies"/>
<meta property="og:site_name" content="Jack Vanlightly"/>
<meta property="og:title" content="RabbitMQ vs Kafka Part 2 - RabbitMQ Messaging Patterns &mdash; Jack Vanlightly"/>
<meta property="og:latitude" content="40.7207559"/>
<meta property="og:longitude" content="-74.00076130000002"/>
<meta property="og:locality" content=""/>
<meta property="og:url" content="https://jack-vanlightly.com/blog/2017/12/5/rabbitmq-vs-kafka-part-2-rabbitmq-messaging-patterns-and-topologies"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="In this part we're going to forget about the low level details in the protocols and concentrate on the higher level patterns and message topologies that can be achieved in RabbitMQ. In Part 3 of the series we'll do the same for Apache Kafka.  First we'll cover the building blocks, or routing primiti"/>
<meta property="og:image" content="http://static1.squarespace.com/static/56894e581c1210fead06f878/t/5a2819a9f9619a2b693b34fe/1512577456082/RabbitMQRoutingFanout.png?format=1500w"/>
<meta property="og:image:width" content="682"/>
<meta property="og:image:height" content="232"/>
<meta itemprop="name" content="RabbitMQ vs Kafka Part 2 - RabbitMQ Messaging Patterns — Jack Vanlightly"/>
<meta itemprop="url" content="https://jack-vanlightly.com/blog/2017/12/5/rabbitmq-vs-kafka-part-2-rabbitmq-messaging-patterns-and-topologies"/>
<meta itemprop="description" content="In this part we're going to forget about the low level details in the protocols and concentrate on the higher level patterns and message topologies that can be achieved in RabbitMQ. In Part 3 of the series we'll do the same for Apache Kafka.  First we'll cover the building blocks, or routing primiti"/>
<meta itemprop="thumbnailUrl" content="http://static1.squarespace.com/static/56894e581c1210fead06f878/t/5a2819a9f9619a2b693b34fe/1512577456082/RabbitMQRoutingFanout.png?format=1500w"/>
<link rel="image_src" href="http://static1.squarespace.com/static/56894e581c1210fead06f878/t/5a2819a9f9619a2b693b34fe/1512577456082/RabbitMQRoutingFanout.png?format=1500w" />
<meta itemprop="image" content="http://static1.squarespace.com/static/56894e581c1210fead06f878/t/5a2819a9f9619a2b693b34fe/1512577456082/RabbitMQRoutingFanout.png?format=1500w"/>
<meta itemprop="author" content="Jack Vanlightly"/>
<meta itemprop="datePublished" content="2017-12-10T23:46:42+0100"/>
<meta itemprop="dateModified" content="2019-11-28T17:52:59+0100"/>
<meta itemprop="headline" content="RabbitMQ vs Kafka Part 2 - RabbitMQ Messaging Patterns"/>
<meta itemprop="publisher" content="Jack Vanlightly"/>
<meta name="twitter:title" content="RabbitMQ vs Kafka Part 2 - RabbitMQ Messaging Patterns — Jack Vanlightly"/>
<meta name="twitter:image" content="http://static1.squarespace.com/static/56894e581c1210fead06f878/t/5a2819a9f9619a2b693b34fe/1512577456082/RabbitMQRoutingFanout.png?format=1500w"/>
<meta name="twitter:url" content="https://jack-vanlightly.com/blog/2017/12/5/rabbitmq-vs-kafka-part-2-rabbitmq-messaging-patterns-and-topologies"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:description" content="In this part we're going to forget about the low level details in the protocols and concentrate on the higher level patterns and message topologies that can be achieved in RabbitMQ. In Part 3 of the series we'll do the same for Apache Kafka.  First we'll cover the building blocks, or routing primiti"/>
<meta name="description" content="In this part we're going to forget about the low level details in the 
protocols and concentrate on the higher level patterns and message 
topologies that can be achieved in RabbitMQ. In Part 3 of the series we'll 
do the same for Apache Kafka.

First we'll cover the building blocks, or routing primitives, of RabbitMQ:

    * Exchange types and bindings
    * Queues
    * Dead letter exchanges
    * Ephemeral exchanges and queues
    * Alternate Exchanges
    * Priortity Queues

Then we'll combine them all into a set of example patterns." />
<link rel="preconnect" href="https://images.squarespace-cdn.com">
<script type="text/javascript" src="//use.typekit.net/ik/gt4QlwBC60O7kLtFloMzwPG_JM7_jY_y2yMz6G9KUeSfeC6ffFHN4UJLFRbh52jhWD9h52qXZQ9twAwUwRI3ZcmyZ2MhZR6a5g77MPG0-cBR-kuhjAoC-AiGieUoOABoFAG0SaBujW48Sagyjh90jhNlOeTyjhClicB0de81-YsCpPuypQm7O1FUiABkZWF3jAF8OcFzdPU7jAFnOWZydcUTZhyXdYq0jhNlOeUzjhBC-eNDifUaiaS0-cBR-kuhjAoC-AiGieUoOABoFAG0SaBujW48Sagyjh90jhNlOYiaiko7jAFnOWZydcUTZhyXdYq0jhNlJ6U3ScNt-AuyOAozicIKIcBqdh48OAiyScBldhoqOWgkdkG4f5J7IMMjMkMfH6qJn3IbMg6IJMJ7fbKlMsMMeMj6MKG4fJCgIMMjgkMfH6qJn6IbMg6bJMJ7fbKwMsMMegI6MKG4fVwXIMIjgfMfqMe_GZz5gb.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&family=PT+Sans:ital,wght@0,400;0,700;1,400">
<script type="text/javascript" crossorigin="anonymous" nomodule="nomodule" src="//assets.squarespace.com/@sqs/polyfiller/1.2.2/legacy.js"></script>
<script type="text/javascript" crossorigin="anonymous" src="//assets.squarespace.com/@sqs/polyfiller/1.2.2/modern.js"></script>
<script type="text/javascript">SQUARESPACE_ROLLUPS = {};</script>
<script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-runtime-df0bcb3fb161c9761a2a8-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_runtime');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/extract-css-runtime-df0bcb3fb161c9761a2a8-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-moment-js-vendor-0c99b8bf7f3dd5358b2f5-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_moment_js_vendor');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/extract-css-moment-js-vendor-0c99b8bf7f3dd5358b2f5-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-51def4af8f210f9d1e4fa-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-cldr_resource_pack');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-51def4af8f210f9d1e4fa-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-ffebe74ab4e46c76dc704-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors_stable');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-ffebe74ab4e46c76dc704-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-829d6b198168cd92a990c-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-vendors-829d6b198168cd92a990c-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-3dc426f4189145c20ad83-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-3dc426f4189145c20ad83-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/performance-496e3739d1c4053c9ea16-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-performance');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/performance-496e3739d1c4053c9ea16-min.en-US.js" defer ></script><script data-name="static-context">Static = window.Static || {}; Static.SQUARESPACE_CONTEXT = {"facebookAppId":"314192535267336","facebookApiVersion":"v6.0","rollups":{"squarespace-announcement-bar":{"js":"//assets.squarespace.com/universal/scripts-compressed/announcement-bar-8695b091db2cf6d0c8aa3-min.en-US.js"},"squarespace-audio-player":{"css":"//assets.squarespace.com/universal/styles-compressed/audio-player-70726ef1bec308aee857d-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/audio-player-7fc53ec897730ad932dd5-min.en-US.js"},"squarespace-blog-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/blog-collection-list-3d55c64c25996c7633fc2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/blog-collection-list-3a11c75798160d66ee949-min.en-US.js"},"squarespace-calendar-block-renderer":{"css":"//assets.squarespace.com/universal/styles-compressed/calendar-block-renderer-49c4a5f3dae67a728e3f4-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/calendar-block-renderer-be78355642f85532400ca-min.en-US.js"},"squarespace-chartjs-helpers":{"css":"//assets.squarespace.com/universal/styles-compressed/chartjs-helpers-53c004ac7d4bde1c92e38-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/chartjs-helpers-936c4382370d6194e0a13-min.en-US.js"},"squarespace-comments":{"css":"//assets.squarespace.com/universal/styles-compressed/comments-47af4e3e6819f8ce583ad-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/comments-f08f1e7023c546572a66e-min.en-US.js"},"squarespace-dialog":{"css":"//assets.squarespace.com/universal/styles-compressed/dialog-eb02dcb4b3625e38b5ed8-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/dialog-660f99a668c2a27bbe41c-min.en-US.js"},"squarespace-events-collection":{"css":"//assets.squarespace.com/universal/styles-compressed/events-collection-49c4a5f3dae67a728e3f4-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/events-collection-8ac0c601f21dada966c13-min.en-US.js"},"squarespace-form-rendering-utils":{"js":"//assets.squarespace.com/universal/scripts-compressed/form-rendering-utils-abd5211abdef95d992655-min.en-US.js"},"squarespace-forms":{"css":"//assets.squarespace.com/universal/styles-compressed/forms-7bb2169a5edade4c08ca7-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/forms-8fc2fa9f1965de8001652-min.en-US.js"},"squarespace-gallery-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/gallery-collection-list-3d55c64c25996c7633fc2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/gallery-collection-list-5c733ce28f15b61f41f05-min.en-US.js"},"squarespace-image-zoom":{"css":"//assets.squarespace.com/universal/styles-compressed/image-zoom-8804675084a3982b022e3-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/image-zoom-52ff6d015f277f1dc0b39-min.en-US.js"},"squarespace-pinterest":{"css":"//assets.squarespace.com/universal/styles-compressed/pinterest-3d55c64c25996c7633fc2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/pinterest-635e84ed935467d901585-min.en-US.js"},"squarespace-popup-overlay":{"css":"//assets.squarespace.com/universal/styles-compressed/popup-overlay-4d585c3ab0b56e73aacfb-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/popup-overlay-02cc7df0ead5038ee2cbd-min.en-US.js"},"squarespace-product-quick-view":{"css":"//assets.squarespace.com/universal/styles-compressed/product-quick-view-9eabb37cb7ba1b1da783a-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/product-quick-view-8bf2af8556832d770185e-min.en-US.js"},"squarespace-products-collection-item-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-item-v2-8804675084a3982b022e3-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-item-v2-1203b8be0dae645057fed-min.en-US.js"},"squarespace-products-collection-list-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-list-v2-8804675084a3982b022e3-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-list-v2-6cb603eb9b19ea2ae701d-min.en-US.js"},"squarespace-search-page":{"css":"//assets.squarespace.com/universal/styles-compressed/search-page-9d0a55de1efafbb9218e1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/search-page-75b82b62ef6494f78970b-min.en-US.js"},"squarespace-search-preview":{"js":"//assets.squarespace.com/universal/scripts-compressed/search-preview-1ba8fbb119237da52a76a-min.en-US.js"},"squarespace-simple-liking":{"css":"//assets.squarespace.com/universal/styles-compressed/simple-liking-ef94529873378652e6e86-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/simple-liking-6e6d68a9e23be5479af43-min.en-US.js"},"squarespace-social-buttons":{"css":"//assets.squarespace.com/universal/styles-compressed/social-buttons-1f18e025ea682ade6293a-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/social-buttons-536018914e6956436e4a8-min.en-US.js"},"squarespace-tourdates":{"css":"//assets.squarespace.com/universal/styles-compressed/tourdates-3d55c64c25996c7633fc2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/tourdates-5062cf043e216f3866c65-min.en-US.js"},"squarespace-website-overlays-manager":{"css":"//assets.squarespace.com/universal/styles-compressed/website-overlays-manager-e02f37cb215feb91e3a3f-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/website-overlays-manager-c72190fbde12aa3de04aa-min.en-US.js"}},"pageType":50,"website":{"id":"56894e581c1210fead06f878","identifier":"jack-vanlightly-ay5j","websiteType":1,"contentModifiedOn":1647950863974,"cloneable":false,"hasBeenCloneable":false,"siteStatus":{},"language":"en-US","timeZone":"Europe/Madrid","machineTimeZoneOffset":7200000,"timeZoneOffset":7200000,"timeZoneAbbr":"CEST","siteTitle":"Jack Vanlightly","fullSiteTitle":"RabbitMQ vs Kafka Part 2 - RabbitMQ Messaging Patterns \u2014 Jack Vanlightly","siteDescription":"","shareButtonOptions":{"6":true,"2":true,"8":true,"7":true,"3":true,"1":true,"4":true},"authenticUrl":"https://jack-vanlightly.com","internalUrl":"https://jack-vanlightly-ay5j.squarespace.com","baseUrl":"https://jack-vanlightly.com","primaryDomain":"jack-vanlightly.com","sslSetting":3,"isHstsEnabled":false,"typekitId":"","statsMigrated":false,"imageMetadataProcessingEnabled":false,"screenshotId":"81e052b35a85119a037791daf5e83a6ef8c0f3c2b2e88c3c1955544c110a477c","showOwnerLogin":false},"websiteSettings":{"id":"56894e581c1210fead06f87a","websiteId":"56894e581c1210fead06f878","type":"Personal","subjects":[],"country":"ES","state":"CT","simpleLikingEnabled":true,"mobileInfoBarSettings":{"isContactEmailEnabled":false,"isContactPhoneNumberEnabled":false,"isLocationEnabled":false,"isBusinessHoursEnabled":false},"commentLikesAllowed":true,"commentAnonAllowed":true,"commentThreaded":true,"commentApprovalRequired":false,"commentAvatarsOn":true,"commentSortType":2,"commentFlagThreshold":0,"commentFlagsAllowed":true,"commentEnableByDefault":true,"commentDisableAfterDaysDefault":0,"disqusShortname":"","commentsEnabled":true,"contactPhoneNumber":"","storeSettings":{"returnPolicy":null,"termsOfService":null,"privacyPolicy":null,"expressCheckout":false,"continueShoppingLinkUrl":"/","useLightCart":false,"showNoteField":false,"shippingCountryDefaultValue":"US","billToShippingDefaultValue":false,"showShippingPhoneNumber":true,"isShippingPhoneRequired":false,"showBillingPhoneNumber":true,"isBillingPhoneRequired":false,"currenciesSupported":["CHF","HKD","MXN","EUR","DKK","USD","CAD","MYR","NOK","THB","AUD","SGD","ILS","PLN","GBP","CZK","SEK","NZD","PHP","RUB"],"defaultCurrency":"USD","selectedCurrency":"USD","measurementStandard":2,"orderConfirmationInjectCode":"","showCustomCheckoutForm":false,"checkoutPageMarketingOptInEnabled":false,"enableMailingListOptInByDefault":true,"sameAsRetailLocation":false,"merchandisingSettings":{"scarcityEnabledOnProductItems":false,"scarcityEnabledOnProductBlocks":false,"scarcityMessageType":"DEFAULT_SCARCITY_MESSAGE","scarcityThreshold":10,"multipleQuantityAllowedForServices":true,"restockNotificationsEnabled":false,"restockNotificationsMailingListSignUpEnabled":false,"relatedProductsEnabled":false,"relatedProductsOrdering":"random","soldOutVariantsDropdownDisabled":false,"productComposerOptedIn":false,"productComposerABTestOptedOut":false,"productReviewsEnabled":false,"displayImportedProductReviewsEnabled":false,"hasOptedToCollectNativeReviews":false},"isLive":false,"multipleQuantityAllowedForServices":true},"useEscapeKeyToLogin":true,"ssBadgeType":1,"ssBadgePosition":4,"ssBadgeVisibility":1,"ssBadgeDevices":1,"pinterestOverlayOptions":{"mode":"disabled"},"ampEnabled":false},"cookieSettings":{"isCookieBannerEnabled":false,"isRestrictiveCookiePolicyEnabled":false,"isRestrictiveCookiePolicyAbsolute":false,"cookieBannerText":"","cookieBannerTheme":"","cookieBannerVariant":"","cookieBannerPosition":"","cookieBannerCtaVariant":"","cookieBannerCtaText":"","cookieBannerAcceptType":"OPT_IN","cookieBannerOptOutCtaText":""},"websiteCloneable":false,"collection":{"title":"Blog","id":"56894f3ea12f44306f8afde0","fullUrl":"/","publicCommentCount":0,"type":1,"permissionType":1},"item":{"title":"RabbitMQ vs Kafka Part 2 - RabbitMQ Messaging Patterns","id":"5a271bad41920214cc8a1ea5","fullUrl":"/blog/2017/12/5/rabbitmq-vs-kafka-part-2-rabbitmq-messaging-patterns-and-topologies","publicCommentCount":19,"commentState":1,"recordType":1},"subscribed":false,"appDomain":"squarespace.com","templateTweakable":true,"tweakJSON":{"aspect-ratio":"Auto","banner-slideshow-controls":"Arrows","gallery-arrow-style":"No Background","gallery-aspect-ratio":"3:2 Standard","gallery-auto-crop":"true","gallery-autoplay":"false","gallery-design":"Grid","gallery-info-overlay":"Show on Hover","gallery-loop":"false","gallery-navigation":"Bullets","gallery-show-arrows":"true","gallery-transitions":"Fade","galleryArrowBackground":"rgba(34,34,34,1)","galleryArrowColor":"rgba(255,255,255,1)","galleryAutoplaySpeed":"3","galleryCircleColor":"rgba(255,255,255,1)","galleryInfoBackground":"rgba(0, 0, 0, .7)","galleryThumbnailSize":"100px","gridSize":"280px","gridSpacing":"10px","logoContainerWidth":"140px","product-gallery-auto-crop":"false","product-image-auto-crop":"true","siteTitleContainerWidth":"220px","tweak-v1-related-products-title-spacing":"50px"},"templateId":"52a74dafe4b073a80cd253c5","templateVersion":"7","pageFeatures":[1,2,4],"gmRenderKey":"QUl6YVN5Q0JUUk9xNkx1dkZfSUUxcjQ2LVQ0QWVUU1YtMGQ3bXk4","templateScriptsRootUrl":"https://static1.squarespace.com/static/ta/52a74d9ae4b0253945d2aee9/1043/scripts/","betaFeatureFlags":["campaigns_content_editing_survey","send_local_pickup_ready_email","commerce_restock_notifications","commerce_etsy_shipping_import","campaigns_new_subscriber_search","crm_show_subscriber_import_in_profiles","campaigns_attached_to_scheduling","product_composer_feedback_form_on_save","reduce_general_search_api_traffic","scheduling_block_schema_editor","campaigns_global_uc_ab","commerce_site_visitor_metrics","customer_account_creation_recaptcha","background_art_onboarding","commerce_clearpay","campaigns_thumbnail_layout","member_areas_schedule_interview","member_areas_spanish_interviews","commerce_etsy_product_import","nested_categories_migration_enabled","asset_uploader_refactor","viewer-role-contributor-invites","commerce_category_id_discounts_enabled"],"impersonatedSession":false,"tzData":{"zones":[[60,"EU","CE%sT",null]],"rules":{"EU":[[1981,"max",null,"Mar","lastSun","1:00u","1:00","S"],[1996,"max",null,"Oct","lastSun","1:00u","0",null]]}},"showAnnouncementBar":false};</script><script type="text/javascript"> SquarespaceFonts.loadViaContext(); Squarespace.load(window);</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://jack-vanlightly.com/blog?format=rss" />
<script type="application/ld+json">{"url":"https://jack-vanlightly.com","name":"Jack Vanlightly","description":"","@context":"http://schema.org","@type":"WebSite"}</script><script type="application/ld+json">{"name":"RabbitMQ vs Kafka Part 2 - RabbitMQ Messaging Patterns \u2014 Jack Vanlightly","url":"https://jack-vanlightly.com/blog/2017/12/5/rabbitmq-vs-kafka-part-2-rabbitmq-messaging-patterns-and-topologies","datePublished":"2017-12-10T23:46:42+0100","dateModified":"2019-11-28T17:52:59+0100","headline":"RabbitMQ vs Kafka Part 2 - RabbitMQ Messaging Patterns","author":"Jack Vanlightly","publisher":{"name":"Jack Vanlightly","logo":{"@type":"ImageObject"},"@context":"http://schema.org","@type":"Organization"},"image":"http://static1.squarespace.com/static/56894e581c1210fead06f878/t/5a2819a9f9619a2b693b34fe/1512577456082/RabbitMQRoutingFanout.png?format=1500w","@context":"http://schema.org","@type":"Article"}</script><link rel="stylesheet" type="text/css" href="https://static1.squarespace.com/static/sitecss/56894e581c1210fead06f878/57/52a74dafe4b073a80cd253c5/58161c73f7e0ab86f3c7deca/1043/site.css"/><meta name="google-site-verification" content="7YOpYadqgcwvgZB4FdOXOk6Ncy9genGABJy1FjE0kiQ" />
<meta name="google-site-verification" content="7YOpYadqgcwvgZB4FdOXOk6Ncy9genGABJy1FjE0kiQ" />
<style>
.non-code-block
{
    background-color:#bfc0c1;
    width:auto;
    margin:5px;
    padding:5px;
  	border-radius: 5px;
}
</style>
<style>
/* http://prismjs.com/download.html?themes=prism-okaidia&languages=markup+css+clike+javascript+aspnet+csharp+fsharp+go+python+sql */
/**
 * okaidia theme for JavaScript, CSS and HTML
 * Loosely based on Monokai textmate theme by http://www.monokai.nl/
 * @author ocodia
 */

code[class*="language-"],
pre[class*="language-"] {
	color: #f8f8f2;
	background: none;
	text-shadow: 0 1px rgba(0, 0, 0, 0.3);
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;
    font-size: 13px;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
	border-radius: 0.3em;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #272822;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #f8f8f2;
}

.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.constant,
.token.symbol,
.token.deleted {
	color: #f92672;
}

.token.boolean,
.token.number {
	color: #ae81ff;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #a6e22e;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string,
.token.variable {
	color: #f8f8f2;
}

.token.atrule,
.token.attr-value,
.token.function {
	color: #e6db74;
}

.token.keyword {
	color: #66d9ef;
}

.token.regex,
.token.important {
	color: #fd971f;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
</style>
<script>
/* http://prismjs.com/download.html?themes=prism-dark&languages=markup+css+clike+javascript+aspnet+csharp+fsharp+go+python+sql */
var _self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(){var e=/\blang(?:uage)?-(\w+)\b/i,t=0,n=_self.Prism={util:{encode:function(e){return e instanceof a?new a(e.type,n.util.encode(e.content),e.alias):"Array"===n.util.type(e)?e.map(n.util.encode):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++t}),e.__id},clone:function(e){var t=n.util.type(e);switch(t){case"Object":var a={};for(var r in e)e.hasOwnProperty(r)&&(a[r]=n.util.clone(e[r]));return a;case"Array":return e.map&&e.map(function(e){return n.util.clone(e)})}return e}},languages:{extend:function(e,t){var a=n.util.clone(n.languages[e]);for(var r in t)a[r]=t[r];return a},insertBefore:function(e,t,a,r){r=r||n.languages;var i=r[e];if(2==arguments.length){a=arguments[1];for(var l in a)a.hasOwnProperty(l)&&(i[l]=a[l]);return i}var o={};for(var s in i)if(i.hasOwnProperty(s)){if(s==t)for(var l in a)a.hasOwnProperty(l)&&(o[l]=a[l]);o[s]=i[s]}return n.languages.DFS(n.languages,function(t,n){n===r[e]&&t!=e&&(this[t]=o)}),r[e]=o},DFS:function(e,t,a,r){r=r||{};for(var i in e)e.hasOwnProperty(i)&&(t.call(e,i,e[i],a||i),"Object"!==n.util.type(e[i])||r[n.util.objId(e[i])]?"Array"!==n.util.type(e[i])||r[n.util.objId(e[i])]||(r[n.util.objId(e[i])]=!0,n.languages.DFS(e[i],t,i,r)):(r[n.util.objId(e[i])]=!0,n.languages.DFS(e[i],t,null,r)))}},plugins:{},highlightAll:function(e,t){for(var a,r=document.querySelectorAll('code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'),i=0;a=r[i++];)n.highlightElement(a,e===!0,t)},highlightElement:function(t,a,r){for(var i,l,o=t;o&&!e.test(o.className);)o=o.parentNode;o&&(i=(o.className.match(e)||[,""])[1],l=n.languages[i]),t.className=t.className.replace(e,"").replace(/\s+/g," ")+" language-"+i,o=t.parentNode,/pre/i.test(o.nodeName)&&(o.className=o.className.replace(e,"").replace(/\s+/g," ")+" language-"+i);var s=t.textContent,u={element:t,language:i,grammar:l,code:s};if(!s||!l)return n.hooks.run("complete",u),void 0;if(n.hooks.run("before-highlight",u),a&&_self.Worker){var c=new Worker(n.filename);c.onmessage=function(e){u.highlightedCode=e.data,n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(u.element),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},c.postMessage(JSON.stringify({language:u.language,code:u.code,immediateClose:!0}))}else u.highlightedCode=n.highlight(u.code,u.grammar,u.language),n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(t),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},highlight:function(e,t,r){var i=n.tokenize(e,t);return a.stringify(n.util.encode(i),r)},tokenize:function(e,t){var a=n.Token,r=[e],i=t.rest;if(i){for(var l in i)t[l]=i[l];delete t.rest}e:for(var l in t)if(t.hasOwnProperty(l)&&t[l]){var o=t[l];o="Array"===n.util.type(o)?o:[o];for(var s=0;s<o.length;++s){var u=o[s],c=u.inside,g=!!u.lookbehind,f=0,h=u.alias;u=u.pattern||u;for(var p=0;p<r.length;p++){var d=r[p];if(r.length>e.length)break e;if(!(d instanceof a)){u.lastIndex=0;var m=u.exec(d);if(m){g&&(f=m[1].length);var y=m.index-1+f,m=m[0].slice(f),v=m.length,b=y+v,k=d.slice(0,y+1),w=d.slice(b+1),_=[p,1];k&&_.push(k);var P=new a(l,c?n.tokenize(m,c):m,h);_.push(P),w&&_.push(w),Array.prototype.splice.apply(r,_)}}}}}return r},hooks:{all:{},add:function(e,t){var a=n.hooks.all;a[e]=a[e]||[],a[e].push(t)},run:function(e,t){var a=n.hooks.all[e];if(a&&a.length)for(var r,i=0;r=a[i++];)r(t)}}},a=n.Token=function(e,t,n){this.type=e,this.content=t,this.alias=n};if(a.stringify=function(e,t,r){if("string"==typeof e)return e;if("Array"===n.util.type(e))return e.map(function(n){return a.stringify(n,t,e)}).join("");var i={type:e.type,content:a.stringify(e.content,t,r),tag:"span",classes:["token",e.type],attributes:{},language:t,parent:r};if("comment"==i.type&&(i.attributes.spellcheck="true"),e.alias){var l="Array"===n.util.type(e.alias)?e.alias:[e.alias];Array.prototype.push.apply(i.classes,l)}n.hooks.run("wrap",i);var o="";for(var s in i.attributes)o+=(o?" ":"")+s+'="'+(i.attributes[s]||"")+'"';return"<"+i.tag+' class="'+i.classes.join(" ")+'" '+o+">"+i.content+"</"+i.tag+">"},!_self.document)return _self.addEventListener?(_self.addEventListener("message",function(e){var t=JSON.parse(e.data),a=t.language,r=t.code,i=t.immediateClose;_self.postMessage(n.highlight(r,n.languages[a],a)),i&&_self.close()},!1),_self.Prism):_self.Prism;var r=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return r&&(n.filename=r.src,document.addEventListener&&!r.hasAttribute("data-manual")&&document.addEventListener("DOMContentLoaded",n.highlightAll)),_self.Prism}();"undefined"!=typeof module&&module.exports&&(module.exports=Prism),"undefined"!=typeof global&&(global.Prism=Prism);
Prism.languages.markup={comment:/<!--[\w\W]*?-->/,prolog:/<\?[\w\W]+?\?>/,doctype:/<!DOCTYPE[\w\W]+?>/,cdata:/<!\[CDATA\[[\w\W]*?]]>/i,tag:{pattern:/<\/?(?!\d)[^\s>\/=.$<]+(?:\s+[^\s>\/=]+(?:=(?:("|')(?:\\\1|\\?(?!\1)[\w\W])*\1|[^\s'">=]+))?)*\s*\/?>/i,inside:{tag:{pattern:/^<\/?[^\s>\/]+/i,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"attr-value":{pattern:/=(?:('|")[\w\W]*?(\1)|[^\s>]+)/i,inside:{punctuation:/[=>"']/}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:/&#?[\da-z]{1,8};/i},Prism.hooks.add("wrap",function(a){"entity"===a.type&&(a.attributes.title=a.content.replace(/&amp;/,"&"))}),Prism.languages.xml=Prism.languages.markup,Prism.languages.html=Prism.languages.markup,Prism.languages.mathml=Prism.languages.markup,Prism.languages.svg=Prism.languages.markup;
Prism.languages.css={comment:/\/\*[\w\W]*?\*\//,atrule:{pattern:/@[\w-]+?.*?(;|(?=\s*\{))/i,inside:{rule:/@[\w-]+/}},url:/url\((?:(["'])(\\(?:\r\n|[\w\W])|(?!\1)[^\\\r\n])*\1|.*?)\)/i,selector:/[^\{\}\s][^\{\};]*?(?=\s*\{)/,string:/("|')(\\(?:\r\n|[\w\W])|(?!\1)[^\\\r\n])*\1/,property:/(\b|\B)[\w-]+(?=\s*:)/i,important:/\B!important\b/i,"function":/[-a-z0-9]+(?=\()/i,punctuation:/[(){};:]/},Prism.languages.css.atrule.inside.rest=Prism.util.clone(Prism.languages.css),Prism.languages.markup&&(Prism.languages.insertBefore("markup","tag",{style:{pattern:/(<style[\w\W]*?>)[\w\W]*?(?=<\/style>)/i,lookbehind:!0,inside:Prism.languages.css,alias:"language-css"}}),Prism.languages.insertBefore("inside","attr-value",{"style-attr":{pattern:/\s*style=("|').*?\1/i,inside:{"attr-name":{pattern:/^\s*style/i,inside:Prism.languages.markup.tag.inside},punctuation:/^\s*=\s*['"]|['"]\s*$/,"attr-value":{pattern:/.+/i,inside:Prism.languages.css}},alias:"language-css"}},Prism.languages.markup.tag));
Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\w\W]*?\*\//,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0}],string:/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/i,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,"boolean":/\b(true|false)\b/,"function":/[a-z0-9_]+(?=\()/i,number:/\b-?(?:0x[\da-f]+|\d*\.?\d+(?:e[+-]?\d+)?)\b/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/};
Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/,number:/\b-?(0x[\dA-Fa-f]+|0b[01]+|0o[0-7]+|\d*\.?\d+([Ee][+-]?\d+)?|NaN|Infinity)\b/,"function":/[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*(?=\()/i}),Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/,lookbehind:!0}}),Prism.languages.insertBefore("javascript","class-name",{"template-string":{pattern:/`(?:\\`|\\?[^`])*`/,inside:{interpolation:{pattern:/\$\{[^}]+\}/,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}}}),Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(<script[\w\W]*?>)[\w\W]*?(?=<\/script>)/i,lookbehind:!0,inside:Prism.languages.javascript,alias:"language-javascript"}}),Prism.languages.js=Prism.languages.javascript;
Prism.languages.aspnet=Prism.languages.extend("markup",{"page-directive tag":{pattern:/<%\s*@.*%>/i,inside:{"page-directive tag":/<%\s*@\s*(?:Assembly|Control|Implements|Import|Master(?:Type)?|OutputCache|Page|PreviousPageType|Reference|Register)?|%>/i,rest:Prism.languages.markup.tag.inside}},"directive tag":{pattern:/<%.*%>/i,inside:{"directive tag":/<%\s*?[$=%#:]{0,2}|%>/i,rest:Prism.languages.csharp}}}),Prism.languages.aspnet.tag.pattern=/<(?!%)\/?[^\s>\/]+(?:\s+[^\s>\/=]+(?:=(?:("|')(?:\\\1|\\?(?!\1)[\w\W])*\1|[^\s'">=]+))?)*\s*\/?>/i,Prism.languages.insertBefore("inside","punctuation",{"directive tag":Prism.languages.aspnet["directive tag"]},Prism.languages.aspnet.tag.inside["attr-value"]),Prism.languages.insertBefore("aspnet","comment",{"asp comment":/<%--[\w\W]*?--%>/}),Prism.languages.insertBefore("aspnet",Prism.languages.javascript?"script":"tag",{"asp script":{pattern:/(<script(?=.*runat=['"]?server['"]?)[\w\W]*?>)[\w\W]*?(?=<\/script>)/i,lookbehind:!0,inside:Prism.languages.csharp||{}}});
Prism.languages.csharp=Prism.languages.extend("clike",{keyword:/\b(abstract|as|async|await|base|bool|break|byte|case|catch|char|checked|class|const|continue|decimal|default|delegate|do|double|else|enum|event|explicit|extern|false|finally|fixed|float|for|foreach|goto|if|implicit|in|int|interface|internal|is|lock|long|namespace|new|null|object|operator|out|override|params|private|protected|public|readonly|ref|return|sbyte|sealed|short|sizeof|stackalloc|static|string|struct|switch|this|throw|true|try|typeof|uint|ulong|unchecked|unsafe|ushort|using|virtual|void|volatile|while|add|alias|ascending|async|await|descending|dynamic|from|get|global|group|into|join|let|orderby|partial|remove|select|set|value|var|where|yield)\b/,string:[/@("|')(\1\1|\\\1|\\?(?!\1)[\s\S])*\1/,/("|')(\\?.)*?\1/],number:/\b-?(0x[\da-f]+|\d*\.?\d+f?)\b/i}),Prism.languages.insertBefore("csharp","keyword",{preprocessor:{pattern:/(^\s*)#.*/m,lookbehind:!0,alias:"property",inside:{directive:{pattern:/(\s*#)\b(define|elif|else|endif|endregion|error|if|line|pragma|region|undef|warning)\b/,lookbehind:!0,alias:"keyword"}}}});
Prism.languages.fsharp=Prism.languages.extend("clike",{comment:[{pattern:/(^|[^\\])\(\*[\w\W]*?\*\)/,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0}],keyword:/\b(?:let|return|use|yield)(?:!\B|\b)|\b(abstract|and|as|assert|base|begin|class|default|delegate|do|done|downcast|downto|elif|else|end|exception|extern|false|finally|for|fun|function|global|if|in|inherit|inline|interface|internal|lazy|match|member|module|mutable|namespace|new|not|null|of|open|or|override|private|public|rec|select|static|struct|then|to|true|try|type|upcast|val|void|when|while|with|asr|land|lor|lsl|lsr|lxor|mod|sig|atomic|break|checked|component|const|constraint|constructor|continue|eager|event|external|fixed|functor|include|method|mixin|object|parallel|process|protected|pure|sealed|tailcall|trait|virtual|volatile)\b/,string:/(?:"""[\s\S]*?"""|@"(?:""|[^"])*"|("|')(?:\\\1|\\?(?!\1)[\s\S])*\1)B?/,number:[/\b-?0x[\da-fA-F]+(un|lf|LF)?\b/,/\b-?0b[01]+(y|uy)?\b/,/\b-?(\d*\.?\d+|\d+\.)([fFmM]|[eE][+-]?\d+)?\b/,/\b-?\d+(y|uy|s|us|l|u|ul|L|UL|I)?\b/]}),Prism.languages.insertBefore("fsharp","keyword",{preprocessor:{pattern:/^[^\r\n\S]*#.*/m,alias:"property",inside:{directive:{pattern:/(\s*#)\b(else|endif|if|light|line|nowarn)\b/,lookbehind:!0,alias:"keyword"}}}});
Prism.languages.go=Prism.languages.extend("clike",{keyword:/\b(break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,builtin:/\b(bool|byte|complex(64|128)|error|float(32|64)|rune|string|u?int(8|16|32|64|)|uintptr|append|cap|close|complex|copy|delete|imag|len|make|new|panic|print(ln)?|real|recover)\b/,"boolean":/\b(_|iota|nil|true|false)\b/,operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,number:/\b(-?(0x[a-f\d]+|(\d+\.?\d*|\.\d+)(e[-+]?\d+)?)i?)\b/i,string:/("|'|`)(\\?.|\r|\n)*?\1/}),delete Prism.languages.go["class-name"];
Prism.languages.python={"triple-quoted-string":{pattern:/"""[\s\S]+?"""|'''[\s\S]+?'''/,alias:"string"},comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0},string:/("|')(?:\\?.)*?\1/,"function":{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_][a-zA-Z0-9_]*(?=\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)[a-z0-9_]+/i,lookbehind:!0},keyword:/\b(?:as|assert|async|await|break|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|pass|print|raise|return|try|while|with|yield)\b/,"boolean":/\b(?:True|False)\b/,number:/\b-?(?:0[bo])?(?:(?:\d|0x[\da-f])[\da-f]*\.?\d*|\.\d+)(?:e[+-]?\d+)?j?\b/i,operator:/[-+%=]=?|!=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]|\b(?:or|and|not)\b/,punctuation:/[{}[\];(),.:]/};
Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\w\W]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},string:{pattern:/(^|[^@\\])("|')(?:\\?[\s\S])*?\2/,lookbehind:!0},variable:/@[\w.$]+|@("|'|`)(?:\\?[\s\S])+?\1/,"function":/\b(?:COUNT|SUM|AVG|MIN|MAX|FIRST|LAST|UCASE|LCASE|MID|LEN|ROUND|NOW|FORMAT)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR VARYING|CHARACTER (?:SET|VARYING)|CHARSET|CHECK|CHECKPOINT|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMN|COLUMNS|COMMENT|COMMIT|COMMITTED|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS|CONTAINSTABLE|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|DATA(?:BASES?)?|DATETIME|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE(?: PRECISION)?|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE KEY|ELSE|ENABLE|ENCLOSED BY|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPE(?:D BY)?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|IDENTITY(?:_INSERT|COL)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTO|INVOKER|ISOLATION LEVEL|JOIN|KEYS?|KILL|LANGUAGE SQL|LAST|LEFT|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MODIFIES SQL DATA|MODIFY|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL(?: CHAR VARYING| CHARACTER(?: VARYING)?| VARCHAR)?|NATURAL|NCHAR(?: VARCHAR)?|NEXT|NO(?: SQL|CHECK|CYCLE)?|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READ(?:S SQL DATA|TEXT)?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEATABLE|REPLICATION|REQUIRE|RESTORE|RESTRICT|RETURNS?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE MODE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|START(?:ING BY)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED BY|TEXT(?:SIZE)?|THEN|TIMESTAMP|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNPIVOT|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?)\b/i,"boolean":/\b(?:TRUE|FALSE|NULL)\b/i,number:/\b-?(?:0x)?\d*\.?[\da-f]+\b/,operator:/[-+*\/=%^~]|&&?|\|?\||!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|IN|LIKE|NOT|OR|IS|DIV|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};
</script><script>Static.COOKIE_BANNER_CAPABLE = true;</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=$GA_TRACKING_ID$"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('set', 'developer_id.dZjQwMz', true);gtag('config', 'UA-125724044-1');</script><!-- End of Squarespace Headers -->
    <script>/* Must be below squarespace-headers */(function(){var e='ontouchstart'in window||navigator.msMaxTouchPoints;var t=document.documentElement;if(!e&&t){t.className=t.className.replace(/touch-styles/,'')}})()
    </script>
  </head>
  <body id="item-5a271bad41920214cc8a1ea5" class="transparent-header enable-nav-button nav-button-style-outline nav-button-corner-style-pill banner-button-style-solid banner-button-corner-style-pill banner-slideshow-controls-arrows meta-priority-date  hide-entry-author hide-list-entry-footer     center-navigation--info    event-show-past-events event-thumbnails event-thumbnail-size-32-standard event-date-label  event-list-show-cats event-list-date event-list-time event-list-address   event-icalgcal-links  event-excerpts      gallery-design-grid aspect-ratio-auto lightbox-style-light gallery-navigation-bullets gallery-info-overlay-show-on-hover gallery-aspect-ratio-32-standard gallery-arrow-style-no-background gallery-transitions-fade gallery-show-arrows gallery-auto-crop   product-list-titles-under product-list-alignment-center product-item-size-11-square product-image-auto-crop product-gallery-size-11-square  show-product-price show-product-item-nav product-social-sharing tweak-v1-related-products-image-aspect-ratio-11-square tweak-v1-related-products-details-alignment-center newsletter-style-light hide-opentable-icons opentable-style-dark small-button-style-solid small-button-shape-square medium-button-style-solid medium-button-shape-square large-button-style-solid large-button-shape-square image-block-poster-text-alignment-center image-block-card-dynamic-font-sizing image-block-card-content-position-center image-block-card-text-alignment-left image-block-overlap-dynamic-font-sizing image-block-overlap-content-position-center image-block-overlap-text-alignment-left image-block-collage-dynamic-font-sizing image-block-collage-content-position-top image-block-collage-text-alignment-left image-block-stack-dynamic-font-sizing image-block-stack-text-alignment-left button-style-solid button-corner-style-square tweak-product-quick-view-button-style-floating tweak-product-quick-view-button-position-bottom tweak-product-quick-view-lightbox-excerpt-display-truncate tweak-product-quick-view-lightbox-show-arrows tweak-product-quick-view-lightbox-show-close-button tweak-product-quick-view-lightbox-controls-weight-light native-currency-code-usd view-item collection-type-blog collection-layout-default collection-56894f3ea12f44306f8afde0 mobile-style-available">
    <a href="#" class="body-overlay"></a>
    <div class="sqs-announcement-bar-dropzone"></div>
    <div id="sidecarNav">
      

  <div id="mobileNavWrapper" class="nav-wrapper" data-content-field="navigation-mobileNav">
    <nav id="mobileNavigation">
      

      
        
          

          

            
            <div class="collection active homepage">
              <a href="/">
                Blog
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/blog-archive">
                Blog Archive
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/reading">
                Reading
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/sketches">
                Sketches
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/home">
                About Me
              </a>
            </div>
            

          
        
        

      
    </nav>
  </div>



    </div>
    <div id="siteWrapper" class="clearfix">

      <div class="sqs-cart-dropzone"></div>

      <header id="header" class="show-on-scroll" data-offset-el=".index-section" data-offset-behavior="bottom" role="banner">
        <div class="header-inner">
          <div id="siteTitleWrapper" class="wrapper" data-content-field="site-title">
            
              <h1 id="siteTitle" class="site-title"><a href="/">Jack Vanlightly</a></h1>
            
          </div><!--
          --><div class="mobile-nav-toggle"><div class="top-bar"></div><div class="middle-bar"></div><div class="bottom-bar"></div></div><div class="mobile-nav-toggle fixed-nav-toggle"><div class="top-bar"></div><div class="middle-bar"></div><div class="bottom-bar"></div></div><!--
          --><div id="headerNav">

  <div id="mainNavWrapper" class="nav-wrapper" data-content-field="navigation-mainNav">
    <nav id="mainNavigation" data-content-field="navigation-mainNav">
      

      
        
          

          

            
            <div class="collection active homepage">
              <a href="/">
                Blog
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/blog-archive">
                Blog Archive
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/reading">
                Reading
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/sketches">
                Sketches
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/home">
                About Me
              </a>
            </div>
            

          
        
        

      
    </nav>
  </div>
  <!-- style below blocks out the mobile nav toggle only when nav is loaded -->
  <style>.mobile-nav-toggle-label { display: inline-block !important; }</style>


</div>
        </div>
      </header>

      
        
          
            
              
            
          
        
      


      
      
      

      <main id="page" role="main">
        
        <!--
        --><!--
        --><div id="content" class="main-content" data-content-field="main-content" data-collection-id="56894f3ea12f44306f8afde0" data-edit-main-image="">
         <div class="blog-item">

  
  <article class="entry h-entry hentry category-messaging-systems tag-kafka tag-messaging tag-rabbitmq author-jack-vanlightly post-type-text clear" id="article-5a271bad41920214cc8a1ea5" data-item-id="5a271bad41920214cc8a1ea5">

    <header class="entry-header">
      <div class="meta-above-title">
        
        <div class="entry-byline">
          <span class="entry-author"><a href="/?author=56894e5669a91ac1e4c9ec1b" class="p-author author entry-byline-link" rel="author">Jack Vanlightly</a></span>
        </div>
        
        <div class="entry-dateline">
          <time class="dt-published published entry-date" datetime="2017-12-10" pubdate><a href="/blog/2017/12/5/rabbitmq-vs-kafka-part-2-rabbitmq-messaging-patterns-and-topologies" class="entry-dateline-link">December 10, 2017</a></time>
          <time class="dt-updated updated" datetime="2019-11-28"></time>
        </div>
        
        <div class="entry-morefrom">
          <span class="entry-category"><a href="/blog/category/Messaging+Systems" class="entry-morefrom-link" rel="tag">Messaging Systems</a></span>
        </div>
        
      </div>
      <h1 data-content-field="title" class="entry-title p-name">
      
        <a href="/blog/2017/12/5/rabbitmq-vs-kafka-part-2-rabbitmq-messaging-patterns-and-topologies" class="u-url" rel="bookmark">RabbitMQ vs Kafka Part 2 - RabbitMQ Messaging Patterns</a>
      
      </h1>
      <div class="meta-below-title ">
        
        <div class="entry-byline">
          <span class="entry-author"><a href="/?author=56894e5669a91ac1e4c9ec1b" class="p-author author entry-byline-link" rel="author">Jack Vanlightly</a></span>
        </div>
        
        <div class="entry-dateline">
          <time class="dt-published published entry-date" datetime="2017-12-10" pubdate><a href="/blog/2017/12/5/rabbitmq-vs-kafka-part-2-rabbitmq-messaging-patterns-and-topologies" class="entry-dateline-link">December 10, 2017</a></time>
          <time class="dt-updated updated" datetime="2019-11-28"></time>
        </div>
        
        <div class="entry-morefrom">
          <span class="entry-category"><a href="/blog/category/Messaging+Systems" class="entry-morefrom-link" rel="tag">Messaging Systems</a></span>
        </div>
        
      </div>
    </header>

    <div class="entry-content e-content">
      
        <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Post Body" data-type="item" data-updated-on="1512512452398" id="item-5a271bad41920214cc8a1ea5"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-7fdd866c5990bbfbda23"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">In this part we're going to forget about the low level details in the protocols and concentrate on the higher level patterns and message topologies that can be achieved in RabbitMQ. In <a href="https://jack-vanlightly.com/blog/2017/12/8/rabbitmq-vs-kafka-part-3-kafka-messaging-patterns" target="_blank">Part 3</a> of the series we'll do the same for Apache Kafka.</p><p class="" style="white-space:pre-wrap;">First we'll cover the building blocks, or routing primitives, of RabbitMQ:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">Exchange types and bindings</p></li><li><p class="" style="white-space:pre-wrap;">Queues</p></li><li><p class="" style="white-space:pre-wrap;">Dead letter exchanges</p></li><li><p class="" style="white-space:pre-wrap;">Ephemeral exchanges and queues</p></li><li><p class="" style="white-space:pre-wrap;">Alternate Exchanges</p></li><li><p class="" style="white-space:pre-wrap;">Priortity Queues</p></li></ul><p class="" style="white-space:pre-wrap;">Then we'll combine them all into a set of example patterns.</p><h1 style="white-space:pre-wrap;">RabbitMQ Routing Primitives</h1><h2 style="white-space:pre-wrap;">Exchanges Types</h2><h3 style="white-space:pre-wrap;">Fanout Exchanges</h3><p class="" style="white-space:pre-wrap;">These exchanges provide the typical publish subscribe topology. A message sent to a Fanout exchange will be broadcast to all queues and exchanges that have a binding to the exchange.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_2_1512575976473_6839"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:682px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig1. Fanout exchange broadcasts to three queues (independent consumers)&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:34.01759719848633%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512577450141-P0ASIRW196KG5VWLLF7F/RabbitMQRoutingFanout.png" alt="Fig1. Fanout exchange broadcasts to three queues (independent consumers)" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512577450141-P0ASIRW196KG5VWLLF7F/RabbitMQRoutingFanout.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512577450141-P0ASIRW196KG5VWLLF7F/RabbitMQRoutingFanout.png" data-image-dimensions="682x232" data-image-focal-point="0.5,0.5" alt="Fig1. Fanout exchange broadcasts to three queues (independent consumers)" data-load="false" data-image-id="5a2819a9f9619a2b693b34fe" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig1. Fanout exchange broadcasts to three queues (independent consumers)</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_2_1512575976473_7118"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">In the above diagram each consumer is independent of the others and receives its own copies of all the messages. To scale out the Consumer App 1, more instances of that application would need to be deployed, consuming from the same Queue 1.</p><p class="" style="white-space:pre-wrap;">Fanout exchanges are one of the fastest exchanges as they do not need to inspect any routing key or message header. Although an exchange may send a single message to multiple queues, in reality it doesn't necessarily duplicate the bits. It can persist the message to the message store and simply register a pointer to the message in each queue.</p><h3 style="white-space:pre-wrap;">Direct Exchanges and the Default Exchange</h3><p class="" style="white-space:pre-wrap;">Direct exchanges route messages using the Routing Key of the message. Routing keys are set by the publisher of the message. They are multi-word strings separated by dots. Some examples might be "booking.new", "booking.modified" and "booking.cancelled".</p><p class="" style="white-space:pre-wrap;">A binding between a queue or exchange and a Direct exchange contains a Binding Key. This is an exact match value.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_2_1512575976473_17437"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:802px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 2. Direct exchanges routes by exact match Routing Key to Binding Key&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:28.92768096923828%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512577465906-ZA2WBZYXHEO46PRLI57Z/RabbitMQRoutingDirect.png" alt="Fig 2. Direct exchanges routes by exact match Routing Key to Binding Key" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512577465906-ZA2WBZYXHEO46PRLI57Z/RabbitMQRoutingDirect.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512577465906-ZA2WBZYXHEO46PRLI57Z/RabbitMQRoutingDirect.png" data-image-dimensions="802x232" data-image-focal-point="0.5,0.5" alt="Fig 2. Direct exchanges routes by exact match Routing Key to Binding Key" data-load="false" data-image-id="5a2819b9f9619a2b693b3897" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 2. Direct exchanges routes by exact match Routing Key to Binding Key</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_2_1512575976473_17715"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">Direct exchanges are the second fastest exchange as they only perform exact string match operations.</p><p class="" style="white-space:pre-wrap;">There is a special exchange called the Default exchange which is a Direct exchange and the default exchange is the fastest of all exchanges. The Default exchange has an implicit binding to all queues in its virtual host. This implicit binding to each queue has as its binding key the name of the queue. This means that you can send a message directly to a specific queue by its name.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_2_1512575976473_21597"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:839px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 3. Default exchange has an implicit binding to each queue&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:33.492252349853516%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512578069749-2BMGO8WZA8CDI759CYP1/RabbitMQRoutingDefault.png" alt="Fig 3. Default exchange has an implicit binding to each queue" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512578069749-2BMGO8WZA8CDI759CYP1/RabbitMQRoutingDefault.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512578069749-2BMGO8WZA8CDI759CYP1/RabbitMQRoutingDefault.png" data-image-dimensions="839x281" data-image-focal-point="0.5,0.5" alt="Fig 3. Default exchange has an implicit binding to each queue" data-load="false" data-image-id="5a281c1541920205108264e9" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 3. Default exchange has an implicit binding to each queue</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_2_1512575976473_21875"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">This can be useful if the publisher wants to choose exactly which consumer it wants to process its message, rather than relying on bindings configured by consumers. Normally we want complete decoupling between the publisher and subscriber, and that is what the other exchanges provide. But in the case when you want point-to-point messaging, the Default exchange provides that capability.</p><h3 style="white-space:pre-wrap;">Topic Exchanges</h3><p class="" style="white-space:pre-wrap;">These exchanges also route using the Routing Key, but Topic exchanges offer the use of two types of wildcard in the Binding Key.</p><p class="" style="white-space:pre-wrap;">The * wildcard matches a single word in a routing key. For example the routing key "booking.new" has two words. The # wildcard matches any number of words.</p><p class="" style="white-space:pre-wrap;">For example, let's say we have the following routing keys:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">booking.new</p></li><li><p class="" style="white-space:pre-wrap;">booking.modified</p></li><li><p class="" style="white-space:pre-wrap;">booking.cancelled</p></li><li><p class="" style="white-space:pre-wrap;">extras.car.new</p></li><li><p class="" style="white-space:pre-wrap;">extras.car.modified</p></li><li><p class="" style="white-space:pre-wrap;">extras.car.removed</p></li><li><p class="" style="white-space:pre-wrap;">extras.hotel.new</p></li><li><p class="" style="white-space:pre-wrap;">extras.hotel.modified</p></li><li><p class="" style="white-space:pre-wrap;">extras.hotel.removed</p></li></ul><p class="" style="white-space:pre-wrap;">We can create bindings with the following binding keys:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;"><em>booking.new</em> - exact match</p></li><li><p class="" style="white-space:pre-wrap;"><em>extras.*.modified</em> - all modifications to extras on the booking (cars or hotels)</p></li><li><p class="" style="white-space:pre-wrap;"><em>extras.#</em> - all extras</p></li><li><p class="" style="white-space:pre-wrap;"><em>#.new</em> - all new bookings and extras</p></li></ul><p class="" style="white-space:pre-wrap;">With careful design of routing keys and binding keys, we can add new routing keys without needing to update the existing bindings, making the system robust in the face of change.</p><p class="" style="white-space:pre-wrap;">Topic exchanges allow you to configure a single exchange for an application to send its messages to, using the routing to ensure that the messages get to the right consumers. This simplifies the configuration and deployment of the publishing and consuming applications.</p><p class="" style="white-space:pre-wrap;">Note that topic exchanges slow down as the number of bindings increase.</p><h3 style="white-space:pre-wrap;">Header Exchanges</h3><p class="" style="white-space:pre-wrap;">These are the most powerful, but also the least used of the exchanges. I can use more CPU which needs to be taken into account as you may have scaling issues with this exchange type. Header exchanges ignore the routing key and instead parse the message headers. Each binding to a Header exchange can include multiple header matchings of which ANY or ALL must match.&nbsp;</p><p class="" style="white-space:pre-wrap;">Let's say your application publishes to a single exchange a set of different messages that form a real-time change log that allows for integration with other systems. Each message has the following message headers:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">entity.type (booking, passenger, baggage, pet)</p></li><li><p class="" style="white-space:pre-wrap;">change.type (new, modified, cancelled, removed, moved)</p></li><li><p class="" style="white-space:pre-wrap;">agent.id</p></li><li><p class="" style="white-space:pre-wrap;">client.id</p></li></ul><p class="" style="white-space:pre-wrap;">We could create the following bindings:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;"><em>entity.type=booking, change.type=cancelled, x-match=all.</em> I want all cancelled booking messages.</p></li><li><p class="" style="white-space:pre-wrap;"><em>entity.type=passenger, x-match=all.</em> I want all passenger messages.</p></li><li><p class="" style="white-space:pre-wrap;"><em>entity.type=pet, change.type=new,x-match=all. </em>I want all newly added pet messages.</p></li><li><p class="" style="white-space:pre-wrap;"><em>agent.id=2, client.id=1001, x-match=any. </em>I want all messages related the specific travel agent or end client.</p></li></ul><p class="" style="white-space:pre-wrap;">As you can see, Header exchanges are quite powerful.</p><h3 style="white-space:pre-wrap;">Consistent Hash Exchanges</h3><p class="" style="white-space:pre-wrap;">A Consistent Hash exchange allows us to partition a single queue into multiple queues and distribute messages between them via a hashing of the routing key, message header or message property.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1513006343979_84078"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:721px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:32.03883361816406%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1513007854559-PW8CD408JIC9BM63O4QI/RabbitMQConsistentHashing.png" alt="Fig 4. Messages are distributed by partitioned hash space" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1513007854559-PW8CD408JIC9BM63O4QI/RabbitMQConsistentHashing.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1513007854559-PW8CD408JIC9BM63O4QI/RabbitMQConsistentHashing.png" data-image-dimensions="721x231" data-image-focal-point="0.5,0.5" alt="Fig 4. Messages are distributed by partitioned hash space" data-load="false" data-image-id="5a2eaaee652deadcd2b520fc" data-type="image" />
            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 4. Messages are distributed by partitioned hash space</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1513006343979_84358"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">This gives us patterns such as ordered processing guarantees and data locality, two patterns you will see below in the patterns section.</p><p class="" style="white-space:pre-wrap;">There are some issues with Consistent Hash exchanges though. Firstly that RabbitMQ doesn't help you to coordinate your consumers across the partitioned queues like Kafka does. Single Active Consumer (SAC) can help avoid multiple consumers consume at the time from a single queue, but does not solve the distribution problem.&nbsp;Kafka gives you this out of the box.</p><p class="" style="white-space:pre-wrap;">Other potential problems are:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">the thing you hash (routing key, message header or property) doesn't have enough variance to create an even distribution. If you only have four different values then you might get unlucky and all go to a single queue.</p></li><li><p class="" style="white-space:pre-wrap;">if you have relatively few queues then distribution may be uneven if you do not configure the queues to take that into account.</p></li></ul><h2 style="white-space:pre-wrap;">Dead Letter Exchanges</h2><p class="" style="white-space:pre-wrap;">We can configure a queue to eject a message and send it to a configured exchange upon one of three conditions:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">The queue has reached the message count limit. The message at the head of the queue (oldest message) is ejected and sent to the configured dead letter exchange (DLX). So when a new message arrives to a full queue it basically kicks out the oldest message and is safely added to the queue.</p></li><li><p class="" style="white-space:pre-wrap;">The queue has reached its size (bytes) limit. Again, the oldest message is ejected.</p></li><li><p class="" style="white-space:pre-wrap;">The queue has been configured with a Message Time To Live (TTL) limit and a message has reached that limit.</p></li><li><p class="" style="white-space:pre-wrap;">A message has been configured with its own TTL, and it has reached that time period in the queue.</p></li></ul><p class="" style="white-space:pre-wrap;">Messages can be dead lettered from the head of the queue only (with <strong>drop-head</strong> overflow behaviour). Messages that have passed their TTL only get forwarded to the DLX when they reach the head of the queue. <em>This is very important to remember!</em></p><p class="" style="white-space:pre-wrap;">Dead letter exchanges are just regular exchanges, you can create one as any of the four types and bind any queues or other exchanges to it. I previously <a href="https://jack-vanlightly.com/blog/2017/6/11/improving-reliability-and-incident-response-via-a-message-lifecycle" target="_blank">documented </a>a topology that uses a centralised dead letter exchange.&nbsp;</p><p class="" style="white-space:pre-wrap;">RabbitMQ's dead letter functionality provides for more than just an escape route for messages in peril of being lost. It can be used for retry and delay queues as we'll see in the patterns section.</p><p class="" style="white-space:pre-wrap;">With the <strong>reject-publish</strong> overflow behaviour, the message will be discarded and the publisher notified (if using publisher confirms) and the message will not be routed to any configured deadletter exchange.</p><h2 style="white-space:pre-wrap;">Ephemeral Exchanges and Queues</h2><p class="" style="white-space:pre-wrap;">Exchanges can be configured to <strong>auto-delete</strong> themselves onces all queue bindings have been removed. Queue bindings can be removed by either just removing the binding itself or removing the queue.</p><p class="" style="white-space:pre-wrap;">Queues can be configured to <strong>auto-delete</strong> once all consumers have stopped using the queue. This can be because a consumer cancelled its subscription or that the channel closed.</p><p class="" style="white-space:pre-wrap;">Queues can be configured to be <strong>Exclusive Queues</strong>. This means that only the consumer that declared the queue is able to consume it and once the consumer cancels or closes the channel the queue auto-deletes. Since version 3.8, Single Active Consumer is a better option if you want this behaviour.</p><p class="" style="white-space:pre-wrap;">Queues can be configured with a <strong>Queue TTL.</strong>&nbsp;Once the queue has been unused for the TTL period, it will be deleted. Unused means no active consumers subscribed.</p><p class="" style="white-space:pre-wrap;">Ephemeral exchanges and queues can be used for patterns such as delay queues, retry queues and reply-to queues, as we'll see in the patterns section.</p><h2 style="white-space:pre-wrap;">Alternate Exchanges</h2><p class="" style="white-space:pre-wrap;">Each exchange can be configured with an alternate exchange. When the exchange cannot route a message because either there are no bindings or no bindings match the message, then the exchange will route the message to its alternate exchange.</p><p class="" style="white-space:pre-wrap;">This gives us a way of not losing messages that might be lost because of a bad routing key or bad routing topology. But it also enables new routing patterns that the four exchange types do not provide for. We'll see in the patterns section how Alternate Exchanges can be used for different routing scenarios.&nbsp;</p><h2 style="white-space:pre-wrap;">Priority Queues</h2><p class="" style="white-space:pre-wrap;">Messages can be configured with different priority levels, up to 10 levels is recommended. When a queue is declared, it can be declared as a priority queue. If the publisher sets a priority on a message then its position in a priority queue will be determined by that priority. Higher priority messages get shunted further forward than lower priority ones. So if a queue has 1000 low priority messages and a high priority message arrives it will be placed at the head of the queue immediately.</p><p class="" style="white-space:pre-wrap;">There are two important considerations to take into account with priority queues. If a priority queue becomes full and has a high priority message at the head of the queue, when a low priority message arrives it will kick out the high priority message. The low priority message will be safely persisted to the queue and the high priority message will be sent to the DLX.</p><p class="" style="white-space:pre-wrap;">Likewise, lower priority messages can get stuck because they may be perpetually behind higher priority messages. Even setting a message TTL would not help in this case as dead lettering always occurs at the head of the queue.</p><p class="" style="white-space:pre-wrap;">So use priority queues with care.</p><h2 style="white-space:pre-wrap;">CC and BCC</h2><p class="" style="white-space:pre-wrap;">Publishers of messages can add additional routing keys in two string array message headers (CC and BCC). They behave just like email. Routing keys in the CC and BCC headers route the message just like the standard message routing key. The BCC header will be stripped out of the message before delivery.</p><h2 style="white-space:pre-wrap;">Poison Message Handling</h2><p class="" style="white-space:pre-wrap;">Quorum queues, the replicated queue type released in 3.8, have a poison message handling functionality. You can specify the<em> x-delivery-limit</em> argument when declaring the queue and once a message has been delivered that number of times, it is dropped. This prevents a message that crashes your consumers from causing too much damage.</p><h2 style="white-space:pre-wrap;">Declaring Exchanges, Queues and Bindings</h2><p class="" style="white-space:pre-wrap;">Applications themselves can declare the exchanges, queues and bindings they want. Kafka requires some centralised management due to decisions about partitions that affect all consumers. RabbitMQ is more flexible in this regard and applications can manage their own RabbitMQ artefacts without worrying about affecting other applications. Convention based topolgies are great as we can use simple conventions within applications and build sophisticated routing topologies that self-manage themselves. However, if scaling and performance become a concern you may need to carefully architect your routing topology into a more specialised snowflake.&nbsp;</p><h2 style="white-space:pre-wrap;">Virtual Hosts</h2><p class="" style="white-space:pre-wrap;">A virtual host is a logical container of exchanges and queues. They can be used to control access to exchanges and queues. Cross virtual host routing is not possible so all examples in this section assume an encompassing virtual host.</p><h1 style="white-space:pre-wrap;">Example RabbitMQ Patterns</h1><h2 style="white-space:pre-wrap;">#1 - Simple Broadcast with Fanout Exchange</h2><p class="" style="white-space:pre-wrap;">Use a Fanout exchange to broadcast all messages to all consumers.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1512586509072_24028"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:652px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 5 - Simple pub sub pattern with Fanout exchange&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:61.65644073486328%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512591297076-5W6LPCLZ6DK7AE04ENH7/RabbitMQMultiplePubAndMultipleSetsOfSubs.png" alt="Fig 5 - Simple pub sub pattern with Fanout exchange" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512591297076-5W6LPCLZ6DK7AE04ENH7/RabbitMQMultiplePubAndMultipleSetsOfSubs.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512591297076-5W6LPCLZ6DK7AE04ENH7/RabbitMQMultiplePubAndMultipleSetsOfSubs.png" data-image-dimensions="652x402" data-image-focal-point="0.5,0.5" alt="Fig 5 - Simple pub sub pattern with Fanout exchange" data-load="false" data-image-id="5a284fc0ec212dca4e8565ff" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 5 - Simple pub sub pattern with Fanout exchange</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1512586509072_24308"><div class="sqs-block-content"><h2 style="white-space:pre-wrap;"># 2 - Multi Layered Exchanges</h2><p class="" style="white-space:pre-wrap;">In order to reduce the cost of routing, a layered approach can be applied. In the example below we initially route based on a small finite number of routing keys to other exchanges. Each binding to a topic increases the overhead of that exchange. In this case we can route all the booking messages to a fanout exchange where it can be efficiently broadcast to all interested consumers.</p><p class="" style="white-space:pre-wrap;">Likewise, those consumers that want to filter based on message headers of a given type of message can route messages efficiently to the more costly Header exchange where message header based routing is performed over a subset of the messages that come in through the entry point Topic exchange.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1512586509072_52645"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:931px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 6. Optimise routing overhead through layered exchanges&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:67.23953247070312%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512593788755-1UM0FS99FDKNROMC239I/RabbitMQRoutingLayeredTopic.png" alt="Fig 6. Optimise routing overhead through layered exchanges" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512593788755-1UM0FS99FDKNROMC239I/RabbitMQRoutingLayeredTopic.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512593788755-1UM0FS99FDKNROMC239I/RabbitMQRoutingLayeredTopic.png" data-image-dimensions="931x626" data-image-focal-point="0.5,0.5" alt="Fig 6. Optimise routing overhead through layered exchanges" data-load="false" data-image-id="5a28597c24a694e63ae59445" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 6. Optimise routing overhead through layered exchanges</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1512586509072_52924"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">If all downstream exchanges want to be able to route all messages the entry point can be a Fanout instead.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1512586509072_61799"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:891px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 7. Fanout broadcasts to more specialised exchanges&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:51.17844772338867%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512594335385-WP1D0K7HJJJYM9FIS875/RabbitMQRoutingLayeredFanout.png" alt="Fig 7. Fanout broadcasts to more specialised exchanges" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512594335385-WP1D0K7HJJJYM9FIS875/RabbitMQRoutingLayeredFanout.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512594335385-WP1D0K7HJJJYM9FIS875/RabbitMQRoutingLayeredFanout.png" data-image-dimensions="891x456" data-image-focal-point="0.5,0.5" alt="Fig 7. Fanout broadcasts to more specialised exchanges" data-load="false" data-image-id="5a285b9f53450aeceb536e9f" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 7. Fanout broadcasts to more specialised exchanges</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1512586509072_62078"><div class="sqs-block-content"><h2 style="white-space:pre-wrap;">#3 - Email Routing System with Header Exchanges</h2><p class="" style="white-space:pre-wrap;">Emailing routing is not a general pattern but it does demonstrate the power of Header exchanges. This example also demonstrates how you can reduce your dependency on schedulers.</p><p class="" style="white-space:pre-wrap;">Let's say we are an airline and we work with a partner called ABC that performs aircraft maintenance on our aircraft. Every day their systems send us emails which contain information inside the email or within attachments. Yes welcome to the world of integration via SMTP, it's real.</p><p class="" style="white-space:pre-wrap;">You have five applications that all need to update internal systems with the various data files that ABC sends us daily. For example the finance department needs to know aircraft component status in order to create predictive models on future costs so the required budget is provisioned and accounted for.</p><p class="" style="white-space:pre-wrap;">When all five applications read from the mailbox directly, we can no longer rely on read status. Each application needs to track what they have read before, skip the emails they are not interested in and be scheduled to run every X minutes or hours. We have to implement mailbox read logic over and over.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_3_1512638534564_17349"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:452px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 8. Applications reading directly from a mailbox&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:74.55752563476562%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512638978653-ZIY87O38TXYWC7A9RMJB/ReadFromMailbox.png" alt="Fig 8. Applications reading directly from a mailbox" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512638978653-ZIY87O38TXYWC7A9RMJB/ReadFromMailbox.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512638978653-ZIY87O38TXYWC7A9RMJB/ReadFromMailbox.png" data-image-dimensions="452x337" data-image-focal-point="0.5,0.5" alt="Fig 8. Applications reading directly from a mailbox" data-load="false" data-image-id="5a290a02e2c483218c806612" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 8. Applications reading directly from a mailbox</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_3_1512638534564_17628"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">&nbsp;</p><p class="" style="white-space:pre-wrap;">Instead we could have a single application be responsible for reading the mailbox that writes all emails and their attachments to a database. Then each application needs to read from that database. Again each application must keep track of what emails it has read, which is repetitive code (see my <a href="https://github.com/Vanlightly/Taskling.NET" target="_blank">Taskling </a>project on Github for a way of tracking data processed by batch jobs). These applications also need to be scheduled by a scheduler.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_3_1512638534564_20536"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:734px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 9. Applications reading from a database&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:46.457763671875%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512639085260-32VDBF7F4GDYLWBJG9QN/FromMailBoxToDb.png" alt="Fig 9. Applications reading from a database" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512639085260-32VDBF7F4GDYLWBJG9QN/FromMailBoxToDb.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512639085260-32VDBF7F4GDYLWBJG9QN/FromMailBoxToDb.png" data-image-dimensions="734x341" data-image-focal-point="0.5,0.5" alt="Fig 9. Applications reading from a database" data-load="false" data-image-id="5a290a6c085229b3c975a6a6" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 9. Applications reading from a database</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_3_1512638534564_20814"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">A better option is to have a single scheduled application that reads from the mailbox and sends the emails as messages on RabbitMQ, to a Header exchange. Attachments can be persisted to a database or a cloud service like S3, with just the attachment key in the message. The email properties such as sender address, recipient address, cc, subject are all added as message headers.&nbsp;Then each application need only create bindings which match the emails they want to consume. The applications need no scheduler as they get pushed the email messages from RabbitMQ.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_3_1512638534564_24959"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1121px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 10. Applications receive emails they want over RabbitMQ&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:40.67796325683594%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512639305342-9CSI91Y3J68QG2KOAPX5/MailBoxToRabbitMQ.png" alt="Fig 10. Applications receive emails they want over RabbitMQ" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512639305342-9CSI91Y3J68QG2KOAPX5/MailBoxToRabbitMQ.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512639305342-9CSI91Y3J68QG2KOAPX5/MailBoxToRabbitMQ.png" data-image-dimensions="1121x456" data-image-focal-point="0.5,0.5" alt="Fig 10. Applications receive emails they want over RabbitMQ" data-load="false" data-image-id="5a290b489140b775cde1f927" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 10. Applications receive emails they want over RabbitMQ</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_7_1512933670188_34682"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">The limitation of Header exchanges is that you can only do exact matches. This does rule out Header exchanges quite often unfortunately. I would love for Pivotal to invest more into Header exchanges but for now that is how it is.</p><h2 style="white-space:pre-wrap;">#4 - Public Message Exchange, Private Consumer Exchange</h2><p class="" style="white-space:pre-wrap;">This is a flexible, convention based routing pattern. Unique snow flake topologies can be difficult to manage as they grow larger. I tend to prefer convention based topologies as they tend to manage themselves. In this pattern, publishers of messages declare a Fanout exchange based on the message type name. Consumers on start-up declare their own queue and for each message they consume they declare their own private exchange and bind it to the message exchange they want to subscribe to. Using this simple logic, publishers and consumers create all the queuing infrastructure automatically without knowing about each other, or impacting each other in any way.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_3_1512638534564_50080"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1032px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 11. Public message exchanges, private consumer exchanges&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:18.50775146484375%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512670176041-NHYG36TEXCX518TS8QFP/MessageExchanges.png" alt="Fig 11. Public message exchanges, private consumer exchanges" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512670176041-NHYG36TEXCX518TS8QFP/MessageExchanges.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512670176041-NHYG36TEXCX518TS8QFP/MessageExchanges.png" data-image-dimensions="1032x191" data-image-focal-point="0.5,0.5" alt="Fig 11. Public message exchanges, private consumer exchanges" data-load="false" data-image-id="5a2983df085229971180436c" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 11. Public message exchanges, private consumer exchanges</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_3_1512638534564_50358"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">In the above diagram the publisher publishes two message types: new bookings and modified bookings. For flexible routing, it sets the sales channel as the Routing Key (the sales channel could be the main website, comparison sites, travel agencies etc) and adds some other interesting data in the message headers.</p><p class="" style="white-space:pre-wrap;">The publisher simply publishes each message to its corresponding message exchange. Each consumer has its own queue and private exchange. It binds its private exchange to the message exchange. In our example Consumer App 1 wants all new bookings. Consumer App 2 wants alll new bookings of a specific very important client. Consumer App 3 wants all new and modified bookings related to MyTravel.com which sells bookings as a 3rd party seller.</p><p class="" style="white-space:pre-wrap;">This pattern makes for a self-managing topology where the only clean-up required is when consumers are removed permanently from the system. Deployments and development is simplified as all applications create the necessary RabbitMQ exchanges, queues and bindings they need reducing the burden on the operations team and deployment pipelines.</p><p class="" style="white-space:pre-wrap;">Another benefit of giving each consumer its own private exchange is that support teams can put in "wire taps" to view all messages consumed by an app. You can create a queue and bind it to the private exchange of a consumer application and get copies of all the messages it receives. This can also be used for adding on-demand audit logging of messages of a given consumer.</p><h2 style="white-space:pre-wrap;">#5 - Point-to-Point Messaging</h2><p class="" style="white-space:pre-wrap;">We can bypass the various routing options and send messages directly to a queue by name. Send a message to the default exchange, with the name of the queue as the Routing Key and it will be directed straight to the queue.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_2_1512669990337_30709"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:776px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 12. Point-to-point message via the Default exchange&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:9.278349876403809%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512671313188-UVJRLHT3P1I3K96CMOFE/image-asset.png" alt="Fig 12. Point-to-point message via the Default exchange" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512671313188-UVJRLHT3P1I3K96CMOFE/image-asset.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512671313188-UVJRLHT3P1I3K96CMOFE/image-asset.png" data-image-dimensions="776x72" data-image-focal-point="0.5,0.5" alt="Fig 12. Point-to-point message via the Default exchange" data-load="false" data-image-id="5a29885153450a6ffb92ebca" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 12. Point-to-point message via the Default exchange</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_2_1512669990337_30986"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">This is useful when the publisher wants control over which consumer processes a message, rather than relying on routing where 0 to many queues might receive the message. NServiceBus uses the default exchange for the sending of commands. NServiceBus splits messages into two categories: events and commands. Events get published to exchanges where any consumer can subscribe to the event. Applications send commands directly to specific consumers by using their queue name.</p><h2 style="white-space:pre-wrap;">#6 - Processing Order Sensitive Applications</h2><p class="" style="white-space:pre-wrap;">Sometimes you need to be scale out your consumers and maintain ordered processing of messages. While RabbitMQ guarantees the FIFO ordering of a queue, if there are multiple competing consumers each consuming multiple messages in parallel, the processing order is lost.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1513006343979_99284"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:720px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 13. Multiple competing consumers consume a single queue and lose processing order guarantees&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:45.833335876464844%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1513009187941-14AGZ0T0C2R9B2KC5EWB/RabbitMQNoProcessingOrderGuarantee.png" alt="Fig 13. Multiple competing consumers consume a single queue and lose processing order guarantees" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1513009187941-14AGZ0T0C2R9B2KC5EWB/RabbitMQNoProcessingOrderGuarantee.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1513009187941-14AGZ0T0C2R9B2KC5EWB/RabbitMQNoProcessingOrderGuarantee.png" data-image-dimensions="720x330" data-image-focal-point="0.5,0.5" alt="Fig 13. Multiple competing consumers consume a single queue and lose processing order guarantees" data-load="false" data-image-id="5a2eb023e2c4837cac347606" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 13. Multiple competing consumers consume a single queue and lose processing order guarantees</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1513006343979_99563"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">One way of getting around this problem is to use a Consistent Hash exchange and partition the queue into multiple queues and route messages to these queues based on hashing the routing key or a message header. Normally the global order of all messages is not necessary, just the order of related messages. For example, all messages related to a given booking must be processed in the correct order. So if we set the booking id as the routing key or as a message header we can guarantee that all the messages of a given booking id always goes to the same queue. Then if we only have a single consumer consuming from that queue we get the processing order guarantees we need.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1513006343979_104039"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:832px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 14. Messages distributed by hashing function, each queue consumed by one consumer&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:46.99519348144531%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1513009249764-244052JH5QUVAXXFUCYU/RabbitMQWithProcessingOrder.png" alt="Fig 14. Messages distributed by hashing function, each queue consumed by one consumer" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1513009249764-244052JH5QUVAXXFUCYU/RabbitMQWithProcessingOrder.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1513009249764-244052JH5QUVAXXFUCYU/RabbitMQWithProcessingOrder.png" data-image-dimensions="832x391" data-image-focal-point="0.5,0.5" alt="Fig 14. Messages distributed by hashing function, each queue consumed by one consumer" data-load="false" data-image-id="5a2eb061e4966bb50134d182" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 14. Messages distributed by hashing function, each queue consumed by one consumer</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1513006343979_104318"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">But, RabbitMQ doesn't help you coordinate your consumers to match one consumer to one queue. That is down to you to do somehow.</p><h2 style="white-space:pre-wrap;">#7 - Data Locality</h2><p class="" style="white-space:pre-wrap;">By using the Consistent Hash exchange like in the previous pattern we also get data locality. For example all of user 1001's events always go to consumer 2 because we hash a message header that contains the user id.</p><p class="" style="white-space:pre-wrap;">This means that consumer 2 can do some operations that would not be feasible if network round-trips were needed. We can implement counters, real-time aggregations and the such in <strong>memory</strong>.&nbsp;</p><p class="" style="white-space:pre-wrap;">However, while this sounds great there are dangers involved. If you increase the number of queues then the distribution of messages changes. So now user 1001's messages go to consumer 4. But consumer 2 doesn't know that, it just stops seeing user 1001 messages. So now you have two consumers with in memory counters and aggregations. You can avoid this by hand-rolling some way of notifying consumers of a change in message distribution and get them to write out their in memory values to a data store and expect a new slice of user messages.</p><h2 style="white-space:pre-wrap;">#8 - Hierarchical Routing</h2><p class="" style="white-space:pre-wrap;">This is an extension of the Public Message Exchange, Private Consumer Exchange pattern and allows for Topic exchange like routing using Fanout exchanges.</p><p class="" style="white-space:pre-wrap;">Imagine we have split our business into domains, sub domains and actions. We could construct a message namespace in the format <em>domain.sub-domain.action</em>:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">finance.invoicing.invoice-requested</p></li><li><p class="" style="white-space:pre-wrap;">finance.invoicing.invoice-generated</p></li><li><p class="" style="white-space:pre-wrap;">finance.fraud.alert</p></li><li><p class="" style="white-space:pre-wrap;">finance.fraud.check</p></li></ul><p class="" style="white-space:pre-wrap;">We create three extra message exchanges:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">finance.invoicing</p></li><li><p class="" style="white-space:pre-wrap;">finance.fraud</p></li><li><p class="" style="white-space:pre-wrap;">finance</p></li></ul><p class="" style="white-space:pre-wrap;">We create bindings to these exchanges according to the namespace as below:</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_2_1512669990337_41463"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1155px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 15. Hierarchical routing&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:44.24242401123047%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512674526587-QJG1ZUTKMSLUZ1558JSD/RabbitMQHierarchical.png" alt="Fig 15. Hierarchical routing" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512674526587-QJG1ZUTKMSLUZ1558JSD/RabbitMQHierarchical.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512674526587-QJG1ZUTKMSLUZ1558JSD/RabbitMQHierarchical.png" data-image-dimensions="1155x511" data-image-focal-point="0.5,0.5" alt="Fig 15. Hierarchical routing" data-load="false" data-image-id="5a2994dd24a69496bb41a643" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 15. Hierarchical routing</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_2_1512669990337_41741"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">This pattern can be useful when you want to capture the messages of large groups of related exchanges without having to create large numbers of bindings. When publishers declare the message exchange of the message they publish, they also declare the exchanges in the hierarchy and the necessary bindings. This means that once you subscribe to the parent exchange, when new child exchanges are added their messages automatically get routed to you.</p><h2 style="white-space:pre-wrap;">#9 - Class of Service with Priority Queues</h2><p class="" style="white-space:pre-wrap;">Some instances of a given message type may carry greater priority than others. Perhaps some clients are more important than others, or messages can be flagged as higher priority. One way of processing higher priority messages before lower priority ones is to configure a queue as a priority queue, and send all messages with a priority level.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_2_1512669990337_77391"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:644px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 16. Priority Queue&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:11.180124282836914%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512676943953-ABTSPKQH8A2ID4USQ1P1/RabbitMQPriorityQueue.png" alt="Fig 16. Priority Queue" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512676943953-ABTSPKQH8A2ID4USQ1P1/RabbitMQPriorityQueue.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512676943953-ABTSPKQH8A2ID4USQ1P1/RabbitMQPriorityQueue.png" data-image-dimensions="644x72" data-image-focal-point="0.5,0.5" alt="Fig 16. Priority Queue" data-load="false" data-image-id="5a299e4f4192023e462ac9d2" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 16. Priority Queue</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_2_1512669990337_77669"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">In general though, priority queues are little too simple. Lower priority messages can get stuck behind higher priority messages and dead lettering can eject high priority messages in favour of low priority messages.</p><p class="" style="white-space:pre-wrap;">A better approach to class of service is using a topic exchange, see the next pattern.</p><h2 style="white-space:pre-wrap;">#10 - Class of Service with Topic Exchanges</h2><p class="" style="white-space:pre-wrap;">Using a Topic with the priority set in the Routing Key has neither of the gotchas of priority queues. Messages are routed to physcially different queues and processed by different application instances. The high priority queue may offer lower latency solely by the fact that messages don't have to wait behind lower priority messages, but also higher priority messages may be consumed by a more scaled out set of consumers on bigger VMs.&nbsp;</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_2_1512669990337_84369"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:717px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 17. Routing by priority&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:29.567644119262695%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512677126951-NEP2XI09KXQA0RTT24NK/RabbitMQPriorityViaTopic.png" alt="Fig 17. Routing by priority" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512677126951-NEP2XI09KXQA0RTT24NK/RabbitMQPriorityViaTopic.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512677126951-NEP2XI09KXQA0RTT24NK/RabbitMQPriorityViaTopic.png" data-image-dimensions="717x212" data-image-focal-point="0.5,0.5" alt="Fig 17. Routing by priority" data-load="false" data-image-id="5a299f060d9297a77d75d9ea" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 17. Routing by priority</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_2_1512669990337_84647"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">&nbsp;</p><h2 style="white-space:pre-wrap;">#11 - If/Else Routing with Alternate Exchanges</h2><p class="" style="white-space:pre-wrap;">Imagine we have a handful of super important clients that require custom behaviour for each message and each of these messages need go to a dedicated consumer for that client. Messages related to the hundreds of lesser important clients should get handled by a generic consumer.</p><p class="" style="white-space:pre-wrap;">We can achieve this by putting a client identifier as the routing key and sending the messages to a Direct exchange configured with an Alternate exchange.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1512720451987_45020"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:867px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 18. If/Else routing with alternate exchange&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:33.67935562133789%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512722000122-8ACVLZSDXXI93QKYFS4G/RabbitMQAlternate.png" alt="Fig 18. If/Else routing with alternate exchange" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512722000122-8ACVLZSDXXI93QKYFS4G/RabbitMQAlternate.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512722000122-8ACVLZSDXXI93QKYFS4G/RabbitMQAlternate.png" data-image-dimensions="867x292" data-image-focal-point="0.5,0.5" alt="Fig 18. If/Else routing with alternate exchange" data-load="false" data-image-id="5a2a4e4f71c10bf01dfddcff" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 18. If/Else routing with alternate exchange</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1512720451987_45300"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">The alternate exchange is just a regular exchange, of any of the four exchange types. You can even chain alternate exchanges together and make if, else if, else if, else logic structures.</p><p class="" style="white-space:pre-wrap;">A Topic exchange could not deliver this routing as it could not do OR, it can only do AND. If we used a Topic exchange and used the # wildcard to capture all messages, we would end up processing the very important client messages as well as the lesser important clients.</p><h2 style="white-space:pre-wrap;">#12 - NOT Routing with Alternate Exchanges</h2><p class="" style="white-space:pre-wrap;">Sometimes you want to consume all messages <strong>except </strong>one specific type. None of the four exchange types offer negative matching. Instead we can create a "waste bin" queue and binding for the message you do <strong>not </strong>want. This queue is set up with a very short queue based message TTL so the messages get discarded almost immediately upon arriving.</p><p class="" style="white-space:pre-wrap;">You configure the exchange with an alternate exchange and wire up your consumer with a queue bound to that alternate exchange. Now you consume all the messages except the one type you don't want.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1512720451987_59716"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1064px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 19. Consumer App 2 gets all booking messages except mytravel.com ones&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:20.300752639770508%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512723776930-7MUSWG9RZN7GZ67XGGXV/RabbitMQNotRouting.png" alt="Fig 19. Consumer App 2 gets all booking messages except mytravel.com ones" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512723776930-7MUSWG9RZN7GZ67XGGXV/RabbitMQNotRouting.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512723776930-7MUSWG9RZN7GZ67XGGXV/RabbitMQNotRouting.png" data-image-dimensions="1064x216" data-image-focal-point="0.5,0.5" alt="Fig 19. Consumer App 2 gets all booking messages except mytravel.com ones" data-load="false" data-image-id="5a2a5540f9619a97da91e2b0" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 19. Consumer App 2 gets all booking messages except mytravel.com ones</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1512720451987_59995"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">This topology is similar to the one in the Public Message Exchange, Private Consumer Exchange pattern. Consumer 2 sets up a private topic exchange and routes all bookings made from the mytravel.com sales channel to a waste bin queue and then consumes the rest.</p><p class="" style="white-space:pre-wrap;">Obviously you could just let your consumer consume every message and just discard the messages you don't want. It depends on your specific scenario.</p><h2 style="white-space:pre-wrap;">#13 - Delayed Retry with Cascading Exchanges and Queues</h2><p class="" style="white-space:pre-wrap;">There is a lot of bad advice out there regarding delayed retry routing in RabbitMQ. All delayed retry methods rely on message TTL expiry and dead letter exchanges. Many people do not take into account that only messages at the <strong>head </strong>of the queue get dead lettered. This means you cannot mix delay times in one queue as shorter delayed messages get stuck behind longer delayed messages. Now that warning is said, let's look at this very inventive pattern.</p><p class="" style="white-space:pre-wrap;">This pattern is taken from NServiceBus. It uses cascading topic exchanges which chain together via dead letter configuration and topic routing. The idea is that we create multiple levels of delay, where each level is responsible for its own fixed delay period. These periods increase to the power of 2. Level 1 as 1 minute, level 2 as 2 minutes, level 3 as 4 minutes, level 4 as 8 minutes etc. Then using binary style routing and binding keys we can move a message between delay queues to achieve any delay period at 1 minute resolution. You could use 20 or so queues, with level 1 at 1 second and achieve second resolution delay times up to a period of years!</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_5_1512724328604_30350"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:963px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 20. Cascading delay exchanges and queues&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:64.5898208618164%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512725959933-XRRSFP3XBKSWZW4K2ZWA/RabbitMQDelayedRetriesCascade.png" alt="Fig 20. Cascading delay exchanges and queues" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512725959933-XRRSFP3XBKSWZW4K2ZWA/RabbitMQDelayedRetriesCascade.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512725959933-XRRSFP3XBKSWZW4K2ZWA/RabbitMQDelayedRetriesCascade.png" data-image-dimensions="963x622" data-image-focal-point="0.5,0.5" alt="Fig 20. Cascading delay exchanges and queues" data-load="false" data-image-id="5a2a5dc78165f5386699e5d1" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 20. Cascading delay exchanges and queues</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_5_1512724328604_30629"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">The above diagram shows this cascading, shared delayed retry infrastructure with just three levels. With three levels, and level 1 being 1 minute, we can achieve any delay up to 7 minutes with a 1 minute resolution. Not much but this is a super simplified version.</p><p class="" style="white-space:pre-wrap;">Each delay queue has configured as its dead letter exchange the exchange of the level below. In this example we see that consumer 1 sends a message for retry with a delay of 5 minutes. Let's see how the message flows through the exchanges and queues:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">The level 3 exchange has two bindings. The routing key 1.0.1.consumer.app.1 matches the binding key *.*.1.# only. So it gets routed to the Level 3 queue. That queue has a 4 minute message TTL configured. After waiting for 4 minutes it gets dead lettered to the Level 2 exchange.</p></li><li><p class="" style="white-space:pre-wrap;">The Level 2 exchange has two bindings. The routing key 1.0.1.consumer.app.1 matches the binding key *.0.# only, so the message is routed to the Level 1 exchange.</p></li><li><p class="" style="white-space:pre-wrap;">The Level 1 exchange has two bindings. The routing key 1.0.1.consumer.app.1 matches the binding key 1.# only. So it gets routed to the Level 1 queue. That queue has a 1 minute message TTL configured. After waiting for 1 minute it gets dead lettered to the Level 0 exchange.</p></li><li><p class="" style="white-space:pre-wrap;">Both consumers have created bindings from their queues to this exchange. The message matches the #.consumer.app.1 binding and so is routed to the Consumer 1 queue where it gets consumed by Consumer 1 again, 5 minutes after it sent the message to the retry infrastructure.</p></li></ul><p class="" style="white-space:pre-wrap;">I love this pattern as it shows how the routing primitives that RabbitMQ offers can be combined so inventively.</p><p class="" style="white-space:pre-wrap;">Some things to remember about this pattern:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">This is a shared infrastructure approach and the wait times may not be exact under load.</p></li><li><p class="" style="white-space:pre-wrap;">If the original message had a routing key, it was removed for this pattern to work. I get around this by putting the routing key as a message header upon sending the message for retry, then the consumer can retrieve the original routing key if it needs it.</p></li><li><p class="" style="white-space:pre-wrap;">If the original message had a TTL and you want that to be respected then you'll need to add that as a message header when you send it for retry and get your application to check it and discard the message if the time period has passed. The reason for this is that when the consumer application sends the message to the retry exchanges, it shouldn't set the message TTL as that might interfere with the retry timing. In any case, when a message is dead lettered any message TTL is stripped from the message.</p></li><li><p class="" style="white-space:pre-wrap;">Retries and message ordering are fundamentally opposed. If message order is important then delayed retries are probably not a good idea unless you add some logic that detects older messages.</p></li></ul><p class="" style="white-space:pre-wrap;">&nbsp;</p><h2 style="white-space:pre-wrap;">#14 - Delayed Retry with Ephemeral Exchanges and Queues</h2><p class="" style="white-space:pre-wrap;">We can achieve similar results to the previous pattern with ephemeral exchanges and queues. When an application wants to send a message for a delayed retry, it creates a one-off exchange and queue with a guaranteed to be unique name, such as a GUID/UUID.</p><p class="" style="white-space:pre-wrap;">The ephemeral exchange is configured as follows:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">Fanout</p></li><li><p class="" style="white-space:pre-wrap;">Auto-delete</p></li></ul><p class="" style="white-space:pre-wrap;">The ephemeral queue is configured as follows:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">a message TTL corresponding to the delay you want.</p></li><li><p class="" style="white-space:pre-wrap;">its dead letter exchange is the Default exchange.</p></li><li><p class="" style="white-space:pre-wrap;">a queue TTL that expires a few seconds after the message TTL.</p></li><li><p class="" style="white-space:pre-wrap;">a binding to the ephemeral exchange.</p></li></ul><p class="" style="white-space:pre-wrap;">The consumer declares the exchange and queue, then sends the message for delayed retry with the routing key as the name of its own queue. The next series of events occur:</p><ol data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">Ephemeral exchange routes the message to the ephemeral queue</p></li><li><p class="" style="white-space:pre-wrap;">The message sits in the queue for the message TTL time period</p></li><li><p class="" style="white-space:pre-wrap;">The message is dead lettered to the default exchange</p></li><li><p class="" style="white-space:pre-wrap;">The default exchange routes the message to the queue that matches the routing key</p></li><li><p class="" style="white-space:pre-wrap;">The ephemeral queue reaches its queue TTL period and auto-deletes itself</p></li><li><p class="" style="white-space:pre-wrap;">The ephemeral exchange sees that no queues are bound to it and it auto-deletes itself.</p></li></ol>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_5_1512724328604_84886"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:893px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 21. Ephemeral exchanges and queues for delayed routing&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:39.30570983886719%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512730541862-EKOK4D8OMCZ0U5VRVP6R/RabbitMQRetriesEthemeral.png" alt="Fig 21. Ephemeral exchanges and queues for delayed routing" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512730541862-EKOK4D8OMCZ0U5VRVP6R/RabbitMQRetriesEthemeral.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512730541862-EKOK4D8OMCZ0U5VRVP6R/RabbitMQRetriesEthemeral.png" data-image-dimensions="893x351" data-image-focal-point="0.5,0.5" alt="Fig 21. Ephemeral exchanges and queues for delayed routing" data-load="false" data-image-id="5a2a6fad53450a1a5012982a" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 21. Ephemeral exchanges and queues for delayed routing</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_5_1512724328604_85163"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">Considerations to take into account:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">Creating exchanges, queues and bindings is relatively expensive. If you generate high loads with retries then this might put too much pressure on your cluster.</p></li><li><p class="" style="white-space:pre-wrap;">Like the cascading exchange pattern, the original routing key and message TTL are removed to make this work. See that pattern for more details on that.</p></li></ul><p class="" style="white-space:pre-wrap;">If you use the Public Message Exchange, Private Consumer Exchange pattern you don't need to rely on the default exchange at all and can configure the consumer's private exchange as the dead letter exchange. This removes the need to set a custom routing key.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_5_1512724328604_97345"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:850px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 22. Routing to private consumer exchange instead of Default exchange&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:41.41176223754883%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512731190129-PC06BFBS8B62L1VV3NHC/RabbitMQRetriesEthemeralPrivateExchange.png" alt="Fig 22. Routing to private consumer exchange instead of Default exchange" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512731190129-PC06BFBS8B62L1VV3NHC/RabbitMQRetriesEthemeralPrivateExchange.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512731190129-PC06BFBS8B62L1VV3NHC/RabbitMQRetriesEthemeralPrivateExchange.png" data-image-dimensions="850x352" data-image-focal-point="0.5,0.5" alt="Fig 22. Routing to private consumer exchange instead of Default exchange" data-load="false" data-image-id="5a2a72350d9297afb586c35c" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 22. Routing to private consumer exchange instead of Default exchange</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_5_1512724328604_97623"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">&nbsp;</p><h2 style="white-space:pre-wrap;">#15 - Delayed Delivery with the Delayed Message Exchange Plug-In</h2><p class="" style="white-space:pre-wrap;"><a href="https://github.com/rabbitmq/rabbitmq-delayed-message-exchange" target="_blank">https://github.com/rabbitmq/rabbitmq-delayed-message-exchange</a></p><p class="" style="white-space:pre-wrap;">This plug-in gives you a new exchange type, the Delayed Message exchange. This exchange can mimic the normal exchange types with the twist that if you put the header "x-delay" on a message, the exchange will delay delivery of the message for the number of milliseconds in your header value.</p><p class="" style="white-space:pre-wrap;">The downside of this plug-in is that it does not support high availability of messages that are in the delay period. So the loss a node will result in the loss of delayed messages on that node. Another downside is not supporting the "mandatory" flag. We haven't covered that yet as it falls under the <a href="https://jack-vanlightly.com/blog/2017/12/15/rabbitmq-vs-kafka-part-4-message-delivery-semantics-and-guarantees" target="_blank">Part 4 Delivery Guarantees</a> part of this series, but it plays an important role in message delivery guarantees.</p><h2 style="white-space:pre-wrap;">#16 - Delayed Delivery with Cascading Exchanges and Queues</h2><p class="" style="white-space:pre-wrap;">If the Delayed Message exchange plug-in isn't for you then you could try the casacading exchanges and queues pattern.&nbsp;This is the same pattern as the Delayed Retry with Cascading Exchanges and Queues, except that publishers send directly to the delay exchanges. Because we use a binary like routing keys, this places a burden on the publisher to be able to create the correct routing key. This can work if you create a code library for managing the creation of delayed messages and have control of the publisher.</p><p class="" style="white-space:pre-wrap;">The benefits of this approach over the plug-in are that we do not lose RabbitMQ HA capabilities.</p><h2 style="white-space:pre-wrap;">#17 - Delayed Delivery with Private Publisher Exchange</h2><p class="" style="white-space:pre-wrap;">If the publisher always wants the <strong>same </strong>delay on all messages then they can declare their own exchange and queue for the purposes of adding the delay.</p><p class="" style="white-space:pre-wrap;">Let's say that the third publisher of the diagram below needs to delay messages by 5 minutes, for business reason X.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_2_1512741677259_38723"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:711px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 23. Three publishers send to a topic exchange&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:28.410688400268555%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512747586678-5EJULIGE7B0GE9BKYHEQ/RabbitMQPubSubNoDelay.png" alt="Fig 23. Three publishers send to a topic exchange" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512747586678-5EJULIGE7B0GE9BKYHEQ/RabbitMQPubSubNoDelay.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512747586678-5EJULIGE7B0GE9BKYHEQ/RabbitMQPubSubNoDelay.png" data-image-dimensions="711x202" data-image-focal-point="0.5,0.5" alt="Fig 23. Three publishers send to a topic exchange" data-load="false" data-image-id="5a2ab2428165f5505378bcb2" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 23. Three publishers send to a topic exchange</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_2_1512741677259_39002"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">The third publisher declares its own exchange and queue, which means it does not affect other publishers. Because we always want a 5 minute delay we can use a single queue with its dead letter exchange as the main topic exchange.</p>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_2_1512741677259_42029"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1006px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 24. One publisher adds a delay with its own exchange and queue&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:22.564611434936523%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512747785265-U86N8QFV7SY58ZMF52QN/RabbitMQPrivateDelay.png" alt="Fig 24. One publisher adds a delay with its own exchange and queue" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512747785265-U86N8QFV7SY58ZMF52QN/RabbitMQPrivateDelay.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512747785265-U86N8QFV7SY58ZMF52QN/RabbitMQPrivateDelay.png" data-image-dimensions="1006x227" data-image-focal-point="0.5,0.5" alt="Fig 24. One publisher adds a delay with its own exchange and queue" data-load="false" data-image-id="5a2ab308f9619aa9894756d8" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 24. One publisher adds a delay with its own exchange and queue</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_2_1512741677259_42307"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">This is the simplest method of all but only works with a standard delay time. As stated earlier, messages are only dead lettered from the head of the queue so shorter TTL messages get stuck behind longer TTL messages. You cannot mix various length TTL messages.</p><h2 style="white-space:pre-wrap;">#18 - RPC and Reply-To Queues</h2><p class="" style="white-space:pre-wrap;">In order to do Remote Procedure Call (RPC) style messaging, in general you must use Reply-To queues that the recipient of your message can reply to. This can be tricky to get right and you should really ask yourself if you really need to use a messaging system for RPC. Messaging systems are built with asynchrony and durability in mind. Most of the reasons for using a messaging system are not there when it comes to RPC. But if you still want RPC then you have a few options on RabbitMQ.</p><p class="" style="white-space:pre-wrap;">But first let's speak more generally of the complexities of RPC over a messaging system. In our case RabbitMQ has a really neat feature that side steps these problems which other messaging systems suffer from. Let's first understand those issues so that we can appreciate the functionality provided by RabbitMQ (feel free to skip to the end of this pattern to view RabbitMQ's nice feature for RPC).</p><p class="" style="white-space:pre-wrap;">An important question is: do you want to make the call in code just like any other method invocation? If the answer is yes then you need an RPC architecture that is compatible with a stateful context. That is, there is state in an active thread on a particular host that needs the response message to get back to it. If we have a scaled out service of 10 instances, with hundreds of threads per instance, we need that the response message gets delivered back to that same thread on that same host. This rules out some patterns.</p><p class="" style="white-space:pre-wrap;">However, if we have a stateless context then we are free to choose any of the RPC patterns. If upon making the RPC call the context of that execution ends and all state is either lost or cached with a correlation Id in Redis or something, then we have more freedom to choose different patterns. However this stateless context is not always possible or desired.</p><p class="" style="white-space:pre-wrap;">Let's review each option, whether it works in a stateful or stateless context and what other trade-offs it might have. We'll explore them using RabbitMQ's exchanges and queues.&nbsp;</p><h3 style="white-space:pre-wrap;">Fixed Reply-To Queue and Correlation ID</h3>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_2_1512741677259_153016"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:723px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 25. Single reply-to queue&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:27.800830841064453%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512751601938-JXXUDQD4N6NKOF0M3CCW/RabbitMQReplyToFixed.png" alt="Fig 25. Single reply-to queue" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512751601938-JXXUDQD4N6NKOF0M3CCW/RabbitMQReplyToFixed.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512751601938-JXXUDQD4N6NKOF0M3CCW/RabbitMQReplyToFixed.png" data-image-dimensions="723x201" data-image-focal-point="0.5,0.5" alt="Fig 25. Single reply-to queue" data-load="false" data-image-id="5a2ac1f18165f591bb562050" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 25. Single reply-to queue</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_2_1512741677259_153294"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">The outgoing message includes two message headers:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">reply-to-queue</p></li><li><p class="" style="white-space:pre-wrap;">correlation-id</p></li></ul><p class="" style="white-space:pre-wrap;">The recipient sends the message to the Default exchange with the reply-to queue name as the routing key. It also includes the same correlation-id header and value. The original sender consumes this reply to queue and can retrieve any state from a state store using the correlation id.</p><p class="" style="white-space:pre-wrap;">Obviously this is not compatible with our stateful context. Any of our 10 instances of the application could consume the message.</p><h3 style="white-space:pre-wrap;">Queue Per Application Instance and Correlation Id</h3>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_2_1512741677259_155387"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:728px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 26. Reply-To queue per application host&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:45.60439682006836%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512751646951-MR59CKFZUEHHPBV3S265/RabbitMQReplyToPerHost.png" alt="Fig 26. Reply-To queue per application host" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512751646951-MR59CKFZUEHHPBV3S265/RabbitMQReplyToPerHost.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512751646951-MR59CKFZUEHHPBV3S265/RabbitMQReplyToPerHost.png" data-image-dimensions="728x332" data-image-focal-point="0.5,0.5" alt="Fig 26. Reply-To queue per application host" data-load="false" data-image-id="5a2ac21e085229df98068b61" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 26. Reply-To queue per application host</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_2_1512741677259_155665"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">This is the same as the Fixed Queue pattern except that each application instance has a separate queue. This can be compatible with the stateful context if you go through some hoops to get there. First of all if your application is single-threaded, with only one active request at a time then you can be sure that the thread that waits for a response will be the one that receives the response message. But these applications are not common. More likely it is a web application and therefore multi-threaded with multiple active requests. In this case it depends on the capabilities of the language.</p><p class="" style="white-space:pre-wrap;">C# for example has the ability to store a waiting Task as a TaskCompletionSource object in memory and resume the task at any time. You can use a singleton class to store TaskCompletionSource objects by their correlation ids in a dictionary. The singleton is the only object that consumes messages. When it consumes a message it retrieves the correlation Id from the message, and retrieves the TaskCompletionSource object from a dictionary and resumes it, passing it the message.</p><p class="" style="white-space:pre-wrap;">This is not trivial code to write however and could be a risky choice depending on your concurrency programming skill levels. Bugs would be difficult to diagnose and fix. If you can find a library to do that for you then this could be a decent option.</p><h3 style="white-space:pre-wrap;">Ephemeral Reply-To Queue with No Correlation Id</h3>


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_2_1512741677259_157562"><div class="sqs-block-content">















  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:728px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot;&gt;Fig 27. Ephemeral reply-to queue per message&lt;/p&gt;"
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:48.35165023803711%;
                
                overflow: hidden;
              "
              >
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512751707102-OIKQ2GQVZOISWMHB5JBS/RabbitMQReplyToEphemeral.png" alt="Fig 27. Ephemeral reply-to queue per message" /></noscript><img class="thumb-image" data-src="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512751707102-OIKQ2GQVZOISWMHB5JBS/RabbitMQReplyToEphemeral.png" data-image="https://images.squarespace-cdn.com/content/v1/56894e581c1210fead06f878/1512751707102-OIKQ2GQVZOISWMHB5JBS/RabbitMQReplyToEphemeral.png" data-image-dimensions="728x352" data-image-focal-point="0.5,0.5" alt="Fig 27. Ephemeral reply-to queue per message" data-load="false" data-image-id="5a2ac25a085229df980696ab" data-type="image" />
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="">Fig 27. Ephemeral reply-to queue per message</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_2_1512741677259_157840"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">This is totally compatible with the stateful context and is the simplest pattern. The caller declares a queue with a GUID/UUID as a name and passes that as a message header in the request message. The queue should be made an auto-delete queue so that it automatically deletes itself once the sender has stopped using it. The recipient sends a response message to this queue as indicated in the request message header. Once the sender has consumed the response message it cancels its subscription to the queue and the queue auto-deletes itself.</p><p class="" style="white-space:pre-wrap;">So what is the trade-off with this simple and elegant design? Performance. Creation of queues can be expensive. If you have a decent amount of traffic then you would need to do trials to see if the constant creation and auto-deletion of queues puts too much burden on the cluster. Other messaging systems don't even have ephemeral exchanges and queues to help with this problem!&nbsp;</p><h3 style="white-space:pre-wrap;">RabbitMQ's Killer RPC Feature - Direct Reply-To</h3><p class="" style="white-space:pre-wrap;">Finally we get to RabbitMQ's cool RPC feature. Direct Reply-To side steps all these issues by giving you something very similar to the ephemeral pattern but without the performance issues. This is how it works:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">The sender puts the name of a "pseudo queue" called <em>amq.rabbitmq.reply-to </em>in the reply-to message header. It is a pseudo queue because it is not really a queue at all, but it can be treated as one.</p></li><li><p class="" style="white-space:pre-wrap;">The sender consumes this <em>amq.rabbitmq.reply-to </em>queue in no-ack mode (more on that in <a href="https://jack-vanlightly.com/blog/2017/12/15/rabbitmq-vs-kafka-part-4-message-delivery-semantics-and-guarantees" target="_blank">Part 4 Message Delivery Guarantees</a> part of the series).</p></li><li><p class="" style="white-space:pre-wrap;">The recipient sends the response message to the Default exchange with the routing key as the name of this pseudo queue.</p></li><li><p class="" style="white-space:pre-wrap;">The consumer gets pushed the message from the RabbitMQ node directly, without it having ever been written to a queue.</p></li></ul><p class="" style="white-space:pre-wrap;">Obviously we lose high availability guarantees because we cannot use queue mirroring to replicate the message across nodes, but with RPC we don't really need that. Also if the sender gets disconnected then the pseudo queue goes away and no response can be sent. But that is no different than RPC over HTTP.</p><p class="" style="white-space:pre-wrap;">Basically, just like with HTTP if something goes wrong you just retry the request again and even use patterns such as circuit breaker if need be.</p><p class="" style="white-space:pre-wrap;">So RabbitMQ has a special custom behaviour for doing RPC that avoids all the pain of real reply-to queues.&nbsp;</p><h1 style="white-space:pre-wrap;">Message Lifecycle</h1><p class="" style="white-space:pre-wrap;">We can create a full message lifecycle that handles transient and non-transient errors in a way that guarantees that we don't lose messages and that we can respond to processing failures in a controlled and managed way.</p><p class="" style="white-space:pre-wrap;">What does a lifecycle consist of? Basically it is a workflow of possible paths that a message can take. It starts at the publishing of a message, then includes the successful processing of a message, or retries in case of transient failure, a place for unprocessable messages to go to, a place to archive failed messages, the option to discard, returning failed messages to the original consumers etc.</p><p class="" style="white-space:pre-wrap;">Core to this concept is also that failed messages carry with them all the information practically possible to diagnose the failure. This means:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">The consumer application</p></li><li><p class="" style="white-space:pre-wrap;">The exception or error message</p></li><li><p class="" style="white-space:pre-wrap;">The server</p></li><li><p class="" style="white-space:pre-wrap;">The time</p></li><li><p class="" style="white-space:pre-wrap;">Who published the message</p></li><li><p class="" style="white-space:pre-wrap;">How many times has this message been processed?</p></li></ul><p class="" style="white-space:pre-wrap;">We build the lifecycle into our messaging code library with a super simple code API for developers to use. Additionally, we ensure that the code API <strong>forces </strong>them to think about the nature of the failure - is it transient or persistent?&nbsp;Do we do immediate retries, delayed retries, discard the message or send it to a failed message queue?</p><p class="" style="white-space:pre-wrap;">Read my <a href="https://jack-vanlightly.com/blog/2017/6/11/improving-reliability-and-incident-response-via-a-message-lifecycle" target="_blank">full article</a> on building a message lifecycle with RabbitMQ.</p><h1 style="white-space:pre-wrap;">Other Messaging Patterns</h1><p class="" style="white-space:pre-wrap;">There are more patterns that are related to messaging in general that I have not covered such as:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">Sagas</p></li><li><p class="" style="white-space:pre-wrap;">Commands/Events</p></li><li><p class="" style="white-space:pre-wrap;">Message Processing Audit Feeds</p></li><li><p class="" style="white-space:pre-wrap;">Change Data Capture (CDC) Feeds</p></li></ul><p class="" style="white-space:pre-wrap;">RabbitMQ doesn't necessarily have specific features regarding the above patterns which is why I have not explored them in the example patterns section. NServiceBus has good support for Sagas, Commands/Events and Message Processing Audit Feeds. I have not used NServiceBus in production but have played with it a fair amount and analysed its messaging topologies on RabbitMQ. I would recommend looking into it if you are looking at an event driven architecture and are on the .NET stack.</p><p class="" style="white-space:pre-wrap;">RabbitMQ has more than I have covered here, plug-ins and other functionality I have not mentioned. If I have missed any patterns or topologies then please leave a comment!</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;"><a href="https://jack-vanlightly.com/blog/2017/12/3/rabbitmq-vs-kafka-series-introduction" target="_blank">Series Introduction</a></p></li><li><p class="" style="white-space:pre-wrap;"><a href="https://jack-vanlightly.com/blog/2017/12/4/rabbitmq-vs-kafka-part-1-messaging-topologies" target="_blank">Part 1 - Two different takes on messaging (high level design comparison)</a></p></li><li><p class="" style="white-space:pre-wrap;"><a href="https://jack-vanlightly.com/blog/2017/12/5/rabbitmq-vs-kafka-part-2-rabbitmq-messaging-patterns-and-topologies" target="_blank">Part 2 - Messaging patterns and topologies with RabbitMQ</a></p></li><li><p class="" style="white-space:pre-wrap;"><a href="https://jack-vanlightly.com/blog/2017/12/8/rabbitmq-vs-kafka-part-3-kafka-messaging-patterns" target="_blank">Part 3 - Messaging patterns and topologies with Kafka</a></p></li><li><p class="" style="white-space:pre-wrap;"><a href="https://jack-vanlightly.com/blog/2017/12/15/rabbitmq-vs-kafka-part-4-message-delivery-semantics-and-guarantees" target="_blank">Part 4 - Message delivery semantics and guarantees</a></p></li><li><p class="" style="white-space:pre-wrap;"><a href="https://jack-vanlightly.com/blog/2018/8/31/rabbitmq-vs-kafka-part-5-fault-tolerance-and-high-availability-with-rabbitmq">Part 5 - Fault tolerance and high availability with RabbitMQ</a></p></li><li><p class="" style="white-space:pre-wrap;">Part 6 - Fault tolerance and high availability with Kafka</p></li></ul>


</div></div></div></div></div>
      
    </div>

    <footer class="entry-footer clear">
      
      
      <p class="entry-tags">
        Tagged: <a href="/blog/tag/Kafka" rel="tag">Kafka</a>, <a href="/blog/tag/Messaging" rel="tag">Messaging</a>, <a href="/blog/tag/RabbitMQ" rel="tag">RabbitMQ</a>
      </p>
      
      <div class="entry-actions">
        
  <span class="sqs-simple-like" data-item-id="5a271bad41920214cc8a1ea5" data-like-count="33">
    <span class="like-icon"></span>
    <span class="like-count"></span>
  </span>
<span class="squarespace-social-buttons inline-style" data-system-data-id="" data-asset-url="https://static1.squarespace.com/static/56894e581c1210fead06f878/56894f3ea12f44306f8afde0/5a271bad41920214cc8a1ea5/1574959979940/" data-record-type="1" data-full-url="/blog/2017/12/5/rabbitmq-vs-kafka-part-2-rabbitmq-messaging-patterns-and-topologies" data-title="RabbitMQ vs Kafka Part 2 - RabbitMQ Messaging Patterns"></span>
      </div>
    </footer>

    

  </article>

  <div id="comments-5a271bad41920214cc8a1ea5" class="p-comment">
    
  <div class="squarespace-comments" id="comments-5a271bad41920214cc8a1ea5" data-item-id="5a271bad41920214cc8a1ea5" data-public-comment-count="19" data-comment-state="1"></div>

  </div>

  

  
  <nav class="pagination clear">
    <div class="newer"><span class="prev-label">Newer Post</span><a href="/blog/2017/12/8/rabbitmq-vs-kafka-part-3-kafka-messaging-patterns" rel="prev"><span>RabbitMQ vs Kafka Part 3 - Kafka Messaging Patterns</span></a></div><!-- comment the linebreak between these two elements because science
  --><div class="older"><span class="next-label">Older Post</span><a href="/blog/2017/12/4/rabbitmq-vs-kafka-part-1-messaging-topologies" rel="next"><span>RabbitMQ vs Kafka Part 1 - Two Different Takes on Messaging</span></a></div>
  </nav>
  

</div>
        </div><!--
        --><aside id="rightSidebar" role="complementary">
          <div class="sqs-layout sqs-grid-12 columns-12 open-block-field" data-layout-label="Blog Sidebar Content" data-type="block-field" data-updated-on="1548520853875" id="blogBlocks-56894f3ea12f44306f8afde0"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block rss-block sqs-block-rss" data-block-type="49" id="block-yui_3_17_2_1_1548520439621_4918"><div class="sqs-block-content">



<a href="https://jack-vanlightly.com/?format=rss" title="Blog RSS" class="social-rss">Blog RSS</a>
</div></div><div class="sqs-block summary-v2-block sqs-block-summary-v2" data-block-json="&#123;&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;collectionId&quot;:&quot;56894f3ea12f44306f8afde0&quot;,&quot;design&quot;:&quot;list&quot;,&quot;headerText&quot;:&quot;Featured&quot;,&quot;textSize&quot;:&quot;small&quot;,&quot;pageSize&quot;:30,&quot;imageAspectRatio&quot;:&quot;0.6666666666666666&quot;,&quot;columnWidth&quot;:270,&quot;gutter&quot;:60,&quot;listImageSize&quot;:20,&quot;listImageAlignment&quot;:&quot;left&quot;,&quot;slidesPerRow&quot;:3,&quot;textAlignment&quot;:&quot;left&quot;,&quot;showTitle&quot;:true,&quot;showThumbnail&quot;:false,&quot;showExcerpt&quot;:false,&quot;showReadMoreLink&quot;:false,&quot;showPrice&quot;:true,&quot;productQuickViewEnabled&quot;:false,&quot;showPastOrUpcomingEvents&quot;:&quot;Upcoming&quot;,&quot;metadataPosition&quot;:&quot;below-content&quot;,&quot;primaryMetadata&quot;:&quot;date&quot;,&quot;secondaryMetadata&quot;:&quot;none&quot;,&quot;filter&quot;:&#123;&#125;,&quot;autoCrop&quot;:true,&quot;lightbox&quot;:false,&quot;mixedContent&quot;:true,&quot;blockId&quot;:&quot;8d5d57cf8e4afb4f3d20&quot;&#125;" data-block-type="55" id="block-yui_3_17_2_47_1477842229595_12664"><div class="sqs-block-content">





<div class="
  summary-block-wrapper

  summary-block-collection-type-blog

  summary-block-setting-text-size-small
  summary-block-setting-text-align-left

  summary-block-setting-design-list
  summary-block-setting-design-list-thumbnail-left

  summary-block-setting-metadata-position-below-content
  summary-block-setting-primary-metadata-date
  summary-block-setting-secondary-metadata-none

  
  summary-block-setting-show-title
  summary-block-setting-show-price
  summary-block-setting-hide-excerpt
  

  

  sqs-gallery-design-list

  
  "

  
>

  <div class="summary-item-list-container sqs-gallery-container">

    <header class="summary-block-header">
      
      <div class="summary-heading" data-animation-role="content">
        
          <span class="summary-header-text">Featured</span>
        
      </div>

      
      <div class="summary-carousel-pager sqs-gallery-controls" data-animation-role="content">
        <span
          class="summary-carousel-pager-prev previous"
          tabindex="0"
          role="button"
          aria-label="Previous"
        ></span>
        <span
          class="summary-carousel-pager-next next"
          tabindex="0"
          role="button"
          aria-label="Next"
        ></span>
      </div>

    </header>

    <div class="summary-item-list sqs-gallery">
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2022-01-25">Jan 25, 2022</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2022/1/25/write-for-others-but-mostly-for-yourself"
                  
                
                class="summary-title-link">Write for others but mostly for yourself</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2022-01-25">Jan 25, 2022</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2022-01-25">Jan 25, 2022</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2021-12-10">Dec 10, 2021</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2021/12/9/tweaking-the-bookkeeper-protocol-unbounded-ledgers"
                  
                
                class="summary-title-link">Tweaking the BookKeeper protocol - Unbounded Ledgers</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2021-12-10">Dec 10, 2021</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2021-12-10">Dec 10, 2021</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2021-12-08">Dec 8, 2021</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2021/12/7/tweaking-the-bookkeeper-protocol-guaranteeing-write-quorum"
                  
                
                class="summary-title-link">Tweaking the BookKeeper protocol - Guaranteeing write quorum</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2021-12-08">Dec 8, 2021</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2021-12-08">Dec 8, 2021</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
          
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2021-10-09">Oct 9, 2021</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2021/10/9/learn-about-tla-and-the-formal-verification-of-apache-bookkeeper"
                  
                
                class="summary-title-link">Learn about TLA+ and the formal verification of Apache BookKeeper</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2021-10-09">Oct 9, 2021</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2021-10-09">Oct 9, 2021</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2021-10-09">Oct 9, 2021</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2021/10/9/posts-in-wrote-on-the-rabbitmq-blog-in-2020"
                  
                
                class="summary-title-link">Posts I wrote on the RabbitMQ blog in 2020</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2021-10-09">Oct 9, 2021</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2021-10-09">Oct 9, 2021</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2021-10-09">Oct 9, 2021</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2021/10/9/kafka-and-rabbitmq-blog-posts-i-wrote-elsewhere-in-2019"
                  
                
                class="summary-title-link">Kafka and RabbitMQ blog posts I wrote elsewhere in 2019</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2021-10-09">Oct 9, 2021</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2021-10-09">Oct 9, 2021</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2020-05-26">May 26, 2020</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2020/5/26/with-great-observation-comes-great-insight"
                  
                
                class="summary-title-link">With Great Observation Comes Great Insight</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2020-05-26">May 26, 2020</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2020-05-26">May 26, 2020</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
          
          summary-item-has-cats
          
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2020-05-14">May 14, 2020</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2020/5/14/why-im-not-writing-much-on-my-blog-these-days"
                  
                
                class="summary-title-link">Why I'm Not Writing Much On My Blog These Days</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2020-05-14">May 14, 2020</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2020-05-14">May 14, 2020</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-09-06">Sep 6, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2019/9/4/a-look-at-multi-topic-subscriptions-with-apache-pulsar"
                  
                
                class="summary-title-link">A Look at Multi-Topic Subscriptions with Apache Pulsar</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-09-06">Sep 6, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-09-06">Sep 6, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-02-10">Feb 10, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2019/2/9/building-a-simple-distributed-system-logging"
                  
                
                class="summary-title-link">Building A "Simple" Distributed System - It's the Logs Stupid</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-02-10">Feb 10, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-02-10">Feb 10, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-02-02">Feb 2, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2019/2/1/building-a-simple-distributed-system-the-implementation"
                  
                
                class="summary-title-link">Building A "Simple" Distributed System - The Implementation</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-02-02">Feb 2, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-02-02">Feb 2, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-01-28">Jan 28, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2019/1/27/building-a-simple-distributed-system-formal-verification"
                  
                
                class="summary-title-link">Building A "Simple" Distributed System - Formal Verification</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-01-28">Jan 28, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-01-28">Jan 28, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-01-27">Jan 27, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2019/1/27/building-a-simple-distributed-system-the-protocol"
                  
                
                class="summary-title-link">Building A "Simple" Distributed System - The Protocol</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-01-27">Jan 27, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-01-27">Jan 27, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-01-26">Jan 26, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2019/1/25/building-a-simple-distributed-system-the-what"
                  
                
                class="summary-title-link">Building a "Simple" Distributed System - The What</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-01-26">Jan 26, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2019-01-26">Jan 26, 2019</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-11-20">Nov 20, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2018/11/20/quorum-queues-making-rabbitmq-more-competitive"
                  
                
                class="summary-title-link">Quorum Queues - Making RabbitMQ More Competitive in Reliable Messaging</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-11-20">Nov 20, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-11-20">Nov 20, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-11-14">Nov 14, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2018/11/14/why-i-am-not-a-fan-of-the-rabbitmq-sharding-plugin"
                  
                
                class="summary-title-link">Why I Am Not a Fan of the RabbitMQ Sharding Plugin</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-11-14">Nov 14, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-11-14">Nov 14, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-11-02">Nov 2, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2018/10/25/testing-producer-deduplication-in-apache-kafka-and-apache-pulsar"
                  
                
                class="summary-title-link">Testing Producer Deduplication in Apache Kafka and Apache Pulsar</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-11-02">Nov 2, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-11-02">Nov 2, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-10-21">Oct 21, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2018/10/21/how-to-not-lose-messages-on-an-apache-pulsar-cluster"
                  
                
                class="summary-title-link">How to (not) Lose Messages on an Apache Pulsar Cluster</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-10-21">Oct 21, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-10-21">Oct 21, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-10-03">Oct 3, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2018/10/2/understanding-how-apache-pulsar-works"
                  
                
                class="summary-title-link">Understanding How Apache Pulsar Works</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-10-03">Oct 3, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-10-03">Oct 3, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-09-20">Sep 20, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2018/9/18/how-to-lose-messages-on-a-kafka-cluster-part-2"
                  
                
                class="summary-title-link">How to Lose Messages on a Kafka Cluster - Part 2</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-09-20">Sep 20, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-09-20">Sep 20, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-09-18">Sep 18, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2018/9/14/how-to-lose-messages-on-a-kafka-cluster-part1"
                  
                
                class="summary-title-link">How to Lose Messages on a Kafka Cluster - Part 1</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-09-18">Sep 18, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-09-18">Sep 18, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-09-13">Sep 13, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2018/9/10/how-to-lose-messages-on-a-rabbitmq-cluster"
                  
                
                class="summary-title-link">How to Lose Messages on a RabbitMQ Cluster</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-09-13">Sep 13, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-09-13">Sep 13, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-09-05">Sep 5, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2018/9/2/rabbitmq-vs-kafka-part-6-fault-tolerance-and-high-availability-with-kafka"
                  
                
                class="summary-title-link">RabbitMQ vs Kafka Part 6 - Fault Tolerance and High Availability with Kafka</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-09-05">Sep 5, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-09-05">Sep 5, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-08-31">Aug 31, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2018/8/31/rabbitmq-vs-kafka-part-5-fault-tolerance-and-high-availability-with-rabbitmq"
                  
                
                class="summary-title-link">RabbitMQ vs Kafka Part 5 - Fault Tolerance and High Availability with RabbitMQ Clustering</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-08-31">Aug 31, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-08-31">Aug 31, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-08-14">Aug 14, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2018/8/14/aws-security-securing-your-use-of-the-aws-cli-and-automation-tools"
                  
                
                class="summary-title-link">AWS Security - Securing Your Use of the AWS CLI and Automation Tools</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-08-14">Aug 14, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-08-14">Aug 14, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-07-25">Jul 25, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2018/7/25/rabbitmq-work-queues-avoiding-data-inconsistency-with-rebalanser"
                  
                
                class="summary-title-link">RabbitMQ Work Queues: Avoiding Data Inconsistency with Rebalanser</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-07-25">Jul 25, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-07-25">Jul 25, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-07-23">Jul 23, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2018/7/22/creating-consumer-groups-in-rabbitmq-with-rebalanser-part-1"
                  
                
                class="summary-title-link">Creating Consumer Groups in RabbitMQ with Rebalanser - Part 1</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-07-23">Jul 23, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-07-23">Jul 23, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-05-29">May 29, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2018/5/29/net-core-aws-lambda-lifetime-after-uncontrolled-exception"
                  
                
                class="summary-title-link">.NET Core AWS Lambda Lifetime After Uncontrolled Exception</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-05-29">May 29, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-05-29">May 29, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
           summary-item-has-excerpt
          summary-item-has-cats
          
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-05-26">May 26, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/docker-net-core-and-redshift-drivers"
                  
                
                class="summary-title-link">Docker, .NET Core and Redshift Drivers</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-05-26">May 26, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-05-26">May 26, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
        <div class="
          summary-item
          summary-item-record-type-text
          sqs-gallery-design-list-slide
          
          
            summary-item-has-thumbnail
          
           summary-item-has-excerpt
          summary-item-has-cats
          summary-item-has-tags
          summary-item-has-author
          summary-item-has-comments-enabled
          "
          >

          

          <div class="summary-content sqs-gallery-meta-container" data-animation-role="content">

            
            <div class="summary-metadata-container summary-metadata-container--above-title">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-05-21">May 21, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
              <div class="summary-title">
                <a
                
                  
                    href="/blog/2018/5/21/event-driven-architectures-queue-vs-log-case-study"
                  
                
                class="summary-title-link">Event-Driven Architectures - Queue vs Log - A Case Study</a></div>
            

            
            <div class="summary-metadata-container summary-metadata-container--below-title">
            
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-05-21">May 21, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

            
              
            

            

            
            <div class="summary-metadata-container summary-metadata-container--below-content">
              
              <div class="summary-metadata summary-metadata--primary">

	
	  
	    <!-- Timestamp -->
	    <time class="summary-metadata-item summary-metadata-item--date" datetime="2018-05-21">May 21, 2018</time>
	  
	












</div>
              
              <div class="summary-metadata summary-metadata--secondary">

	












</div>
            </div>

          </div>
        </div>
      
    </div>
  </div>
</div>
</div></div></div></div></div>
        </aside>
        
        
      </main>

      <div id="preFooter">
        <div class="pre-footer-inner">
          <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Pre-Footer Content" data-type="block-field" data-updated-on="1406661050940" id="preFooterBlocks"><div class="row sqs-row"><div class="col sqs-col-12 span-12"></div></div></div>
        </div>
      </div>

      <footer id="footer" role="contentinfo">
        <div class="footer-inner">
          <div class="nav-wrapper back-to-top-nav"><nav><div class="back-to-top"><a href="#header">Back to Top</a></div></nav></div>
          


          
          <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Footer Content" data-type="block-field" data-updated-on="1467218933704" id="footerBlocks"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_2_1466619395486_6722"><div class="sqs-block-content"><p class="text-align-center">Powered by <a target="_blank" href="http://www.squarespace.com?channel=word_of_mouth&amp;subchannel=customer&amp;source=footer&amp;campaign=4fd1028ee4b02be53c65dfb3">Squarespace</a></p>


</div></div></div></div></div>
        </div>
      </footer>

    </div>

    <script src="https://static1.squarespace.com/static/ta/52a74d9ae4b0253945d2aee9/1043/scripts/site-bundle.js" type="text/javascript"></script>
    <script type="text/javascript" data-sqs-type="imageloader-bootstrapper">(function() {if(window.ImageLoader) { window.ImageLoader.bootstrap({}, document); }})();</script><script>Squarespace.afterBodyLoad(Y);</script>

  </body>
</html>
