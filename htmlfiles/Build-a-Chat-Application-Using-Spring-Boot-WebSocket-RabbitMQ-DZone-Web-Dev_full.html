
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="A software developer gives a tutorial on how to combine several technologies, such as Java, JavaScript, and RabbitMQ, to create a chat application.">
  <meta name="keywords" content="Spring Framework, spring boot, application, WebSocket, build">

  <meta property="og:description" content="A software developer gives a tutorial on how to combine several technologies, such as Java, JavaScript, and RabbitMQ, to create a chat application.">
  <meta property="og:site_name" content="dzone.com">
  <meta property="og:title" content="Build a Chat Application Using Spring Boot + WebSocket + RabbitMQ - DZone Web Dev">
  <meta property="og:url" content="https://dzone.com/articles/build-a-chat-application-using-spring-boot-websock">
  <meta property="og:image" content="https://dz2cdn1.dzone.com/storage/article-thumb/11182216-thumb.jpg">
  <meta property="og:type" content="article">

  <meta name="twitter:site" content="@DZoneInc">
  <meta name="twitter:image" content="https://dz2cdn1.dzone.com/storage/article-thumb/11182216-thumb.jpg">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:description" content="A software developer gives a tutorial on how to combine several technologies, such as Java, JavaScript, and RabbitMQ, to create a chat application.">
  <meta name="twitter:title" content="Build a Chat Application Using Spring Boot + WebSocket + RabbitMQ - DZone Web Dev">

  <meta name="referrer" content="origin-when-cross-origin">
  <meta name="google-site-verification" content="kndbhxcupfEqWmZclhCpB6vlgOs7QSmx2UHAGGnP2mA">
  <meta name="df-verify" content="df0d76632b4543">

  <link rel="icon" type="image/x-icon" href="https://dz2cdn3.dzone.com/themes/dz20/images/favicon.png">
  <link rel="image_src" href="https://dz2cdn1.dzone.com/storage/article-thumb/11182216-thumb.jpg">
  <link rel="canonical" href="https://dzone.com/articles/build-a-chat-application-using-spring-boot-websock">

  <title>Build a Chat Application Using Spring Boot + WebSocket + RabbitMQ - DZone Web Dev</title>

  <link rel="preload" href="https://fonts.dzone.com/themes/dz20/font/fontello.woff?11773374" as="font" type="font/woff" crossorigin="anonymous">

  <link rel="stylesheet" media="all" href="https://dz2cdn3.dzone.com/themes/dz20/ftl/icons.css">
  <link rel="stylesheet" media="all" href="https://dz2cdn3.dzone.com/themes/dz20/lib/static/bootstrap/bootstrap.min.css">
  <link rel="stylesheet" media="all" href="https://dz2cdn3.dzone.com/themes/dz20/ftl/article/global.css">
  <link rel="stylesheet" media="all" href="https://dz2cdn3.dzone.com/themes/dz20/ftl/header/styles.css">
</head>
<body>
<div id="ftl-header">
  <div class="container-fluid header">
    <div class="row">
      <div class="col-md-12" style="padding: 0;">
        <div class="header-top">
          <div class="header-container">
            <div class="pull-left logo-container">
              <div class="logo">
                <a class="inner" href="/">
                  <picture>
                    <source srcset="https://dz2cdn3.dzone.com/themes/dz20/images/dz_logo_2021_cropped.webp" type="image/webp">
                    <source srcset="https://dz2cdn3.dzone.com/themes/dz20/images/dz_logo_2021_cropped.png" type="image/png">
                    <img src="https://dz2cdn3.dzone.com/themes/dz20/images/dz_logo_2021_cropped.png" width="160" height="52" alt="DZone">
                  </picture>
                </a>
              </div>

                <div class="active-portal"><a href="/web-development-programming-tutorials-tools-news">Web Dev Zone</a></div>
            </div>

            <div class="pull-right login-and-search">
              <div id="authenticated-block" class="logged-in">
                <div class="welcome-back">Thanks for visiting DZone today,</div>
                <div id="user-header" class="user-info">
                  <button class="user-avatar">
                    <span id="header-username" class="username"></span>
                    <img id="header-avatar" src="" alt="user avatar">
                  </button>
                  <div id="user-dropdown" class="browse-user-menu">
                    <div class="user-content">
                      <a id="header-user-plug" href="#" class="user-description"></a>
                      <a id="header-user-edit" href="#" class="edit-profile">Edit Profile</a>
                    </div>
                    <ul class="user-actions">
                      <li id="first-user-action"><a id="header-dropdown-manage-email" href="#">Manage Email Subscriptions</a></li>
                      <li>
                        <a href="/articles/how-to-submit-a-post-to-dzone?utm_source=DZone&utm_medium=user_dropdown&utm_campaign=how_to_post">
                          How to Post to DZone
                        </a>
                      </li>
                      <li>
                        <a href="/articles/dzones-article-submission-guidelines">
                          Article Submission Guidelines
                        </a>
                      </li>
                    </ul>
                    <div class="bottom">
                      <a href="/users/logout.html" class="sign-out">Sign Out</a>
                      <a id="dropdown-view-profile" href="#" class="view-profile">View Profile</a>
                    </div>
                  </div>
                </div>

                <div class="post-content">
                  <button id="post-button" class="post-content--button">
                    <span class="post-class">Post</span>
                    <i class="icon-plus"></i>
                  </button>

                  <div id="post-menu" class="posting-links">
                    <div class="posting-links-menu">
                      <ul>
                        <li>
                          <img src="/themes/dz20/images/dz-postarticle.svg">
                          <a href="/content/article/post.html">Post an Article</a>
                        </li>
                        <li>
                          <a id="drafts-link" href="#">Manage My Drafts</a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>

              <div id="unauthenticated-block">
                <div class="dz-intro">Over 2 million developers have joined DZone.</div>
                <div class="mobile-invisible sign-in-join">
                  <a href="/users/login.html">Log In</a>
                  <span class="dz-intro-span">/</span>
                  <a href="/static/registration.html">Join</a>
                </div>
                <a class="join-icon" href="/users/login.html"><i class="icon-user"></i></a>
              </div>
              <div class="headerSearch">
                <a class="icon-search dropdown-toggle" href="/search"></a>
              </div>
            </div>
          </div>
        </div>

        <div class="header-bottom">


          <ul class="portals header-container scrollable-ul">
            <li>
              <a href="/refcardz" id="header-refcardz">
                <em>Refcardz</em>
              </a>
            </li>
            <li>
              <a href="/trendreports" id="header-research">
                <em>Trend Reports</em>
              </a>
            </li>
            <li>
              <a href="/webinars" id="header-webinars">
                <em>Webinars</em>
              </a>
            </li>
            <li class="last-portal-link">
              <a href="#" id="header-portals">
                <em>
                  Zones
                  <span id="zone-arrow" class="collapsible-toggle">
                    <i class="icon-angle-down"></i>
                    <i class="icon-angle-up"></i>
                  </span>
                </em>
              </a>
            </li>

            <li class="separator" aria-hidden="true" style="color: #d9dcdd;">|</li>
            <li id="portal-list" class="portal-topics">
              <ul>
                  <li>
                    <a href="/agile-methodology-training-tools-news" id="header-2">Agile</a>
                  </li>
                  <li>
                    <a href="/artificial-intelligence-tutorials-tools-news" id="header-4001">AI</a>
                  </li>
                  <li>
                    <a href="/big-data-analytics-tutorials-tools-news" id="header-3">Big Data</a>
                  </li>
                  <li>
                    <a href="/cloud-computing-tutorials-tools-news" id="header-4">Cloud</a>
                  </li>
                  <li>
                    <a href="/database-sql-nosql-tutorials-tools-news" id="header-5">Database</a>
                  </li>
                  <li>
                    <a href="/devops-tutorials-tools-news" id="header-6">DevOps</a>
                  </li>
                  <li>
                    <a href="/enterprise-integration-training-tools-news" id="header-7">Integration</a>
                  </li>
                  <li>
                    <a href="/iot-developer-tutorials-tools-news-reviews" id="header-8">IoT</a>
                  </li>
                  <li>
                    <a href="/java-jdk-development-tutorials-tools-news" id="header-1">Java</a>
                  </li>
                  <li>
                    <a href="/microservices-news-tutorials-tools" id="header-6001">Microservices</a>
                  </li>
                  <li>
                    <a href="/open-source-news-tutorials-tools" id="header-7001">Open Source</a>
                  </li>
                  <li>
                    <a href="/apm-tools-performance-monitoring-optimization" id="header-10">Performance</a>
                  </li>
                  <li>
                    <a href="/application-web-network-security" id="header-2001">Security</a>
                  </li>
                  <li>
                    <a href="/web-development-programming-tutorials-tools-news" id="header-11">Web Dev</a>
                  </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<script async src="https://dz2cdn3.dzone.com/themes/dz20/ftl/header/bundle.js"></script><link rel="stylesheet" media="all" href="https://dz2cdn3.dzone.com/themes/dz20/ftl/article/styles.css">




<div id="ftl-article" >
  <div class="container-fluid body">
    <div class="row">
      <div class="col-md-12">
        <div class="articles-wrap">
              <div class="ad-container">
                <div id="div-gpt-ad-1435246566686-0" class="ads-billboard-article" data-gpt-slot="top"></div>
              </div>


          <div class="article-stream widget-top-border">
                <div class="content-right-images">
                  <div id="div-gpt-ad-1435246566686-2" class="sidebar-ad" data-gpt-desktop="true" data-gpt-slot="sidebar1"></div>
                </div>

                <script type="application/ld+json">
                  {
                    "@context": "http://schema.org",
                    "@type": "Article",
                    "headline": "Build a Chat Application Using Spring Boot + WebSocket + RabbitMQ",
                    "author": {
                      "@type": "Person",
                      "name": "Vijay Maniyar"
                    },
                    "audience": "software developers",
                    "keywords": "websocket api,rabbitmq,web dev,spring boot tutorial",
                    "timeRequired": "PT7M",
                    "commentCount": 1,
                    "wordCount": "1698",
                    "accessMode": "textual, visual",
                    "dateCreated": "2019-01-31T15:01:02Z",
                    "datePublished": "2019-01-31T00:00:00Z",
                    "dateModified": "2019-02-13T08:52:49Z",
                    "articleSection": "web-development-programming-tutorials-tools-news",
                    "publisher": {
                      "@type": "Organization",
                      "name": "DZone",
                      "url": "https://dzone.com",
                      "logo": {
                        "@type": "ImageObject",
                        "url": "https://dzone.com/themes/dz20/images/dz_logo_2021_cropped.png"
                      }
                    },
                    "articleBody": "In a previous post, we had created a Spring Boot + WebSocket Hello World Example. In this post, we will be creating a real-time multi-use chat application. In a previous post, we had also seen how to deploy Spring Boot + RabbitMQ applications to Pivotal Cloud Foundry. I have hosted the real-time chat application that we are creating to Pivotal Cloud Foundry and use can see the demo at JavaInUse Chat Application. JavaInUse Chat Application Demo For this tutorial, we will be making use of the STOMP protocol. STOMP is a simple text-oriented messaging protocol used by our UI Client (browser) to connect to enterprise message brokers. Clients can use the SEND or SUBSCRIBE commands to send or subscribe for messages along with a \"destination\" header that describes what the message is about and who should receive it. It defines a protocol for clients and servers to communicate with messaging semantics. It does not define any implementation details, but rather addresses an easy-to-implement wire protocol for messaging integrations. The protocol is broadly similar to HTTP, and works over TCP using the following commands: CONNECT SEND SUBSCRIBE UNSUBSCRIBE BEGIN COMMIT ABORT ACK NACK DISCONNECT When using Spring's STOMP support, the Spring WebSocket application acts as the STOMP broker to clients. Messages are routed to @Controller message-handling methods or to a simple, in-memory broker that keeps track of subscriptions and broadcasts messages to subscribed users. You can also configure Spring to work with a dedicated STOMP broker (e.g. RabbitMQ, ActiveMQ, etc.) for the actual broadcasting of messages. In that case, Spring maintains TCP connections to the broker, relays messages to it, and also passes messages from it down to connected WebSocket clients. Let's begin. Creating the Spring Boot WebSocket Application The project will be structured as follows: Define the pom.xml as follows. Add the spring-boot-starter-websocket and spring-boot-starter-amqpdependency. &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt; &lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.example&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-websocket-chat&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;packaging&gt;jar&lt;/packaging&gt; &lt;name&gt;spring-boot-websocket-chat&lt;/name&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.0.RELEASE&lt;/version&gt; &lt;relativePath /&gt; &lt;!-- lookup parent from repository --&gt; &lt;/parent&gt; &lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-websocket&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-reactor-netty&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/project&gt; Define the domain class WebSocketChatMessage as follows- package com.javainuse.domain; public class WebSocketChatMessage { private String type; private String content; private String sender; public String getType() { return type; } public void setType(String type) { this.type = type; } public String getContent() { return content; } public void setContent(String content) { this.content = content; } public String getSender() { return sender; } public void setSender(String sender) { this.sender = sender; } } Define the WebSocket Configuration class. @Configuration tells us that it is a Spring configuration class. @EnableWebSocketMessageBroker enables WebSocket message handling, backed by a message broker. Here we are using STOMP as a message broker. The method configureMessageBroker() enables a RabbitMQ message broker to carry the messages back to the client on destinations prefixed with \"/topic\" and \"/queue\". Also, here we have configured that all messages with \"/app\" prefix will be routed to @MessageMapping-annotated methods in the controller class. For example \"/app/chat.sendMessage\" is the endpoint that the WebSocketController.sendMessage() method is mapped to handle. package com.javainuse.config; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.context.event.EventListener; import org.springframework.messaging.simp.SimpMessageSendingOperations; import org.springframework.messaging.simp.stomp.StompHeaderAccessor; import org.springframework.stereotype.Component; import org.springframework.web.socket.messaging.SessionConnectedEvent; import org.springframework.web.socket.messaging.SessionDisconnectEvent; import com.javainuse.domain.WebSocketChatMessage; @Component public class WebSocketChatEventListener { @Autowired private SimpMessageSendingOperations messagingTemplate; @EventListener public void handleWebSocketConnectListener(SessionConnectedEvent event) { System.out.println(\"Received a new web socket connection\"); } @EventListener public void handleWebSocketDisconnectListener(SessionDisconnectEvent event) { StompHeaderAccessor headerAccessor = StompHeaderAccessor.wrap(event.getMessage()); String username = (String) headerAccessor.getSessionAttributes().get(\"username\"); if(username != null) { WebSocketChatMessage chatMessage = new WebSocketChatMessage(); chatMessage.setType(\"Leave\"); chatMessage.setSender(username); messagingTemplate.convertAndSend(\"/topic/public\", chatMessage); } } } Define the controller class. Previously we have configured the websocket such that all messages coming from the client with prefix \"/app\" will be routed to the appropriate message handling methods annotated with @MessageMapping. For example, a message with destination /app/chat.newUser will be routed to the newUser() method, and a message with destination /app/chat.sendMessage will be routed to the sendMessage()method. package com.javainuse.controller; import org.springframework.messaging.handler.annotation.MessageMapping; import org.springframework.messaging.handler.annotation.Payload; import org.springframework.messaging.handler.annotation.SendTo; import org.springframework.messaging.simp.SimpMessageHeaderAccessor; import org.springframework.stereotype.Controller; import com.javainuse.domain.WebSocketChatMessage; @Controller public class WebSocketChatController { @MessageMapping(\"/chat.sendMessage\") @SendTo(\"/topic/javainuse\") public WebSocketChatMessage sendMessage(@Payload WebSocketChatMessage webSocketChatMessage) { return webSocketChatMessage; } @MessageMapping(\"/chat.newUser\") @SendTo(\"/topic/javainuse\") public WebSocketChatMessage newUser(@Payload WebSocketChatMessage webSocketChatMessage, SimpMessageHeaderAccessor headerAccessor) { headerAccessor.getSessionAttributes().put(\"username\", webSocketChatMessage.getSender()); return webSocketChatMessage; } } Finally, define the Spring Boot Class with the @SpringBootApplication annotation package com.javainuse; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; @SpringBootApplication public class SpringBootChatApplication { public static void main(String[] args) { SpringApplication.run(SpringBootChatApplication.class , args); } } Define the index.html file. Here we have defined the UI for our chat application. Also, it makes use of the SockJS and stomp libraries. The HTML file contains the user interface for displaying the chat messages. It includes the SockJS and STOMP JavaScript libraries. SockJS is a browser JavaScript library that provides a WebSocket-like object. SockJS gives you a coherent, cross-browser, Javascript API which creates a low latency, full duplex, cross-domain communication channel between the browser and the web server. STOMP.js is the stomp client for JavaScript. &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, minimum-scale=1.0\"&gt; &lt;title&gt;JavaInUse Chat Application | JavaInUse&lt;/title&gt; &lt;link rel=\"stylesheet\" href=\"/css/style.css\" /&gt; &lt;link href=\"//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css\" rel=\"stylesheet\" id=\"bootstrap-css\"&gt; &lt;script src=\"//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js\"&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=\"welcome-page\"&gt; &lt;div class=\"welcome-page-container\"&gt; &lt;h1 class=\"title\"&gt;Welcome - To join the chat group enter your name&lt;/h1&gt; &lt;form id=\"welcomeForm\" name=\"welcomeForm\"&gt; &lt;div class=\"form-group\"&gt; &lt;input type=\"text\" id=\"name\" placeholder=\"name\" class=\"form-control\" /&gt; &lt;/div&gt; &lt;div class=\"form-group\"&gt; &lt;button type=\"submit\" onclass=\"accent username-submit\"&gt;Let's Begin&lt;/button&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;/div&gt; &lt;div id=\"dialogue-page\" class=\"hidden\"&gt; &lt;div class=\"dialogue-container\"&gt; &lt;div class=\"dialogue-header\"&gt; &lt;h2&gt;JavaInUse Chat Application&lt;/h2&gt; &lt;/div&gt; &lt;ul id=\"messageList\"&gt; &lt;/ul&gt; &lt;form id=\"dialogueForm\" name=\"dialogueForm\" nameForm=\"dialogueForm\"&gt; &lt;div class=\"form-group\"&gt; &lt;div class=\"input-group clearfix\"&gt; &lt;input type=\"text\" id=\"chatMessage\" placeholder=\"Enter a message....\" autocomplete=\"off\" class=\"form-control\" /&gt; &lt;button type=\"submit\" class=\"glyphicon glyphicon-share-alt\"&gt;Send&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;/div&gt; &lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.1.4/sockjs.min.js\"&gt;&lt;/script&gt; &lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js\"&gt;&lt;/script&gt; &lt;script src=\"/js/script.js\"&gt;&lt;/script&gt; &lt;/body&gt; &lt;/html&gt; Define the javascript file. The stompClient.subscribe() function takes a callback method which is called whenever a message arrives on the subscribed topic. The connect() function makes use of the SockJS and STOMP client to establish a connection to the to the /websocketApp endpoint that we configured in Spring Boot application. The client subscribes to the /topic/javainuse destination. 'use strict'; document.querySelector('#welcomeForm').addEventListener('submit', connect, true) document.querySelector('#dialogueForm').addEventListener('submit', sendMessage, true) var stompClient = null; var name = null; function connect(event) { name = document.querySelector('#name').value.trim(); if (name) { document.querySelector('#welcome-page').classList.add('hidden'); document.querySelector('#dialogue-page').classList.remove('hidden'); var socket = new SockJS('/websocketApp'); stompClient = Stomp.over(socket); stompClient.connect({}, connectionSuccess); } event.preventDefault(); } function connectionSuccess() { stompClient.subscribe('/topic/javainuse', onMessageReceived); stompClient.send(\"/app/chat.newUser\", {}, JSON.stringify({ sender : name, type : 'newUser' })) } function sendMessage(event) { var messageContent = document.querySelector('#chatMessage').value.trim(); if (messageContent &amp;&amp; stompClient) { var chatMessage = { sender : name, content : document.querySelector('#chatMessage').value, type : 'CHAT' }; stompClient.send(\"/app/chat.sendMessage\", {}, JSON .stringify(chatMessage)); document.querySelector('#chatMessage').value = ''; } event.preventDefault(); } function onMessageReceived(payload) { var message = JSON.parse(payload.body); var messageElement = document.createElement('li'); if (message.type === 'newUser') { messageElement.classList.add('event-data'); message.content = message.sender + 'has joined the chat'; } else if (message.type === 'Leave') { messageElement.classList.add('event-data'); message.content = message.sender + 'has left the chat'; } else { messageElement.classList.add('message-data'); var element = document.createElement('i'); var text = document.createTextNode(message.sender[0]); element.appendChild(text); messageElement.appendChild(element); var usernameElement = document.createElement('span'); var usernameText = document.createTextNode(message.sender); usernameElement.appendChild(usernameText); messageElement.appendChild(usernameElement); } var textElement = document.createElement('p'); var messageText = document.createTextNode(message.content); textElement.appendChild(messageText); messageElement.appendChild(textElement); document.querySelector('#messageList').appendChild(messageElement); document.querySelector('#messageList').scrollTop = document .querySelector('#messageList').scrollHeight; } Define the CSS: { -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; } html, body { height: 100%; overflow: hidden; } body { margin: 0; padding: 0; font-weight: 400; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; font-size: 1rem; line-height: 1.58; color: #333; background-color: #f4f4f4; height: 100%; } .clearfix:after { display: block; content: \"\"; clear: both; } .hidden { display: none; } input { padding-left: 10px; outline: none; } h1, h2, h3, h4, h5, h6 { margin-top: 20px; margin-bottom: 20px; } h1 { font-size: 1.7em; } a { color: #128ff2; } button { box-shadow: none; border: 1px solid transparent; font-size: 14px; outline: none; line-height: 100%; white-space: nowrap; vertical-align: middle; padding: 0.6rem 1rem; border-radius: 2px; transition: all 0.2s ease-in-out; cursor: pointer; min-height: 38px; } button.default { background-color: #e8e8e8; color: #333; box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.12); } button.primary { background-color: #128ff2; box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.12); color: #fff; } button.accent { background-color: #ff4743; box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.12); color: #fff; } #welcome-page { text-align: center; } .welcome-page-container { background-color: grey; width: 100%; max-width: 500px; display: inline-block; margin-top: 42px; vertical-align: middle; position: relative; padding: 35px 55px 35px; min-height: 250px; position: absolute; top: 50%; left: 0; right: 0; margin: 0 auto; margin-top: -160px; } #dialogue-page { position: relative; height: 100%; } .dialogue-container { background-color: green; margin: 10px 0; max-width: 700px; margin-left: auto; margin-right: auto; box-shadow: 0 1px 11px rgba(0, 0, 0, 0.27); margin-top: 30px; height: calc(100% - 60px); max-height: 600px; position: relative; } #dialogue-page ul { list-style-type: none; background-color: #FFF; margin: 0; overflow: auto; overflow-y: scroll; padding: 0 20px 0px 20px; height: calc(100% - 150px); } #dialogue-page #dialogueForm { padding: 20px; } #dialogue-page ul li { line-height: 1.5rem; padding: 10px 20px; margin: 0; border-bottom: 1px solid #f4f4f4; } #dialogue-page ul li p { margin: 0; } #dialogue-page .event-data { width: 100%; text-align: center; clear: both; } #dialogue-page .event-data p { color: #777; font-size: 14px; word-wrap: break-word; } #dialogue-page .message-data { padding-left: 68px; position: relative; } #dialogue-page .message-data i { position: absolute; width: 42px; height: 42px; overflow: hidden; left: 10px; display: inline-block; vertical-align: middle; font-size: 18px; line-height: 42px; color: #fff; text-align: center; border-radius: 50%; font-style: normal; text-transform: uppercase; } #dialogue-page .message-data span { color: #333; font-weight: 600; } #dialogue-page .message-data p { color: #43464b; } #dialogueForm .input-group input { border: 0; padding: 10px; background: whitesmoke; float: left; width: calc(100% - 85px); } #dialogueForm .input-group button { float: left; width: 80px; height: 38px; margin-left: 5px; } .dialogue-header { text-align: center; padding: 15px; border-bottom: 1px solid #ececec; } .dialogue-header h2 { margin: 0; font-weight: 500; } @media screen and (max-width: 730px) { .dialogue-container { margin-left: 10px; margin-right: 10px; margin-top: 10px; } } We are done with the required Java code. Now, let's start RabbitMQ. As we had explained in detail in the Getting started with RabbitMQ and perform the steps to start the RabbitMQ. We will need to perform one additional step with RabbitMQ: install the STOMP plugin for RabbitMQ so that it can work with STOMP Messages Next, start the Spring Boot Chat application by running it as a Java Application. Navigate to the following URL: http://localhost:8080. Enter the username. We are then shown the chat window. If we go to the RabbitMQ console, we can see it has created a queue.",
                    "mainEntityOfPage": {
                      "@type": "WebPage",
                      "@id": "https://dzone.com/articles/build-a-chat-application-using-spring-boot-websock"
                    },
                    "image": {
                      "@type": "ImageObject",
                      "url": "https://dzone.com//dz2cdn1.dzone.com/storage/article-thumb/11182216-thumb.jpg"
                    }
                  }
                </script>

                  <script type="application/ld+json">
                    {
                      "@context": "https://schema.org",
                      "@type": "BreadcrumbList",
                      "itemListElement": [{
                        "@type": "ListItem",
                        "position": 1,
                        "name": "DZone",
                        "item": "https://dzone.com"
                      }, {
                        "@type": "ListItem",
                        "position": 2,
                        "name": "Web Dev Zone",
                        "item": "https://dzone.com/web-development-programming-tutorials-tools-news"
                      }, {
                        "@type": "ListItem",
                        "position": 3,
                        "name": "Build a Chat Application Using Spring Boot + WebSocket + RabbitMQ",
                        "item": "https://dzone.com/articles/build-a-chat-application-using-spring-boot-websock"
                      }]
                    }
                  </script>

            <article>
              <div class="content">
                <div class="header">
                  <div class="col-xs-12 breadcrumb-padding">
                    <a href="/">DZone</a>
                    >
                      <a href="/web-development-programming-tutorials-tools-news">Web Dev Zone</a>
                      >
                      <a href="#">Build a Chat Application Using Spring Boot + WebSocket + RabbitMQ</a>
                  </div>


                  <div class="header-title">
                    <div class="title">
                      <h1 class="article-title">Build a Chat Application Using Spring Boot + WebSocket + RabbitMQ</h1>
                    </div>

                    <div class="subhead">
                      <h3>Learn how to create a web-based chat app by using several interesting technologies across a full-stack application.</h3>
                    </div>

                    <div class="publish-meta">
                        <div class="article-author-meta">
                          <img src="https://secure.gravatar.com/avatar/ef69a941c74b77dd8e812896a42ff5e5?d=identicon&r=PG" class="avatar" alt="Vijay Maniyar user avatar" width="40">
                          by

                          <div class="author-info">
                            <span class="author-name">
                              <a href="/users/3140357/vijay-maniyar.html" rel="nofollow">Vijay Maniyar</a>
                            </span>
                          </div>




                          &middot;
                        </div>
                      <span class="author-date">
                        Jan. 31, 19
                      </span>
                      &middot;
                        <a href="/web-development-programming-tutorials-tools-news" id="portal-name">
                          <span class="portal-name">Web Dev Zone</span>
                        </a>
                      &middot;
                      <span>Tutorial</span>
                    </div>
                  </div>
                </div>

                <div class="author-n-useraction">
                  <div class="like action">
                    <div id="activity-like-icon" class="dz-like icon-thumbs-up">
                      <span class="action-label">
                        <span id="activity-like-text">Like</span>
                      </span>
                      <a href="#">
                        <span id="activity-like-counter">(10)</span>
                      </a>
                    </div>
                  </div>

                  <div class="action">

                    <button class="comment">
                      <i class="icon-comment"></i>
                      Comment
                      <span id="activity-comment-counter" class="comment-count"></span>
                    </button>
                  </div>

                  <div class="save action">
                    <div id="activity-save-icon" class="save icon-star-empty">
                      <span id="activity-save-text" class="action-label">Save</span>
                    </div>
                  </div>

                  <div class="tweet action">
                    <a id="tweet-link" href="" class="title" target="_blank">
                      <span><i class="icon-twitter"></i></span>
                      <span class="action-label">Tweet</span>
                    </a>
                  </div>

                  <div class="pull-right">
                    <div id="activity-view-container" class="article-views action">
                      <i class="icon-eye"></i> 97.79K
                      <span class="action-label">Views</span>
                    </div>
                  </div>
                </div>

                    <div class="signin-prompt">
                      <p>Join the DZone community and get the full member experience.</p>
                      <a id="article-signin-prompt" href="/static/registration.html">Join For Free</a>
                    </div>
                    <div class="arrow-down"></div>

                  <div id="top-bumper-container"></div>

                <div>
                  <div class="content-html"><p pid="2">In a&nbsp;<a href="https://www.javainuse.com/spring/boot-websocket" target="_blank">previous post, we had created a Spring Boot + WebSocket Hello World Example.</a>&nbsp;In this post, we will be creating a real-time multi-use chat application.</p>
<p pid="3">In a&nbsp;<a href="https://www.javainuse.com/pcf/pcf-rabbitmq" target="_blank">previous post, we had also seen how to deploy Spring Boot + RabbitMQ applications to Pivotal Cloud Foundry</a>. I have hosted the real-time chat application that we are creating to Pivotal Cloud Foundry and use can see the demo at JavaInUse Chat Application.</p>
<p pid="4"><a href="https://springbootchat.cfapps.io" target="_blank">JavaInUse Chat Application Demo&nbsp;</a></p>
<h2 pid="5"><img alt="Spring Boot Websocket Chat Application Architecture" class="fr-fin fr-dib" src="https://www.javainuse.com/spring-boot-websocket-chat-architecture.jpg" title="Spring Boot Websocket Chat Application Architecture" /></h2>
<p pid="48">For this tutorial, we will be making use of the STOMP protocol. STOMP is a simple text-oriented messaging protocol used by our UI Client (browser) to connect to enterprise message brokers.</p>
<p pid="7">Clients can use the SEND or SUBSCRIBE commands to send or subscribe for messages along with a &quot;destination&quot; header that describes what the message is about and who should receive it.</p>
<p pid="8">It defines a protocol for clients and servers to communicate with messaging semantics. It does not define any implementation details, but rather addresses an easy-to-implement wire protocol for messaging integrations. The protocol is broadly similar to HTTP, and works over TCP using the following commands:</p>
<ul type="disc">
 <li>CONNECT</li>
 <li>SEND</li>
 <li>SUBSCRIBE</li>
 <li>UNSUBSCRIBE</li>
 <li>BEGIN</li>
 <li>COMMIT</li>
 <li>ABORT</li>
 <li>ACK</li>
 <li>NACK</li>
 <li>DISCONNECT</li>
</ul>
<p pid="10"><img alt="Spring Boot Websocket Chat STOMP Architecture" class="fr-fin fr-dib" src="https://www.javainuse.com/spring-boot-websocket-stomp-architecture.jpg" title="Spring Boot Websocket Chat STOMP Architecture" /></p>
<p pid="61">When using Spring's STOMP support, the Spring WebSocket application acts as the STOMP broker to clients. Messages are routed to @Controller message-handling methods or to a simple, in-memory broker that keeps track of subscriptions and broadcasts messages to subscribed users.</p>
<p pid="12">You can also configure Spring to work with a dedicated STOMP broker (e.g. RabbitMQ, ActiveMQ, etc.) for the actual broadcasting of messages. In that case, Spring maintains TCP connections to the broker, relays messages to it, and also passes messages from it down to connected WebSocket clients.</p>
<p pid="13">Let's begin.</p>
<h2>Creating the Spring Boot WebSocket Application</h2>
<p pid="20">The project will be structured as follows:</p>
<p pid="21"><img alt="Spring Boot Websocket Chat Maven Project" class="fr-fin fr-dib" src="https://www.javainuse.com/spring-boot-websocket-chat-maven-project.jpg" title="Spring Boot Websocket Chat Maven Project" /></p>
<p pid="22">Define the pom.xml as follows. Add the&nbsp;<strong>spring-boot-starter-websocket</strong>&nbsp;and&nbsp;<strong>spring-boot-starter-amqp</strong>dependency.</p>
<pre><code lang="application/xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

&lt;groupId&gt;com.example&lt;/groupId&gt;
&lt;artifactId&gt;spring-boot-websocket-chat&lt;/artifactId&gt;
&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
&lt;packaging&gt;jar&lt;/packaging&gt;

&lt;name&gt;spring-boot-websocket-chat&lt;/name&gt;

&lt;parent&gt;
&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
&lt;version&gt;2.0.0.RELEASE&lt;/version&gt;
&lt;relativePath /&gt; &lt;!-- lookup parent from repository --&gt;
&lt;/parent&gt;

&lt;properties&gt;
&lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
&lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
&lt;java.version&gt;1.8&lt;/java.version&gt;
&lt;/properties&gt;

&lt;dependencies&gt;
&lt;dependency&gt;
&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
&lt;artifactId&gt;spring-boot-starter-websocket&lt;/artifactId&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
&lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
&lt;artifactId&gt;spring-boot-starter-reactor-netty&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;/dependencies&gt;
&lt;/project&gt;</code></pre>
<p pid="24">Define the domain class WebSocketChatMessage as follows-</p>
<pre><code lang="text/x-java">package com.javainuse.domain;

public class WebSocketChatMessage {
private String type;
private String content;
private String sender;

public String getType() {
return type;
}

public void setType(String type) {
this.type = type;
}

public String getContent() {
return content;
}

public void setContent(String content) {
this.content = content;
}

public String getSender() {
return sender;
}

public void setSender(String sender) {
this.sender = sender;
}
}</code></pre>
<p pid="25">Define the WebSocket Configuration class.</p>
<p pid="26"><strong>@Configuration</strong>&nbsp;tells us that it is a Spring configuration class.&nbsp;<strong>@EnableWebSocketMessageBroker</strong>&nbsp;enables WebSocket message handling, backed by a message broker. Here we are using STOMP as a message broker. The method&nbsp;<code>configureMessageBroker()</code>&nbsp;enables a RabbitMQ message broker to carry the messages back to the client on destinations prefixed with &quot;/topic&quot; and &quot;/queue&quot;.</p>
<p pid="27">Also, here we have configured that all messages with &quot;/app&quot; prefix will be routed to @MessageMapping-annotated methods in the controller class.</p>
<p pid="28">For example &quot;/app/chat.sendMessage&quot; is the endpoint that the&nbsp;<code>WebSocketController.sendMessage()</code>&nbsp;method is mapped to handle.&nbsp;</p>
<p pid="81"><br /><img alt="Spring Boot Websocker Flow" class="fr-fin fr-dib" src="https://www.javainuse.com/spring-boot-websocket-chat-flow.jpg" title="Spring Boot Websocker Flow" /></p>
<p pid="82"><br /></p>
<pre><code lang="text/x-java">package com.javainuse.config;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.event.EventListener;
import org.springframework.messaging.simp.SimpMessageSendingOperations;
import org.springframework.messaging.simp.stomp.StompHeaderAccessor;
import org.springframework.stereotype.Component;
import org.springframework.web.socket.messaging.SessionConnectedEvent;
import org.springframework.web.socket.messaging.SessionDisconnectEvent;

import com.javainuse.domain.WebSocketChatMessage;

@Component
public class WebSocketChatEventListener {

    @Autowired
    private SimpMessageSendingOperations messagingTemplate;

    @EventListener
    public void handleWebSocketConnectListener(SessionConnectedEvent event) {
        System.out.println(&quot;Received a new web socket connection&quot;);
    }

    @EventListener
    public void handleWebSocketDisconnectListener(SessionDisconnectEvent event) {
        StompHeaderAccessor headerAccessor = StompHeaderAccessor.wrap(event.getMessage());

        String username = (String) headerAccessor.getSessionAttributes().get(&quot;username&quot;);
        if(username != null) {

            WebSocketChatMessage chatMessage = new WebSocketChatMessage();
            chatMessage.setType(&quot;Leave&quot;);
            chatMessage.setSender(username);

            messagingTemplate.convertAndSend(&quot;/topic/public&quot;, chatMessage);
        }
    }
}</code></pre>
<p pid="31">Define the controller class. Previously we have configured the websocket such that all messages coming from the client with prefix &quot;/app&quot; will be routed to the appropriate message handling methods annotated with @MessageMapping.&nbsp;</p>
<p pid="32">For example, a message with destination /app/chat.newUser will be routed to the <code>newUser()</code><span id="_tmp_pre_3">&nbsp;</span>method, and a message with destination /app/chat.sendMessage will be routed to the&nbsp;<code>sendMessage()</code>method.</p>
<pre><code lang="text/x-java">package com.javainuse.controller;

import org.springframework.messaging.handler.annotation.MessageMapping;
import org.springframework.messaging.handler.annotation.Payload;
import org.springframework.messaging.handler.annotation.SendTo;
import org.springframework.messaging.simp.SimpMessageHeaderAccessor;
import org.springframework.stereotype.Controller;

import com.javainuse.domain.WebSocketChatMessage;

@Controller
public class WebSocketChatController {

@MessageMapping(&quot;/chat.sendMessage&quot;)
@SendTo(&quot;/topic/javainuse&quot;)
public WebSocketChatMessage sendMessage(@Payload WebSocketChatMessage webSocketChatMessage) {
return webSocketChatMessage;
}

@MessageMapping(&quot;/chat.newUser&quot;)
@SendTo(&quot;/topic/javainuse&quot;)
public WebSocketChatMessage newUser(@Payload WebSocketChatMessage webSocketChatMessage,
SimpMessageHeaderAccessor headerAccessor) {
headerAccessor.getSessionAttributes().put(&quot;username&quot;, webSocketChatMessage.getSender());
return webSocketChatMessage;
}
}</code></pre>
<p pid="33">Finally, define the Spring Boot Class with the @SpringBootApplication annotation</p>
<pre><code lang="text/x-java">package com.javainuse;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class SpringBootChatApplication {

	public static void main(String[] args) {
		
		SpringApplication.run(SpringBootChatApplication.class , args);
	}
}</code></pre>
<p pid="34">Define the index.html file. Here we have defined the UI for our chat application. Also, it makes use of the SockJS and stomp libraries. The HTML file contains the user interface for displaying the chat messages. It includes the SockJS and STOMP JavaScript libraries. SockJS is a browser JavaScript library that provides a WebSocket-like object. SockJS gives you a coherent, cross-browser, Javascript API which creates a low latency, full duplex, cross-domain communication channel between the browser and the web server.&nbsp;</p>
<p pid="36">STOMP.js is the stomp client for JavaScript.</p>
<pre><code lang="text/html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
	&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, minimum-scale=1.0&quot;&gt;
	&lt;title&gt;JavaInUse Chat Application | JavaInUse&lt;/title&gt;
	&lt;link rel=&quot;stylesheet&quot; href=&quot;/css/style.css&quot; /&gt;
	&lt;link href=&quot;//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot; id=&quot;bootstrap-css&quot;&gt;
	&lt;script src=&quot;//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;div id=&quot;welcome-page&quot;&gt;
	&lt;div class=&quot;welcome-page-container&quot;&gt;
		&lt;h1 class=&quot;title&quot;&gt;Welcome - To join the chat group enter your name&lt;/h1&gt;
		&lt;form id=&quot;welcomeForm&quot; name=&quot;welcomeForm&quot;&gt;
			&lt;div class=&quot;form-group&quot;&gt;
				&lt;input type=&quot;text&quot; id=&quot;name&quot; placeholder=&quot;name&quot; class=&quot;form-control&quot; /&gt;
			&lt;/div&gt;
			&lt;div class=&quot;form-group&quot;&gt;
				&lt;button type=&quot;submit&quot; onclass=&quot;accent username-submit&quot;&gt;Let's Begin&lt;/button&gt;
			&lt;/div&gt;
		&lt;/form&gt;
	&lt;/div&gt;
&lt;/div&gt;

&lt;div id=&quot;dialogue-page&quot; class=&quot;hidden&quot;&gt;
	&lt;div class=&quot;dialogue-container&quot;&gt;
		&lt;div class=&quot;dialogue-header&quot;&gt;
			&lt;h2&gt;JavaInUse Chat Application&lt;/h2&gt;
		&lt;/div&gt;
		&lt;ul id=&quot;messageList&quot;&gt;

		&lt;/ul&gt;
		&lt;form id=&quot;dialogueForm&quot; name=&quot;dialogueForm&quot; nameForm=&quot;dialogueForm&quot;&gt;
		&lt;div class=&quot;form-group&quot;&gt;
			&lt;div class=&quot;input-group clearfix&quot;&gt;
				&lt;input type=&quot;text&quot; id=&quot;chatMessage&quot; placeholder=&quot;Enter a message....&quot; autocomplete=&quot;off&quot; class=&quot;form-control&quot; /&gt;
				&lt;button type=&quot;submit&quot; class=&quot;glyphicon glyphicon-share-alt&quot;&gt;Send&lt;/button&gt;
			&lt;/div&gt;
		&lt;/div&gt;
	&lt;/form&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.1.4/sockjs.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;/js/script.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<p pid="37">Define the javascript file. The&nbsp;<code>stompClient.subscribe()</code>&nbsp;function takes a callback method which is called whenever a message arrives on the subscribed topic. The&nbsp;<code>connect()</code><span id="_tmp_pre_6">&nbsp;</span>function makes use of the SockJS and STOMP client to establish a connection to the to the /websocketApp endpoint that we configured in Spring Boot application. The client subscribes to the /topic/javainuse destination.</p>
<pre><code lang="text/javascript">'use strict';

document.querySelector('#welcomeForm').addEventListener('submit', connect, true)
document.querySelector('#dialogueForm').addEventListener('submit', sendMessage, true)

var stompClient = null;
var name = null;

function connect(event) {
	name = document.querySelector('#name').value.trim();

	if (name) {
		document.querySelector('#welcome-page').classList.add('hidden');
		document.querySelector('#dialogue-page').classList.remove('hidden');

		var socket = new SockJS('/websocketApp');
		stompClient = Stomp.over(socket);

		stompClient.connect({}, connectionSuccess);
	}
	event.preventDefault();
}

function connectionSuccess() {
	stompClient.subscribe('/topic/javainuse', onMessageReceived);

	stompClient.send(&quot;/app/chat.newUser&quot;, {}, JSON.stringify({
		sender : name,
		type : 'newUser'
	}))	
}

function sendMessage(event) {
	var messageContent = document.querySelector('#chatMessage').value.trim();

	if (messageContent &amp;&amp; stompClient) {
		var chatMessage = {
			sender : name,
			content : document.querySelector('#chatMessage').value,
			type : 'CHAT'
	};

	stompClient.send(&quot;/app/chat.sendMessage&quot;, {}, JSON
	.stringify(chatMessage));
	document.querySelector('#chatMessage').value = '';
	}
event.preventDefault();
}

function onMessageReceived(payload) {
	var message = JSON.parse(payload.body);

	var messageElement = document.createElement('li');

	if (message.type === 'newUser') {
		messageElement.classList.add('event-data');
		message.content = message.sender + 'has joined the chat';
	} else if (message.type === 'Leave') {
		messageElement.classList.add('event-data');
		message.content = message.sender + 'has left the chat';
	} else {
		messageElement.classList.add('message-data');

	var element = document.createElement('i');
	var text = document.createTextNode(message.sender[0]);
	element.appendChild(text);

	messageElement.appendChild(element);

	var usernameElement = document.createElement('span');
	var usernameText = document.createTextNode(message.sender);
	usernameElement.appendChild(usernameText);
	messageElement.appendChild(usernameElement);
	}

	var textElement = document.createElement('p');
	var messageText = document.createTextNode(message.content);
	textElement.appendChild(messageText);

	messageElement.appendChild(textElement);

	document.querySelector('#messageList').appendChild(messageElement);
	document.querySelector('#messageList').scrollTop = document
	.querySelector('#messageList').scrollHeight;
}</code></pre>
<p pid="38">Define the CSS:</p>
<pre><code lang="text/css">{
-webkit-box-sizing: border-box;
-moz-box-sizing: border-box;
box-sizing: border-box;
}

html, body {
	height: 100%;
	overflow: hidden;
}

body {
	margin: 0;
	padding: 0;
	font-weight: 400;
	font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;
	font-size: 1rem;
	line-height: 1.58;
	color: #333;
	background-color: #f4f4f4;
	height: 100%;
}

.clearfix:after {
	display: block;
	content: &quot;&quot;;
	clear: both;
}

.hidden {
	display: none;
}

input {
	padding-left: 10px;
	outline: none;
}

h1, h2, h3, h4, h5, h6 {
	margin-top: 20px;
	margin-bottom: 20px;
}

h1 {
	font-size: 1.7em;
}

a {
	color: #128ff2;
}

button {
	box-shadow: none;
	border: 1px solid transparent;
	font-size: 14px;
	outline: none;
	line-height: 100%;
	white-space: nowrap;
	vertical-align: middle;
	padding: 0.6rem 1rem;
	border-radius: 2px;
	transition: all 0.2s ease-in-out;
	cursor: pointer;
	min-height: 38px;
}

button.default {
	background-color: #e8e8e8;
	color: #333;
	box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.12);
}

button.primary {
	background-color: #128ff2;
	box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.12);
	color: #fff;
}


button.accent {
	background-color: #ff4743;
	box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.12);
	color: #fff;
}

#welcome-page {
	text-align: center;
}

.welcome-page-container {
	background-color: grey;
	width: 100%;
	max-width: 500px;
	display: inline-block;
	margin-top: 42px;
	vertical-align: middle;
	position: relative;
	padding: 35px 55px 35px;
	min-height: 250px;
	position: absolute;
	top: 50%;
	left: 0;
	right: 0;
	margin: 0 auto;
	margin-top: -160px;
}

#dialogue-page {
	position: relative;
	height: 100%;
}

.dialogue-container {
	background-color: green;
	margin: 10px 0;
	max-width: 700px;
	margin-left: auto;
	margin-right: auto;
	box-shadow: 0 1px 11px rgba(0, 0, 0, 0.27);
	margin-top: 30px;
	height: calc(100% - 60px);
	max-height: 600px;
	position: relative;
}

#dialogue-page ul {
	list-style-type: none;
	background-color: #FFF;
	margin: 0;
	overflow: auto;
	overflow-y: scroll;
	padding: 0 20px 0px 20px;
	height: calc(100% - 150px);
}

#dialogue-page #dialogueForm {
	padding: 20px;
}

#dialogue-page ul li {
	line-height: 1.5rem;
	padding: 10px 20px;
	margin: 0;
	border-bottom: 1px solid #f4f4f4;
}

#dialogue-page ul li p {
	margin: 0;
}

#dialogue-page .event-data {
	width: 100%;
	text-align: center;
	clear: both;
}

#dialogue-page .event-data p {
	color: #777;
	font-size: 14px;
	word-wrap: break-word;
}

#dialogue-page .message-data {
padding-left: 68px;
position: relative;
}

#dialogue-page .message-data i {
	position: absolute;
	width: 42px;
	height: 42px;
	overflow: hidden;
	left: 10px;
	display: inline-block;
	vertical-align: middle;
	font-size: 18px;
	line-height: 42px;
	color: #fff;
	text-align: center;
	border-radius: 50%;
	font-style: normal;
	text-transform: uppercase;
}

#dialogue-page .message-data span {
	color: #333;
	font-weight: 600;
}

#dialogue-page .message-data p {
	color: #43464b;
}

#dialogueForm .input-group input {
	border: 0;
	padding: 10px;
	background: whitesmoke;
	float: left;
	width: calc(100% - 85px);
}

#dialogueForm .input-group button {
	float: left;
	width: 80px;
	height: 38px;
	margin-left: 5px;
}

.dialogue-header {
	text-align: center;
	padding: 15px;
	border-bottom: 1px solid #ececec;
}

.dialogue-header h2 {
	margin: 0;
	font-weight: 500;
}

@media screen and (max-width: 730px) {
	.dialogue-container {
	margin-left: 10px;
	margin-right: 10px;
	margin-top: 10px;
	}
}</code></pre>
<p pid="39">We are done with the required Java code. Now, let's start RabbitMQ. As we had explained in detail in the&nbsp;<a href="https://www.javainuse.com/misc/rabbitmq-hello-world" target="_blank">Getting started with RabbitMQ</a>&nbsp;and perform the steps to start the RabbitMQ.</p>
<p pid="40">We will need to perform one additional step with RabbitMQ: install the STOMP plugin for RabbitMQ so that it can work with STOMP Messages&nbsp;</p>
<p pid="41"><img alt="RabbitMQ STOMP Plugin" class="fr-fin fr-dib" src="https://www.javainuse.com/rabbitmq-stomp.jpg" title="RabbitMQ STOMP Plugin" /></p>
<p pid="42">Next, start the Spring Boot Chat application by running it as a Java Application. Navigate to the following URL:&nbsp;<strong>http://localhost:8080</strong>.</p>
<p pid="43"><img alt="Spring Boot Websocker Group" class="fr-fin fr-dib" src="https://www.javainuse.com/spring-boot-websocket-group.jpg" title="Spring Boot Websocket Group" /></p>
<p pid="44">Enter the username.</p>
<p pid="45">We are then shown the chat window.&nbsp;</p>
<p pid="46"><img alt="Spring Boot Chat Join" class="fr-fin fr-dib" src="https://www.javainuse.com/spring-boot-websocket-chat-join.jpg" title="Spring Boot Chat Join" />&nbsp;If we go to the RabbitMQ console, we can see it has created a queue.&nbsp;</p>
<p pid="47"><img alt="Spring Boot Stomp Queue RabbitMQ" class="fr-fin fr-dib" src="https://www.javainuse.com/stomp-queue.jpg" title="Spring Boot Stomp Queue RabbitMQ" /></p></div>
                </div>

                  <div id="bottom-bumper-container"></div>
                  <div class="article-tag-pill-container">
                      <span class="article-tag-pill">Spring Framework</span>
                      <span class="article-tag-pill">Spring Boot</span>
                      <span class="article-tag-pill">application</span>
                      <span class="article-tag-pill">WebSocket</span>
                      <span class="article-tag-pill">Build (game engine)</span>
                  </div>

                  <div class="attribution">
                    <p>Opinions expressed by DZone contributors are their own.</p>
                  </div>

                    <div class="related">
                      <h3>Popular on DZone</h3>
                        <ul>
                            <li class="relateddiv">
                              <a href="/articles/java-why-core-to-core-latency-matters?fromrel=true">Java: Why Core-to-Core Latency Matters</a>
                            </li>
                            <li class="relateddiv">
                              <a href="/articles/autowiring-in-spring?fromrel=true">Autowiring in Spring</a>
                            </li>
                            <li class="relateddiv">
                              <a href="/articles/how-to-generate-fake-test-data?fromrel=true">How to Generate Fake Test Data</a>
                            </li>
                            <li class="relateddiv">
                              <a href="/articles/five-steps-to-strengthen-api-security?fromrel=true">5 Steps to Strengthen API Security</a>
                            </li>
                        </ul>
                      </div>
<div class="comments-overlay"></div>
<div id="comment-box">
  <div class="comment-box-wrapper">
    <div id="comment-input-editor"></div>
  </div>
  <div class="info hidden"></div>
  <div class="comments-content">
    <div class="comment-header">
      <hr />
      <span class="icon-comment">
        <span class="numOfComments"></span> Comments
      </span>
    </div>
    <div class="comments"></div>
  </div>
</div>
            </article>
          </div>

            <div id="above-pr-ad" class="bottom-ad-container">
              <div id="div-gpt-ad-1435246566686-11" data-gpt-slot="bottom"></div>
            </div>
            <div class="layout-card widget-top-border partner-resources-block" style="width:100%; margin-bottom: 1em;">
              <div class="main-container">
                <div class="featured-header">
                  <h2>
                      Web Dev<span> Partner Resources</span>
                  </h2>
                </div>
                <div class="partner-resources-container">
                  <div id="div-gpt-ad-1435246566686-5" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr1"></div>
                  <div id="div-gpt-ad-1435246566686-6" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr2"></div>
                  <div id="div-gpt-ad-1435246566686-7" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr3"></div>
                </div>
              </div>
            </div>
        </div>
      </div>
    </div>
  </div>

    <div id="bsa-parent" class="bottom-sticky-ad-container hide">
      <div class="container">
        <div class="col-md-9">
          <div class="fixed-bottom-div">
            <div class="inline-block">
              <div id="div-gpt-ad-1635294790718-12" data-gpt-desktop="true" class="bottom-sticky-ad"></div>
            </div>
            <div class="inline-block">
              <span id="close" class="bottom-sticky-ad-close-button" onclick="removeBottomStickyAd()">
                X
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>

  <div class="modal fade bd-example-modal-lg" id="modal-message" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header"></div>
        <div class="modal-body"></div>
      </div>
    </div>
  </div>
</div>

<script async>const articleTitle = 'Build a Chat Application Using Spring Boot + WebSocket + RabbitMQ'
const articleUrl = 'https://dzone.com/articles/build-a-chat-application-using-spring-boot-websock'

const retweetLink = document.querySelector('#tweet-link')

function retweet(event) {
    event.preventDefault()
    event.stopPropagation()

    const twitter = 'https://twitter.com/intent/tweet'
    const params = '?text=' + encodeURIComponent(articleTitle) + '&url=' + articleUrl + '&ref=dzone.com&via=DZoneInc'
    const win = window.open(twitter + params, '_blank')
    win.focus()
}

retweetLink.addEventListener('click', retweet);

function showStatusMessage(options) {
  var modal = document.getElementById("modal-message");

  if(modal) {
    modal.classList.add(options.type);
    var modalBody = modal.querySelector(".modal-content .modal-body");
    var modalHeader = modal.querySelector(".modal-content .modal-header");

    modalHeader.innerText = options.header ? options.header : "";
    modalBody.innerText = options.body ? options.body : "" ;

    $(modal).modal("show");

    $(modal).on('hidden.bs.modal', function () {
      modal.classList.remove(options.type);
    });
  }
}

function showConfirmMessage(options) {
  var modal = document.getElementById("modal-message");

  if(modal) {
    modal.classList.add(options.type);
    var modalBody = modal.querySelector(".modal-content .modal-body");
    var modalHeader = modal.querySelector(".modal-content .modal-header");

    modalHeader.innerText = options.header ? options.header : "";
    modalBody.innerText = options.body ? options.body : "" ;

    if (options.textarea) {
      const textareaDiv = document.createElement('div')
      const textareaLabel = document.createElement('label')
      textareaLabel.setAttribute('for', 'modal-textarea')
      textareaLabel.innerText = options.textarea.label

      const textarea = document.createElement('textarea')
      textarea.id = 'modal-textarea'
      textarea.placeholder = (options.textarea.placeholder || '')
      textarea.setAttribute('rows', (options.textarea.rows || 3))
      textarea.classList.add('form-control', 'not-resizable')

      if (options.textarea.maxlength) {
        textarea.maxLength = options.textarea.maxlength
      }

      textareaDiv.appendChild(textareaLabel)
      textareaDiv.appendChild(textarea)
      modalBody.appendChild(textareaDiv)
    }

    var btnContainer = document.createElement("div");
    btnContainer.classList.add("btn-container");

    var noBtn = document.createElement("button");
    noBtn.innerText = options.noBtnText ? options.noBtnText : "No";
    noBtn.classList.add("no-btn");

    var yesBtn = document.createElement("button");
    yesBtn.innerText = options.yesBtnText ? options.yesBtnText : "Yes";
    yesBtn.classList.add("yes-btn");

    btnContainer.appendChild(noBtn);
    btnContainer.appendChild(yesBtn);

    modalBody.appendChild(btnContainer);

    $(modal).modal("show");

    $(noBtn).one("click", function() {
      $(modal).modal("hide");

      if(options.noCallback) {
        $(modal).one('hidden.bs.modal', function () {
          options.noCallback();
        });
      }
    });

    $(yesBtn).one("click", function() {
      $(modal).modal("hide");

      if(options.yesCallback) {
        $(modal).one('hidden.bs.modal', function () {
          options.yesCallback();
        });
      }
    });

    $(modal).on('hidden.bs.modal', function () {
      modal.classList.remove(options.type);
    });
  }
}
</script><link rel="stylesheet" media="all" href="https://dz2cdn3.dzone.com/themes/dz20/ftl/footer/styles.css">

<div id="ftl-footer">
  <div class="container-fluid footerOuter">
    <div class="row">
      <div class="col-md-12">
        <div class="container">
          <div class="row footer">
            <div class="col-md-12 footerWidget">
              <div class="row footerContainer footer">
                <div class="left col-xs-12 col-sm-7">
                  <div class="col-xs-12 social-media-icons footer-mobile">
                    <ul class="icons-only">
                      <li class="rss-icon" id="rss-footer-1">
                        <a href="/pages/feeds" target="_blank" rel="noreferrer noopener">
                          <i class="icon-rss-1"></i>
                        </a>
                      </li>
                      <li class="twitter-icon">
                        <a href="https://twitter.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-twitter"></i>
                        </a>
                      </li>
                      <li class="facebook-icon">
                        <a href="https://www.facebook.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-facebook-1"></i>
                        </a>
                      </li>
                      <li class="linkedin-icon">
                        <a href="https://www.linkedin.com/company/dzone/" target="_blank"
                           rel="noreferrer noopener">
                          <i class="icon-linkedin-1"></i>
                        </a>
                      </li>
                    </ul>
                  </div>

                  <div class="top-section col-xs-12">
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">ABOUT US</p>
                      <ul class="link-group">
                        <li><a href="/pages/about" rel="noreferrer noopener">About DZone</a></li>
                        <li><a href="mailto:support@dzone.com" rel="noreferrer noopener">Send feedback</a></li>
                        <li><a href="https://careers.dzone.com/" target="_blank" rel="noreferrer noopener">Careers</a></li>
                          <li><a href="/sitemap" rel="noreferrer noopener">Sitemap</a></li>
                      </ul>
                    </div>
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">ADVERTISE</p>
                      <ul class="link-group">
                        <li><a href="https://advertise.dzone.com" target="_blank" rel="noreferrer noopener">Advertise with DZone</a></li>
                      </ul>
                    </div>
                  </div>

                  <div class="bottom-section col-xs-12">
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">CONTRIBUTE ON DZONE</p>
                      <ul class="bottom-top-list link-group">
                        <li><a href="/articles/dzones-article-submission-guidelines">Article Submission Guidelines</a></li>
                        <li><a href="/pages/mvb" rel="noreferrer noopener">MVB Program</a></li>
                        <li><a href="/pages/contribute" rel="noreferrer noopener">Become a Contributor</a></li>
                        <li><a href="/writers-zone" rel="noreferrer noopener">Visit the Writers' Zone</a></li>
                      </ul>

                      <p class="section-header">LEGAL</p>
                      <ul class="link-group">
                        <li><a href="/pages/tos" rel="noreferrer noopener">Terms of Service</a></li>
                        <li><a href="/pages/privacy" rel="noreferrer noopener">Privacy Policy</a></li>
                      </ul>
                    </div>
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">CONTACT US</p>
                      <ul class="link-group">
                        <li>600 Park Offices Drive</li>
                        <li>Suite 300</li>
                        <li>Durham, NC 27709</li>
                        <li><a href="mailto:support@dzone.com" rel="noreferrer noopener">support@dzone.com</a></li>
                        <li><a href="tel:+19196780300" rel="noreferrer noopener">+1 (919) 678-0300</a></li>
                      </ul>
                    </div>
                  </div>
                </div>

                <div class="right col-xs-12 col-sm-5">

                  <p class="connect-text">Let's be friends:</p>
                  <div class="col-xs-12 social-media-icons footer-wide">
                    <ul class="icons-only">
                      <li class="rss-icon" id="rss-footer-1">
                        <a href="/pages/feeds" target="_blank" rel="noreferrer noopener">
                          <i class="icon-rss-1"></i>
                        </a>
                      </li>
                      <li class="twitter-icon">
                        <a href="https://twitter.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-twitter"></i>
                        </a>
                      </li>
                      <li class="facebook-icon">
                        <a href="https://www.facebook.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-facebook-1"></i>
                        </a>
                      </li>
                      <li class="linkedin-icon">
                        <a href="https://www.linkedin.com/company/dzone/" target="_blank"
                           rel="noreferrer noopener">
                          <i class="icon-linkedin-1"></i>
                        </a>
                      </li>
                    </ul>
                  </div>

                  <div class="col-xs-12 powered-by">
                    <p>DZone.com is powered by&nbsp;</p>
                    <a href="https://devada.com/answerhub/" rel="noreferrer noopener">
                      <img src=""
                           data-src="https://dz2cdn3.dzone.com/themes/dz20/images/answerhub_logo_white_footer.png"
                           width="150"
                           height="56"
                           class="lazyload"
                           alt="AnswerHub logo">
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
  <script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>

  <script async>
      (function(w, d, s, l, i) {
          w[l] = w[l] || [];
          w[l].push({'gtm.start': new Date().getTime(), event: 'gtm.js'});
          var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
          j.async = true;
          j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
          f.parentNode.insertBefore(j,f);
      })(window, document, 'script', 'dataLayer', 'GTM-K25QL22');
  </script>

  <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-410289-1', 'auto');
      ga('require', 'linkid', 'linkid.js');
      ga('require', 'GTM-TSD9TZP');
      ga('set', 'siteSpeedSampleRate', 25);
  </script>
  <script async src="https://www.google-analytics.com/analytics.js"></script>
  <script async>const analytics = {
    'dimension1': 'webdev',
    'dimension2': 'article/tutorial',
    'dimension3': '2019-01-31',
    'dimension4': '0',
    'dimension5': '',
    'dimension7': 'Spring Framework, spring boot, application, WebSocket, build',
    'dimension8': 'vijay_maniyar',
    'dimension9': 'undefined',
    'dimension10': 'Cognizant'
}

if (window.ga) {
    Object.keys(analytics).forEach(function(key) {
        window.ga('set', key, analytics[key])
    })

    window.ga('send', 'pageview')
}</script>

  <script>
      !function (e, o, n, i) {
          if (!e) {
              e = e || {}, window.permutive = e, e.q = [];
              var t = function () {
                  return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, function (e) {
                      return (e ^ (window.crypto || window.msCrypto).getRandomValues(new Uint8Array(1))[0] & 15 >> e / 4).toString(16)
                  })
              };
              e.config = i || {}, e.config.apiKey = o, e.config.workspaceId = n, e.config.environment = e.config.environment || "production", (window.crypto || window.msCrypto) && (e.config.viewId = t());
              for (var g = ["addon", "identify", "track", "trigger", "query", "segment", "segments", "ready", "on", "once", "user", "consent"], r = 0; r < g.length; r++) {
                  var w = g[r];
                  e[w] = function (o) {
                      return function () {
                          var n = Array.prototype.slice.call(arguments, 0);
                          e.q.push({
                              functionName: o,
                              arguments: n
                          })
                      }
                  }(w)
              }
          }
      }(window.permutive, "bca90777-e088-4f2a-96c2-13ad18deeccc", "18ad0c5b-460c-4d19-a729-dc537805538f", {});
      window.googletag = window.googletag || {}, window.googletag.cmd = window.googletag.cmd || [], window.googletag.cmd.push(function () {
          if (0 === window.googletag.pubads().getTargeting("permutive").length) {
              var e = window.localStorage.getItem("_pdfps");
              window.googletag.pubads().setTargeting("permutive", e ? JSON.parse(e) : []);
              var o = window.localStorage.getItem("permutive-id");
              o && (window.googletag.pubads().setTargeting("puid", o), window.googletag.pubads().setTargeting("ptime", Date.now().toString())), window.permutive.config.viewId && window.googletag.pubads().setTargeting("prmtvvid", window.permutive.config.viewId), window.permutive.config.workspaceId && window.googletag.pubads().setTargeting("prmtvwid", window.permutive.config.workspaceId)
          }
      });


      permutive.addon('web', {
          'page': {
              'category': 'Web Dev',
              'node': {
                  'authorCompany': 'Cognizant',
                  'authors': [3140357, ],
                  'publishDate': new Date(1548892800000),
                  'sponsorAuthor': false,
                  'tags': ['Spring Framework', 'spring boot', 'application', 'WebSocket', 'build', ],
                  'title': 'Build a Chat Application Using Spring Boot + WebSocket + RabbitMQ',
                  'type': 'article',
              },
              'section': 'article',
          }
      });
  </script>
  <script async src="https://18ad0c5b-460c-4d19-a729-dc537805538f.edge.permutive.app/18ad0c5b-460c-4d19-a729-dc537805538f-web.js"></script>

  <script>
      const csrf = '7107132164099723329'
      const articleId = 2715028
      const likes = 10
      const assetDomain = 'https://dz2cdn3.dzone.com'
      const codemirrorVars = {
          modeURI: 'https://dz2cdn3.dzone.com/themes/dz20/lib/codemirror/mode/',
          requiredScripts: [
              'https://dz2cdn3.dzone.com/themes/dz20/lib/codemirror/lib/codemirror.js',
              'https://dz2cdn3.dzone.com/themes/dz20/lib/codemirror/mode/meta.js'
          ]
      }

      const gptTags = {
          'zone': 'web_dev',
          'topicTag': 'Spring Framework,spring boot,application,WebSocket,build',
          'company': '',
          'siteSection': 'Zones',
          'articleCategory': 'tutorial',
          'nodeID': '2715028',
          'authorID': '3140357',
          'publishYear': '2019',
          'publishMonth': '01',
          'jobRole': '',
          'companySize': ''
      }

      const minCommentChar = 10;
      const peer39Enabled = true;
  </script>

  <script src="https://dz2cdn3.dzone.com/themes/dz20/lib/static/jquery/jquery.min.js"></script>
  <script async src="https://dz2cdn3.dzone.com/themes/dz20/lib/static/bootstrap/bootstrap.min.js"></script>
  <script async src="https://dz2cdn3.dzone.com/themes/dz20/ftl/article/ads.js"></script>



  <script>
      function loadScript(src) {
          return new Promise(function (resolve, reject) {
              const s = document.createElement('script')
              s.src = src
              s.onload = resolve
              s.onerror = reject
              document.head.appendChild(s)
          })
      }

      function loadStyle(href) {
          const link = document.createElement('link')
          link.rel = 'stylesheet'
          link.href = href
          document.head.appendChild(link)
      }

      function loadScriptsSync(deferred) {
          var p = Promise.resolve()
          for (var i = 0; i < deferred.length; i++) {
              let script = deferred[i]
              p = p.then(function() {
                  return loadScript(script)
              })
          }
          return p
      }

      function loadStyles() {
          const deferred = [
              'https://dz2cdn3.dzone.com/themes/dz20/lib/codemirror/lib/codemirror.css',
              'https://dz2cdn3.dzone.com/themes/dz20/ftl/comments/styles.css',
              'https://dz2cdn3.dzone.com/themes/dz20/lib/froala3/css/froala_editor.pkgd.min.css',
              'https://dz2cdn3.dzone.com/themes/dz20/lib/froala3/css/themes/gray.min.css',
              'https://dz2cdn3.dzone.com/themes/dz20/ftl/article/mini-profile.css'
          ]

          for (var i = 0; i < deferred.length; i++) {
              loadStyle(deferred[i])
          }
      }

      window.addEventListener('load', function(event) {
          loadStyles()
          loadScriptsSync([
              'https://dz2cdn3.dzone.com/themes/dz20/ftl/header/auth-status.js',
              'https://dz2cdn3.dzone.com/themes/dz20/lib/lazysizes.min.js',
              'https://dz2cdn3.dzone.com/themes/dz20/ftl/article/codeblocks.js',
              'https://dz2cdn3.dzone.com/themes/dz20/ftl/article/activity-bar.js',
              'https://dz2cdn3.dzone.com/themes/dz20/lib/froala3/js/froala_editor.pkgd.min.js',
              'https://dz2cdn3.dzone.com/themes/dz20/ftl/froala/content.js',
              'https://dz2cdn3.dzone.com/themes/dz20/ftl/comments/content.js',
              'https://dz2cdn3.dzone.com/themes/dz20/ftl/article/content.js'
          ])
      })
  </script>
</body>
</html>