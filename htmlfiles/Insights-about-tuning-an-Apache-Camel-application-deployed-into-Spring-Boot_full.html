<!DOCTYPE html>
<!--[if IE 8]><html lang="en" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
  <head>
    <!--[if IE]><![endif]-->
<script id="trustarc" type="text/javascript" src="https://static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>
<script id="ddo" type="text/javascript">
<!--//--><![CDATA[//><!--
    var digitalData = {"cart":[],"event":[],"listing":{"browseFilter":"","query":"","queryMethod":"","refinementType":"","refinementValue":"","resultCount":"","searchType":""},"page":{"attributes":{"queryParameters":"","referringSearchEngine":"","analyticsTitle":"blog | insights about tuning an apache camel application deployed into spring boot","taxonomyBlogPostCategory":["85"],"taxonomyBlogSource":["69881"]},"category":{"contentType":"","keyPage":"false","keyPageType":"","pageType":"blog_post","primaryCategory":"blog","subCategories":["insights-about-tuning-apache-camel-application-deployed-spring-boot"]},"pageInfo":{"cms":"RH CMS 2022.7.0","contentFindingMethod":"","contentID":"468001","contentPortal":"","destinationURL":"https:\/\/www.redhat.com\/en\/blog\/insights-about-tuning-apache-camel-application-deployed-spring-boot","errorMessage":"","errorType":"","language":"en","pageName":"","referringDomain":"","referringURL":"","sysEnv":"","template":"","title":"Insights about tuning an Apache Camel application deployed into Spring Boot"}},"product":[],"user":[{"profile":[{"profileInfo":{"daysSinceLastPurchase":"","demandbaseSID":"","eloquaGUID":"","lastLoginDate":"","lastPurchaseDate":"","loggedIn":"false","profileID":"","subscriptionFrequency":"","subscriptionLevel":""}}]}]};
    !function(a,b,c){"use strict";function d(a){var c="; "+b.cookie,d=c.split("; "+a+"=");if(2===d.length)return d.pop().split(";").shift()}if(b.referrer){var e=b.createElement("a");e.href=b.referrer,c.page.pageInfo.referringDomain=e.hostname,c.page.pageInfo.referringURL=e.href}c.page.pageInfo.sysEnv=a.innerWidth<=768?"tablet":"desktop";var f=c.user[0].profile[0].profileInfo,g=d("rh_elqCustomerGUID");g&&(f.eloquaGUID=g);var h=d("rh_user");if(h){var i=h.split("\\|");i[0]&&(f.loggedIn="true")}var j=d("s_dmdbase");j&&(f.demandbaseSID=j)}(window,document,digitalData);
//--><!]]>
</script>
<meta name="post_authors" content="Ricardo Zanini Fernandes" />
<meta name="post_author_links" content="https://www.redhat.com/en/authors/ricardo-zanini-fernandes" />
<script src="https://static.redhat.com/libs/redhat/marketing/latest/trustarc/trustecm/js/trustecm.js" data-domain="www.redhat.com"></script><script data-src="https://static.redhat.com/libs/redhat/marketing/latest/trustarc/trustecm/js/trustecm-functional.js" class="trustecm" data-tracker-type="functional"></script><script data-src="https://static.redhat.com/libs/redhat/marketing/latest/trustarc/trustecm/js/trustecm-advertising.js" class="trustecm" data-tracker-type="advertising"></script><script id="dpal" type="text/javascript" src="//www.redhat.com/dtm.js"></script><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="content-language" content="en" />
<link href="https://www.redhat.com/en/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot" rel="alternate" hreflang="en" />
<meta name="post_date" content="2018-10-15T13:04:46-04:00" />
<script type="application/ld+json">{
    "@context": "https://schema.org",
    "availableLanguages": {
        "zh": {
            "@type": "Language",
            "name": "简体中文",
            "href": "/zh/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot"
        },
        "en": {
            "@type": "Language",
            "name": "English",
            "href": "/en/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot",
            "current_lang": true
        },
        "fr": {
            "@type": "Language",
            "name": "Français",
            "href": "/fr/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot"
        },
        "de": {
            "@type": "Language",
            "name": "Deutsch",
            "href": "/de/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot"
        },
        "it": {
            "@type": "Language",
            "name": "Italiano",
            "href": "/it/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot"
        },
        "ja": {
            "@type": "Language",
            "name": "日本語",
            "href": "/ja/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot"
        },
        "ko": {
            "@type": "Language",
            "name": "한국어",
            "href": "/ko/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot"
        },
        "pt-br": {
            "@type": "Language",
            "name": "Português",
            "href": "/pt-br/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot"
        },
        "es": {
            "@type": "Language",
            "name": "Español",
            "href": "/es/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot"
        }
    }
}</script><link rel="prefetch" href="/en/redhat_www_menu/ajax/menus-nav2" />
<meta name="last-publish-date" content="Thu, 27 Aug 2020 19:38:55 GMT" />
<meta name="node-type" content="blog_post" />
<meta name="resources_filter" content="Blogs" />
<meta name="source" content="rhdc_drupal" />
<meta name="rhdc_key" content="138688baf854fc78827a2a234b0fdb01" />
<meta name="taxonomy-blog-post-category" content="Middleware;url=https://www.redhat.com/en/blog/tag/middleware" />
<meta name="taxonomy-blog-post-category-tid" content="85" />
<meta name="taxonomy-blog-source" content="Middleware" />
<meta name="taxonomy-blog-source-tid" content="69881" />
<meta name="hybrid_type" content="Blog" />
<link type="application/rss+xml" title="Red Hat Blog" rel="alternate" href="/rss/blog/" />
<meta name="post_image_stream" content="" />
<meta name="hide_post_from_listing" content="no" />
<link rel="shortcut icon" href="https://www.redhat.com/misc/favicon.ico" type="image/x-icon" />
<meta property="og:description" content="IntroductionTuning is a very interesting topic in the field of Software Engineering. Everybody can agree that it’s important but I have  rarely seen people actually doing it. This can be especially true when people have spare computational resources to spend, or if they are following these mantras: “the load won’t reach at this point” or “let the cloud scale it.”The goal of this post is to share some insights regarding tuning an Apache Camel application deployed into Spring Boot. This is not an ultimate guide for tuning and performance tests in Spring Boot applications, but more of an experience sharing during a tuning process.When talking about tuning and performance tests, one thing that needs to be clear is the requirements, or what do you want to achieve by tuning an application. For example, one could say that with the computational resources they have, they aim for a 10% increase of requests the application can handle.We created a fictional scenario to make things easier and to define a requirement where we can apply the proposed tuning configurations. Also, for you to be able to replicate the topics discussed in this post, there is a demonstration lab available at Github. This lab has what you should need to create the environment and run the load tests while exploring the configuration changes addressed in the following sections.The ScenarioThings get clearer when we demonstrate by example, so let’s use a fictional scenario to do so.A customer is asking to improve the number of transactions per second (TPS) that their REST Apache Camel application deployed into Spring Boot can handle. The requirements are very strict:Can’t increase memory, CPU or disksThe architecture must remain intactCan’t change application source codeThe following figure illustrates the scenario architecture:]In this use case, the Apache HTTPD Web Server acts as a proxy server, load balancer and also offers TLS support for application servers. The Web Server is proxying requests to a REST application based on Apache Camel and Spring Boot with an embedded Tomcat. This architecture is always used by the customer when implementing REST services that are being integrated with external web services and third party applications.In this scenario, requests are treated by the proxy server through an encrypted connection and then passed to the underlying Spring Boot application. The application connects to an external service, transforms or composes the received data and then returns a response to the client.Every component of this architecture is compressed inside a virtual machine with 512MB of RAM and 2 vCPUs. The resources are sparse to emulate a possible real world scenario, where a  potential customer is asking for performance improvements in this environment, without having to invest in hardware resources nor modifying the architecture or the application source code.With such narrow requirements, where would you start? Let’s begin our tuning plan using a very old war strategy: dīvide et imperā (divide and conquer).Let’s navigate by each component in the architecture and explore what was done in this scenario to tune the environment. Each configuration change proposed is documented in a demonstration lab that could be replicated in other environments. In the next sections, we’re going to discuss each decision based on this example scenario.Apache HTTPD Web ServerThe Apache HTTPD Web Server plays an important role in the architecture by implementing connection encryption and proxying requests to underlying JVM processes.When installed in a Linux machine, the HTTPD web server comes with default values that could fit most use case scenarios, but when the workload starts to increase, you might face performance problems like proxy timeout errors, low throughout, and high machine resources usage.Here we’ll work with Apache 2.4, since it’s the current version and includes several bug and security fixes. The links, docs, and codes here will be related to Apache HTTPD 2.4.Switching the MPMThe first thing that was done was choosing the right Multi-Processing Module (MPM) for our use case scenario. By default, the MPM configured in HTTPD is prefork, which fits for use cases that need compatibility with libraries that are non-thread safe, like some old PHP libraries.In this case, we are going to change to the worker MPM that is much more performatic and suitable for our scenario, since we don’t need HTTPD to load any non-thread safe library nor serve dynamic scripts. The worker MPM implements a multi-process multi-threaded server, and according to the worker documentation, by using threads to serve requests, it is able to serve a large number of requests with fewer system resources than a process-based server.It’s worth noting that the worker MPM might be better than prefork in other scenarios as well, as long as you don’t need compatibility with non-thread safe libraries.Another approach that could be used was the event MPM, but because of a bug in the HTTPD version we were working with at the time of this article, we decided to stick with worker.Setting the connection parametersOnce the worker MPM is configured, the next thing that to do is define a consistent number for the MaxRequestWorkers parameter. In general, we use 300 times the number of CPU cores for worker MPM, but of course a lot of fine-tuning and experimentation have to be done. Don’t blindly set this parameter without properly testing.If we just followed the general advice of 300 * CPU cores, the max number of connections that the HTTPD server would serve in our architecture is 600 (we have 2 vCPUs for each machine). But is this number realistic?In our scenario, the HTTPD server and the Tomcat server are in the same machine, so they are competing for resources. The HTTPD server  should serve more requests than the Tomcat because it’s acting simply as a proxy server, while the Tomcat server is the one who is performing all the heavy work by processing our integration services.Having said that, the proxy server should act like a gatekeeper to help avoid processing more requests than the underlying application server can handle. To came up with an ideal number, a lot of experimentation with load tests have to be done at the application server to figure out how many concurrent requests it can handle. After that, set a number below this one to the HTTPD. This is the final configuration I came up with: ThreadLimit 30 ServerLimit 10 StartServers 3 MinSpareThreads 5 MaxSpareThreads 20 MaxRequestWorkers 300 ThreadsPerChild 30 MaxRequestsPerChild 0 Timeout 30 ProxyTimeout 30Taking into account the machine resources that we had, in our scenario the maximum number of requests that Tomcat handled without errors, while leaving some room for the other processes in the machine, was 400. So we set the max connections to 300 in the proxy server, which proved to be a fine configuration for this scenario. This way, the workload on Tomcat won’t reach the maximum, preserving its healthy state in most situations. Also, 300 simultaneous connections was enough to address the customer’s requirements.Other important parameters to pay attention to are Timeout and ProxyTimeout. Those numbers should be set equally to the underlying Tomcat server, so if the application times out, the error propagates to the client. Otherwise, you could have connections opened at the proxy server, spending valuable machine resources.Changing Proxy Pass connector to AJPThe last tuning configuration that was set in this scenario is the AJP connection to the Tomcat server. A basic proxy pass configuration is to bypass requests to the underlying server using the HTTP protocol. Instead, we used the AJP protocol, which is a binary protocol representation of the HTTP protocol that also skips HTTP header re-processing by the underlying server. This way we save a little bit of processing power. The final configuration looked like: ProxyPass ajp://localhost:8009Final thoughtsThese are the tuned configuration done so far at the HTTP server side:Switched the MPM from prefork to workerAdjusted the max connections that the proxy server can handle to preserve machine resources and also protect the application server from a workload that it can’t handleSet a proper timeout configuration aligned with the Tomcat serverChanged the proxy pass protocol from HTTP to AJPOf course, there are a lot of other things that could be done. There are other guides on the internet describing how to tune an Apache HTTPD server, but for this scenario and use case, we found that these configurations were enough to accomplish our customer requirements.Embedded TomcatThe role of the Tomcat Server in this architecture is to serve as a servlet container to the Apache Camel REST component. This implementation is managed by the Spring Boot Web as an embedded server. There are other servlet implementations to work with Spring Boot and Apache Camel like Undertow and Jetty that might perform better, but the requirements of the customer were not to change any piece of their architecture.Having said that, what can be done at the configuration level to have the Apache Tomcat Server perform better?Adjusting the connection parametersFirst of all, like we said in the Apache HTTPD section, the Tomcat server was tested alone to figure out how many requests it could handle in the most common use cases.For this task you could use the Pareto distribution to have a sample amount of requests to test the application. For example, using an API which reads, creates, and deletes customers, the read and create operation could be the most common use case. You can create a small set of sample requests and start putting some workload on your server. JMeter is a reasonable tool to do that, and we used this tool in our lab.Having come up with the max concurrent requests that the application could handle during a certain period of time without breaking, we adjusted the server parameters like this:ParameterValueDescriptionConnection Timeout (ms)30000This value is aligned with the Apache HTTPD proxy server timeout and has shown to be a reasonable number for our scenario.CompressionFalseWe are serving only small JSON payloads, and in our tests the compression didn’t make any noticeable difference. Besides, this can be set only at the proxy server level.Max Connections400A little more than the max connections at the proxy server side, so we had room to handle extra connections that could come between requests.Max Threads300This number seems reasonable for our resources and number of connections to handle. Each thread can handle more than one connection.Min Spare Threads300There’s no warm up for this server, which means that during high load there is no need to create more threads reaching the max to handle all the requests. But during idle or low workloads, these threads are up, although doing nothing. In our scenario, there wasn’t too much idle time that would justify decreasing this number.Accept Count100The number of connections waiting to be handled. If we reach the max connection number, the server starts to stack requests in this queue before denying a reply to the client. Of course, a lot of experimentation and load tests had been done. These numbers are for reference only and are the ones set in our lab. These numbers can be completely different depending on your requirements. Just keep in mind the responsibility of evaluating each parameter and determining what you can do to improve the performance of your server by fine-tuning each one. Take a look at the documentation to understand the parameters that can be configured in the Tomcat connectors.Using Tomcat Native ConnectorsThe next adjustment made on the Tomcat server was to use the native connectors to handle the connections coming up from the proxy server. Quoting from the official documentation:“The Apache Tomcat Native Library is an optional component for use with Apache Tomcat that allows Tomcat to use certain native resources for performance, compatibility, etc.”The decision to use the native libraries was guided by the performance improvements this can offer versus the standard Java libraries like BIO or NIO, leveraging from the OS capabilities to handle I/O operations.For this to work we had to install the APR library on our server, employ the native connectors, and create a custom embedded Tomcat server constructor on the Spring Boot side. The custom constructor was also used to set the configuration listed in the table above, because not all the Tomcat configurations can be set using the default application properties from the Spring Boot Tomcat embedded server.@Beanpublic EmbeddedServletContainerFactory servletContainer() { TomcatEmbeddedServletContainerFactory tomcat = new TomcatEmbeddedServletContainerFactory(); tomcat.addConnectorCustomizers(this.customizer(tomcat)); if (ajpPort != null) { Connector ajpConnector = new Connector(PROTOCOL); if (enableApr) { tomcat.addContextLifecycleListeners(new AprLifecycleListener()); ajpConnector = new Connector(&quot;org.apache.coyote.ajp.AjpAprProtocol&quot;); } ajpConnector.setPort(ajpPort); tomcat.addAdditionalTomcatConnectors(ajpConnector); } return tomcat;}Final thoughtsThe customizations made on the Tomcat side to tune our environment were:Set the max connections and timeout values to align with the Apache HTTPD web server and prevent excessive load on the Tomcat server.Installed APR and used the native AJP connector for I/O performance improvements.Customized the default Spring Boot embedded Tomcat constructor to set the properties not externalized by the Spring Boot properties component.Tweaked the connection and thread parameters to establish numbers that performed well during our load tests.Besides the requirement from our customer to not change the source code, this custom embedded Tomcat can be placed in the actual embedded server dependency of a project. Alternately, we can go further and create a patch, since the Spring Boot project limits our ability to change the default connector.There isn’t much to do at the Tomcat side besides experimentation. The main focus should be with the application that is using its servlet capabilities. A common scenario is a bad performatic application taking too long to return a reply, resulting in a bad experience for the client. But we can leverage several Tomcat parameters and connector implementations to improve the way that the server handles connections.Apache Camel and Spring BootWe finally arrive at the application layer after tweaking several knobs on the proxy and servlet server.Tuning the GC algorithmThe Spring Boot component ties the embedded Tomcat server and the Apache Camel routes and components together. All of these components run on the same Java Virtual Machine (JVM) process, so we decided to start by tuning the JVM Garbage Collector (GC) algorithm.Garbage Collector tuning deserves an entire article dedicated to it. As with the Apache HTTPD server tuning, there’s other articles on the internet talking about this subject. If you’re interested in a deep dive into it, give it a try using Oracle’s JVM Tuning documentation. This documentation doesn’t cover any particular use cases, but it provides good explanations of the structure of each algorithm.If not set, the JVM tries to tune the GC by itself in a process called ergonomics. This could work in environments with a small load, but in our scenario, we decided to take control of our GC algorithm and experiment with it. In the end, the G1 was the chosen one. The decision was based on the following criteria:It’s the algorithm that performed better at our tests, taking into account our scenario, resources and architecture.It’s optimized to maximize the throughput with small pauses during the application life cycle, favoring REST applications that have high-throughput requirements.If you have little or no knowledge about GC tuning, a starting point could be Red Hat’s JVM configuration Lab (subscription required). The Lab gives you some options to configure your GC that can lead you into fine-tuning once an algorithm is chosen.Some aspects of the GC that you should take care of:Too many “full GCs” during application load. To perform a full GC, the GC starts an event called “stop the world” that is a pause in every running thread to free up memory. During those pauses, nothing is processed at the JVM, which might increase the application response time.Long pauses. Even if the GC are not performing too many “stop the world” events, it’s important to take a look into the pause times. Depending on your requirements, pauses of 1 second or more could impact your application. There are configurations to try to control such behavior.A good tool to analyse the GC is Garbagecat or the gceasy website. The last one can give you a high level GC analysis based on your logs and could be a good starting point to understand the behavior of your GC.Besides the GC algorithm chosen, there are two configurations that you should always set in any JVM configuration:GC logs output: to examine your GC behavior during the application load, you must enable the GC logs. You should not  worry since you shouldn’t lose any performance and the logs will come in handy during troubleshooting.Heap dump on out of memory error: this is a must if you’re running into memory problems. The heap dump is a valuable artifact for memory leak troubleshooting or memory usage analysis. Just add the following option to your JVM configuration: -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=. To analyze the heap generated by the JVM, you could use the Eclipse Memory Analyzer Tool (MAT).Switching to a async log appenderIn this particular scenario we observed that the application had heavy audit log requirements. In our scenario, the application logged every input and output message for auditing and monitoring purposes. In a high load environment this could lead to a high disk usage during the current execution thread.The default implementation of popular logs frameworks in Java is the synchronous log, that is, every time the application needs to log something in the disk, the current execution thread is responsible for writing the log content to the disk.To avoid interfering in the current execution thread while writing to the disk, we switched the log appender to an asynchronous one. The log implementation is Logback, which has an interesting async feature that can minimize the risk of losing logs. We ended up with the following configuration:    0   500Setting the option “discardingThreshold” to zero, the appender won’t discard any log events even if the queue is full, but the blocking queue will stop until everything is written. Some experimentation is needed to adjust queue size with the expected load. Ideally, this queue does not reach its limit.Final thoughtsFinally, in the end we came up with the following conclusions:JVM tuning and experimentation: we decided to go with with G1 algorithm due to its throughput maximization nature.GC logs were turned on to capture data to be analyzed later, giving us valuable information used to configure the GC algorithm.Turned the log appenders to async due to the high audit log usage by the Apache Camel routes.The Spring Boot Apache Camel Java application was the last part of our scenario’s architecture to be reviewed.The Replication LabEach tuning aspect discussed up to this point in our example scenario can be explored using a demonstration lab available at our repository in Github.This lab replicates  tools and machines used during our experience of tuning this architecture. The lab was created to support this article and to serve as a sandbox for anyone who wants to experiment with this scenario and compare each aspect of tuning. The figure below illustrates the components provided by this lab:]The lab is composed of a Vagrant file, ansible playbooks and a demo Spring Boot Apache Camel application. With Vagrant you can set up a virtual environment in an operating system. Ansible also plays an important role since we used it to:Install the required software: the HTTPD Server, Java, Python 3 and PCP (Performance Co-Pilot).Deploy the application and the mock external service: the Spring Boot application is installed as a systemd service with its configuration set in the startup scripts. Ansible also runs a script to provide a Python 3 web service for mocking external calls from the Apache Camel routes.Open the required ports for PCP and JMX monitoring.Apply the tuned configurations on every component of the architecture: HTTPD and Spring Boot configuration, APR and Tomcat native connectors.For more detailed information about how Ansible was used in this lab, take a look at the playbooks.To be able to run this lab in your environment, you must first install the required tools, which are basically Maven, Vagrant and Ansible. After that, just run the script start.sh and you should be ready to go. For a detailed explanation of how to use this demo, refer to the instructions in the Github repository.Load TestsThe demo lab also includes a JMeter load test project ready to be used. This load test was configured to run simultaneously in both machines (default and tuned) to be able to compare the benchmarks and their behavior at the same time.The test spares 150 threads and has a ramp-up period curve of two and a half minutes. This means that every second one user is added to the test until a total of 150 is reached. Once this threshold is reached, the test continues indefinitely.In our tests, after approximately ten minutes the machine that hadn’t been tuned stopped answering our requests and started to return proxy errors. After investigation, we discovered that the JVM just stopped responding, or the process exhausted its resources and stopped itself. The tuned machine kept responding to approximately almost all of the requests until we stopped the test.The table below illustrates the test results of one of our test runs, performed during 20 minutes:]The tuned machine kept a regular pacing of responses while the untouched one started to time out our requests:Non HTTP response code: org.apache.http.conn.ConnectTimeoutException/Non HTTP response message: Connect to app.local:80 timed outLooking at the transactions per second (TPS) chart, we can visually confirm the difference between them:]At first, both machines kept almost the same TPS, but over time the tuned one was more reliable.Observing each machine’s resource usage, things get more interesting. The charts below were taken from running this same test using PCP:]]The load average on the default machine, executing the same processes, with the same workload as the tuned machine, had twice the system load when compared to the tuned one.You can try this performance test for yourself by using the Github repository as a reference to set up your own environment. You should be able to expect similar results to the results discussed in this post. Try running other kinds of tests like bursting a ton of requests in a short period of time, or even increasing the load above 150 users.ConclusionIn this post we discussed some aspects of tuning an Apache Camel REST application deployed into Spring Boot serving HTTP requests behind a proxy server, and how to exercise what was discussed by replicating the fictional scenario using a demonstration lab.It’s worth noting that even if a component or software comes out of the box ready to use, such as the HTTPD server using the MPM prefork or the JVM ergonomics, your application can be extensively improved by running performance tests and configuring the environment accordingly.The tuning topics addressed in this post aren’t rocket science nor should  they be too difficult to implement. Today, if you neglect tuning, the platform could hide bottlenecks from you by scaling your application once it reaches a certain limit, or by restarting the container if the application stops responding.Even if your cloud platforms are engineered to maintain application reliability at high levels, it should be worth the time required to properly tune your application. Tuning allows you to leverage the platform and your computational resources even more, while still improving your overall application quality metrics." />
<meta name="description" content="IntroductionTuning is a very interesting topic in the field of Software Engineering. Everybody can agree that it’s important but I have  rarely seen people actually doing it. This can be especially true when people have spare computational resources to spend, or if they are following these mantras: “the load won’t reach at this point” or “let the cloud scale it.”The goal of this post is to share some insights regarding tuning an Apache Camel application deployed into Spring Boot. This is not an ultimate guide for tuning and performance tests in Spring Boot applications, but more of an experience sharing during a tuning process.When talking about tuning and performance tests, one thing that needs to be clear is the requirements, or what do you want to achieve by tuning an application. For example, one could say that with the computational resources they have, they aim for a 10% increase of requests the application can handle.We created a fictional scenario to make things easier and to define a requirement where we can apply the proposed tuning configurations. Also, for you to be able to replicate the topics discussed in this post, there is a demonstration lab available at Github. This lab has what you should need to create the environment and run the load tests while exploring the configuration changes addressed in the following sections.The ScenarioThings get clearer when we demonstrate by example, so let’s use a fictional scenario to do so.A customer is asking to improve the number of transactions per second (TPS) that their REST Apache Camel application deployed into Spring Boot can handle. The requirements are very strict:Can’t increase memory, CPU or disksThe architecture must remain intactCan’t change application source codeThe following figure illustrates the scenario architecture:]In this use case, the Apache HTTPD Web Server acts as a proxy server, load balancer and also offers TLS support for application servers. The Web Server is proxying requests to a REST application based on Apache Camel and Spring Boot with an embedded Tomcat. This architecture is always used by the customer when implementing REST services that are being integrated with external web services and third party applications.In this scenario, requests are treated by the proxy server through an encrypted connection and then passed to the underlying Spring Boot application. The application connects to an external service, transforms or composes the received data and then returns a response to the client.Every component of this architecture is compressed inside a virtual machine with 512MB of RAM and 2 vCPUs. The resources are sparse to emulate a possible real world scenario, where a  potential customer is asking for performance improvements in this environment, without having to invest in hardware resources nor modifying the architecture or the application source code.With such narrow requirements, where would you start? Let’s begin our tuning plan using a very old war strategy: dīvide et imperā (divide and conquer).Let’s navigate by each component in the architecture and explore what was done in this scenario to tune the environment. Each configuration change proposed is documented in a demonstration lab that could be replicated in other environments. In the next sections, we’re going to discuss each decision based on this example scenario.Apache HTTPD Web ServerThe Apache HTTPD Web Server plays an important role in the architecture by implementing connection encryption and proxying requests to underlying JVM processes.When installed in a Linux machine, the HTTPD web server comes with default values that could fit most use case scenarios, but when the workload starts to increase, you might face performance problems like proxy timeout errors, low throughout, and high machine resources usage.Here we’ll work with Apache 2.4, since it’s the current version and includes several bug and security fixes. The links, docs, and codes here will be related to Apache HTTPD 2.4.Switching the MPMThe first thing that was done was choosing the right Multi-Processing Module (MPM) for our use case scenario. By default, the MPM configured in HTTPD is prefork, which fits for use cases that need compatibility with libraries that are non-thread safe, like some old PHP libraries.In this case, we are going to change to the worker MPM that is much more performatic and suitable for our scenario, since we don’t need HTTPD to load any non-thread safe library nor serve dynamic scripts. The worker MPM implements a multi-process multi-threaded server, and according to the worker documentation, by using threads to serve requests, it is able to serve a large number of requests with fewer system resources than a process-based server.It’s worth noting that the worker MPM might be better than prefork in other scenarios as well, as long as you don’t need compatibility with non-thread safe libraries.Another approach that could be used was the event MPM, but because of a bug in the HTTPD version we were working with at the time of this article, we decided to stick with worker.Setting the connection parametersOnce the worker MPM is configured, the next thing that to do is define a consistent number for the MaxRequestWorkers parameter. In general, we use 300 times the number of CPU cores for worker MPM, but of course a lot of fine-tuning and experimentation have to be done. Don’t blindly set this parameter without properly testing.If we just followed the general advice of 300 * CPU cores, the max number of connections that the HTTPD server would serve in our architecture is 600 (we have 2 vCPUs for each machine). But is this number realistic?In our scenario, the HTTPD server and the Tomcat server are in the same machine, so they are competing for resources. The HTTPD server  should serve more requests than the Tomcat because it’s acting simply as a proxy server, while the Tomcat server is the one who is performing all the heavy work by processing our integration services.Having said that, the proxy server should act like a gatekeeper to help avoid processing more requests than the underlying application server can handle. To came up with an ideal number, a lot of experimentation with load tests have to be done at the application server to figure out how many concurrent requests it can handle. After that, set a number below this one to the HTTPD. This is the final configuration I came up with: ThreadLimit 30 ServerLimit 10 StartServers 3 MinSpareThreads 5 MaxSpareThreads 20 MaxRequestWorkers 300 ThreadsPerChild 30 MaxRequestsPerChild 0 Timeout 30 ProxyTimeout 30Taking into account the machine resources that we had, in our scenario the maximum number of requests that Tomcat handled without errors, while leaving some room for the other processes in the machine, was 400. So we set the max connections to 300 in the proxy server, which proved to be a fine configuration for this scenario. This way, the workload on Tomcat won’t reach the maximum, preserving its healthy state in most situations. Also, 300 simultaneous connections was enough to address the customer’s requirements.Other important parameters to pay attention to are Timeout and ProxyTimeout. Those numbers should be set equally to the underlying Tomcat server, so if the application times out, the error propagates to the client. Otherwise, you could have connections opened at the proxy server, spending valuable machine resources.Changing Proxy Pass connector to AJPThe last tuning configuration that was set in this scenario is the AJP connection to the Tomcat server. A basic proxy pass configuration is to bypass requests to the underlying server using the HTTP protocol. Instead, we used the AJP protocol, which is a binary protocol representation of the HTTP protocol that also skips HTTP header re-processing by the underlying server. This way we save a little bit of processing power. The final configuration looked like: ProxyPass ajp://localhost:8009Final thoughtsThese are the tuned configuration done so far at the HTTP server side:Switched the MPM from prefork to workerAdjusted the max connections that the proxy server can handle to preserve machine resources and also protect the application server from a workload that it can’t handleSet a proper timeout configuration aligned with the Tomcat serverChanged the proxy pass protocol from HTTP to AJPOf course, there are a lot of other things that could be done. There are other guides on the internet describing how to tune an Apache HTTPD server, but for this scenario and use case, we found that these configurations were enough to accomplish our customer requirements.Embedded TomcatThe role of the Tomcat Server in this architecture is to serve as a servlet container to the Apache Camel REST component. This implementation is managed by the Spring Boot Web as an embedded server. There are other servlet implementations to work with Spring Boot and Apache Camel like Undertow and Jetty that might perform better, but the requirements of the customer were not to change any piece of their architecture.Having said that, what can be done at the configuration level to have the Apache Tomcat Server perform better?Adjusting the connection parametersFirst of all, like we said in the Apache HTTPD section, the Tomcat server was tested alone to figure out how many requests it could handle in the most common use cases.For this task you could use the Pareto distribution to have a sample amount of requests to test the application. For example, using an API which reads, creates, and deletes customers, the read and create operation could be the most common use case. You can create a small set of sample requests and start putting some workload on your server. JMeter is a reasonable tool to do that, and we used this tool in our lab.Having come up with the max concurrent requests that the application could handle during a certain period of time without breaking, we adjusted the server parameters like this:ParameterValueDescriptionConnection Timeout (ms)30000This value is aligned with the Apache HTTPD proxy server timeout and has shown to be a reasonable number for our scenario.CompressionFalseWe are serving only small JSON payloads, and in our tests the compression didn’t make any noticeable difference. Besides, this can be set only at the proxy server level.Max Connections400A little more than the max connections at the proxy server side, so we had room to handle extra connections that could come between requests.Max Threads300This number seems reasonable for our resources and number of connections to handle. Each thread can handle more than one connection.Min Spare Threads300There’s no warm up for this server, which means that during high load there is no need to create more threads reaching the max to handle all the requests. But during idle or low workloads, these threads are up, although doing nothing. In our scenario, there wasn’t too much idle time that would justify decreasing this number.Accept Count100The number of connections waiting to be handled. If we reach the max connection number, the server starts to stack requests in this queue before denying a reply to the client. Of course, a lot of experimentation and load tests had been done. These numbers are for reference only and are the ones set in our lab. These numbers can be completely different depending on your requirements. Just keep in mind the responsibility of evaluating each parameter and determining what you can do to improve the performance of your server by fine-tuning each one. Take a look at the documentation to understand the parameters that can be configured in the Tomcat connectors.Using Tomcat Native ConnectorsThe next adjustment made on the Tomcat server was to use the native connectors to handle the connections coming up from the proxy server. Quoting from the official documentation:“The Apache Tomcat Native Library is an optional component for use with Apache Tomcat that allows Tomcat to use certain native resources for performance, compatibility, etc.”The decision to use the native libraries was guided by the performance improvements this can offer versus the standard Java libraries like BIO or NIO, leveraging from the OS capabilities to handle I/O operations.For this to work we had to install the APR library on our server, employ the native connectors, and create a custom embedded Tomcat server constructor on the Spring Boot side. The custom constructor was also used to set the configuration listed in the table above, because not all the Tomcat configurations can be set using the default application properties from the Spring Boot Tomcat embedded server.@Beanpublic EmbeddedServletContainerFactory servletContainer() { TomcatEmbeddedServletContainerFactory tomcat = new TomcatEmbeddedServletContainerFactory(); tomcat.addConnectorCustomizers(this.customizer(tomcat)); if (ajpPort != null) { Connector ajpConnector = new Connector(PROTOCOL); if (enableApr) { tomcat.addContextLifecycleListeners(new AprLifecycleListener()); ajpConnector = new Connector(&quot;org.apache.coyote.ajp.AjpAprProtocol&quot;); } ajpConnector.setPort(ajpPort); tomcat.addAdditionalTomcatConnectors(ajpConnector); } return tomcat;}Final thoughtsThe customizations made on the Tomcat side to tune our environment were:Set the max connections and timeout values to align with the Apache HTTPD web server and prevent excessive load on the Tomcat server.Installed APR and used the native AJP connector for I/O performance improvements.Customized the default Spring Boot embedded Tomcat constructor to set the properties not externalized by the Spring Boot properties component.Tweaked the connection and thread parameters to establish numbers that performed well during our load tests.Besides the requirement from our customer to not change the source code, this custom embedded Tomcat can be placed in the actual embedded server dependency of a project. Alternately, we can go further and create a patch, since the Spring Boot project limits our ability to change the default connector.There isn’t much to do at the Tomcat side besides experimentation. The main focus should be with the application that is using its servlet capabilities. A common scenario is a bad performatic application taking too long to return a reply, resulting in a bad experience for the client. But we can leverage several Tomcat parameters and connector implementations to improve the way that the server handles connections.Apache Camel and Spring BootWe finally arrive at the application layer after tweaking several knobs on the proxy and servlet server.Tuning the GC algorithmThe Spring Boot component ties the embedded Tomcat server and the Apache Camel routes and components together. All of these components run on the same Java Virtual Machine (JVM) process, so we decided to start by tuning the JVM Garbage Collector (GC) algorithm.Garbage Collector tuning deserves an entire article dedicated to it. As with the Apache HTTPD server tuning, there’s other articles on the internet talking about this subject. If you’re interested in a deep dive into it, give it a try using Oracle’s JVM Tuning documentation. This documentation doesn’t cover any particular use cases, but it provides good explanations of the structure of each algorithm.If not set, the JVM tries to tune the GC by itself in a process called ergonomics. This could work in environments with a small load, but in our scenario, we decided to take control of our GC algorithm and experiment with it. In the end, the G1 was the chosen one. The decision was based on the following criteria:It’s the algorithm that performed better at our tests, taking into account our scenario, resources and architecture.It’s optimized to maximize the throughput with small pauses during the application life cycle, favoring REST applications that have high-throughput requirements.If you have little or no knowledge about GC tuning, a starting point could be Red Hat’s JVM configuration Lab (subscription required). The Lab gives you some options to configure your GC that can lead you into fine-tuning once an algorithm is chosen.Some aspects of the GC that you should take care of:Too many “full GCs” during application load. To perform a full GC, the GC starts an event called “stop the world” that is a pause in every running thread to free up memory. During those pauses, nothing is processed at the JVM, which might increase the application response time.Long pauses. Even if the GC are not performing too many “stop the world” events, it’s important to take a look into the pause times. Depending on your requirements, pauses of 1 second or more could impact your application. There are configurations to try to control such behavior.A good tool to analyse the GC is Garbagecat or the gceasy website. The last one can give you a high level GC analysis based on your logs and could be a good starting point to understand the behavior of your GC.Besides the GC algorithm chosen, there are two configurations that you should always set in any JVM configuration:GC logs output: to examine your GC behavior during the application load, you must enable the GC logs. You should not  worry since you shouldn’t lose any performance and the logs will come in handy during troubleshooting.Heap dump on out of memory error: this is a must if you’re running into memory problems. The heap dump is a valuable artifact for memory leak troubleshooting or memory usage analysis. Just add the following option to your JVM configuration: -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=. To analyze the heap generated by the JVM, you could use the Eclipse Memory Analyzer Tool (MAT).Switching to a async log appenderIn this particular scenario we observed that the application had heavy audit log requirements. In our scenario, the application logged every input and output message for auditing and monitoring purposes. In a high load environment this could lead to a high disk usage during the current execution thread.The default implementation of popular logs frameworks in Java is the synchronous log, that is, every time the application needs to log something in the disk, the current execution thread is responsible for writing the log content to the disk.To avoid interfering in the current execution thread while writing to the disk, we switched the log appender to an asynchronous one. The log implementation is Logback, which has an interesting async feature that can minimize the risk of losing logs. We ended up with the following configuration:    0   500Setting the option “discardingThreshold” to zero, the appender won’t discard any log events even if the queue is full, but the blocking queue will stop until everything is written. Some experimentation is needed to adjust queue size with the expected load. Ideally, this queue does not reach its limit.Final thoughtsFinally, in the end we came up with the following conclusions:JVM tuning and experimentation: we decided to go with with G1 algorithm due to its throughput maximization nature.GC logs were turned on to capture data to be analyzed later, giving us valuable information used to configure the GC algorithm.Turned the log appenders to async due to the high audit log usage by the Apache Camel routes.The Spring Boot Apache Camel Java application was the last part of our scenario’s architecture to be reviewed.The Replication LabEach tuning aspect discussed up to this point in our example scenario can be explored using a demonstration lab available at our repository in Github.This lab replicates  tools and machines used during our experience of tuning this architecture. The lab was created to support this article and to serve as a sandbox for anyone who wants to experiment with this scenario and compare each aspect of tuning. The figure below illustrates the components provided by this lab:]The lab is composed of a Vagrant file, ansible playbooks and a demo Spring Boot Apache Camel application. With Vagrant you can set up a virtual environment in an operating system. Ansible also plays an important role since we used it to:Install the required software: the HTTPD Server, Java, Python 3 and PCP (Performance Co-Pilot).Deploy the application and the mock external service: the Spring Boot application is installed as a systemd service with its configuration set in the startup scripts. Ansible also runs a script to provide a Python 3 web service for mocking external calls from the Apache Camel routes.Open the required ports for PCP and JMX monitoring.Apply the tuned configurations on every component of the architecture: HTTPD and Spring Boot configuration, APR and Tomcat native connectors.For more detailed information about how Ansible was used in this lab, take a look at the playbooks.To be able to run this lab in your environment, you must first install the required tools, which are basically Maven, Vagrant and Ansible. After that, just run the script start.sh and you should be ready to go. For a detailed explanation of how to use this demo, refer to the instructions in the Github repository.Load TestsThe demo lab also includes a JMeter load test project ready to be used. This load test was configured to run simultaneously in both machines (default and tuned) to be able to compare the benchmarks and their behavior at the same time.The test spares 150 threads and has a ramp-up period curve of two and a half minutes. This means that every second one user is added to the test until a total of 150 is reached. Once this threshold is reached, the test continues indefinitely.In our tests, after approximately ten minutes the machine that hadn’t been tuned stopped answering our requests and started to return proxy errors. After investigation, we discovered that the JVM just stopped responding, or the process exhausted its resources and stopped itself. The tuned machine kept responding to approximately almost all of the requests until we stopped the test.The table below illustrates the test results of one of our test runs, performed during 20 minutes:]The tuned machine kept a regular pacing of responses while the untouched one started to time out our requests:Non HTTP response code: org.apache.http.conn.ConnectTimeoutException/Non HTTP response message: Connect to app.local:80 timed outLooking at the transactions per second (TPS) chart, we can visually confirm the difference between them:]At first, both machines kept almost the same TPS, but over time the tuned one was more reliable.Observing each machine’s resource usage, things get more interesting. The charts below were taken from running this same test using PCP:]]The load average on the default machine, executing the same processes, with the same workload as the tuned machine, had twice the system load when compared to the tuned one.You can try this performance test for yourself by using the Github repository as a reference to set up your own environment. You should be able to expect similar results to the results discussed in this post. Try running other kinds of tests like bursting a ton of requests in a short period of time, or even increasing the load above 150 users.ConclusionIn this post we discussed some aspects of tuning an Apache Camel REST application deployed into Spring Boot serving HTTP requests behind a proxy server, and how to exercise what was discussed by replicating the fictional scenario using a demonstration lab.It’s worth noting that even if a component or software comes out of the box ready to use, such as the HTTPD server using the MPM prefork or the JVM ergonomics, your application can be extensively improved by running performance tests and configuring the environment accordingly.The tuning topics addressed in this post aren’t rocket science nor should  they be too difficult to implement. Today, if you neglect tuning, the platform could hide bottlenecks from you by scaling your application once it reaches a certain limit, or by restarting the container if the application stops responding.Even if your cloud platforms are engineered to maintain application reliability at high levels, it should be worth the time required to properly tune your application. Tuning allows you to leverage the platform and your computational resources even more, while still improving your overall application quality metrics." />
<meta name="generator" content="Drupal 7 (http://drupal.org)" />
<link rel="image_src" href="https://www.redhat.com/profiles/rh/themes/redhatdotcom/img/red-hat-social-share.jpg" />
<link rel="canonical" href="https://www.redhat.com/en/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.redhat.com/en/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot" />
<meta property="og:title" content="Insights about tuning an Apache Camel application deployed into Spring Boot" />
<meta property="og:image" content="https://www.redhat.com/profiles/rh/themes/redhatdotcom/img/red-hat-social-share.jpg" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Insights about tuning an Apache Camel application deployed into Spring Boot" />
<meta name="twitter:image" content="https://www.redhat.com/profiles/rh/themes/redhatdotcom/img/red-hat-social-share.jpg" />
    <title>Insights about tuning an Apache Camel application deployed into Spring Boot</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://static.redhat.com">
    <link rel="preload" href="/sites/all/libraries/rh_iconfont/dist/fonts/web_icon/rh-web-iconfont.woff" as="font" type="font/woff" crossorigin>
    <link rel="preload" href="https://static.redhat.com/libs/redhat/redhat-font/4/webfonts/modified/RedHatTextVFModified.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://static.redhat.com/libs/redhat/redhat-font/4/webfonts/modified/RedHatDisplayVFModified.woff2" as="font" type="font/woff2" crossorigin>
    <link type="text/css" rel="stylesheet" href="/sites/default/files/advagg_css/css__k9aoxkMyjUtSX9AXGCPExPgTYjM0Xv5OYNfbFGDRafY__N9sjJtGj85lXtvOptw2e_YZ01FXbTXcJywP8EaKBijU__uaCwYofnUZLAnB7x3Q6WyVKHfqU6f9iB6Wi31ydea6c.css" media="all" />
<link type="text/css" rel="stylesheet" href="/sites/all/libraries/webrh/dist/css/webrh.webcomponents.min.css?rcei41" media="all" />
<link type="text/css" rel="stylesheet" href="/sites/all/libraries/webrh/dist/css/webrh.min.css?rcei41" media="all" />
<link type="text/css" rel="stylesheet" href="/sites/default/files/advagg_css/css__cOSHoRJvAiuOGcqrijbraZIQ8jLdGAu0JNEY7S1rd1A__soriEKeUPMGFKMgyj1u7l77zVZ1LkYPKqXFMpDx0BGc__uaCwYofnUZLAnB7x3Q6WyVKHfqU6f9iB6Wi31ydea6c.css" media="all" />
<style type="text/css" media="all">
/* <![CDATA[ */
.page .header-background-image{background-image:none;background-color:#252527;}@media (max-width:767px){.page .header-background-image{background-image:none;}.node-type-blog_post.mobile-nav-open .rh-standard-band--layout:first-child{background:#252527;padding-top:3.33333em;}}

/* ]]> */
</style>
<link type="text/css" rel="stylesheet" href="/sites/default/files/advagg_css/css__rifeal4Dr8bB772PnpxxWxHYqmWcdsdqyceV-4Qo0l0__yNcc7wRblJE8TXc7Hy6jqY-BWq4gQ4PfyRIJ7uuNlj8__uaCwYofnUZLAnB7x3Q6WyVKHfqU6f9iB6Wi31ydea6c.css" media="all" />
<link type="text/css" rel="stylesheet" href="/sites/default/files/advagg_css/css__wpajrf8pWA19ifT2xQXPB3J1TByoCXqZVtt6kXfl4Ow__PFQbFxxWsZl0yTnfrpPiA-o5Pvtu-CXh7nICx08JW0c__uaCwYofnUZLAnB7x3Q6WyVKHfqU6f9iB6Wi31ydea6c.css" media="print" />
<link type="text/css" rel="stylesheet" href="/sites/default/files/advagg_css/css__4Nq1a_8bNoRsE77XjnL9oXMrIezkUW_eK0M44VmZWbk__NU5y3-ivyS4r2TJJuLytjM7VOJF4W8czfq8TsqMBBeo__uaCwYofnUZLAnB7x3Q6WyVKHfqU6f9iB6Wi31ydea6c.css" media="all" />
<link type="text/css" rel="stylesheet" href="https://static.redhat.com/libs/redhat/marketing/latest/trustarc/trustecm/css/trustecm.css" media="all" />
<link type="text/css" rel="stylesheet" href="https://static.redhat.com/libs/redhat/redhat-theme/6/advanced-theme.css" media="all" />
<link type="text/css" rel="stylesheet" href="https://static.redhat.com/libs/redhat/redhat-font/4/webfonts/red-hat-font.min.css" media="all" />
    <!--[if lt IE 9]>
      <script src="/profiles/rh/themes/redhatdotcom/js/selectivizr-min.js" type="text/javascript"></script>
      <script src="/profiles/rh/themes/redhatdotcom/js/nwmatcher-min.js" type="text/javascript"></script>
      <script src="/profiles/rh/themes/redhatdotcom/js/respond.js" type="text/javascript"></script>
    <![endif]-->
    <script type="text/javascript" src="/sites/default/files/advagg_js/js__B6wED6l5P_XUdxVmb7Nvh5d9zn074QukFqJa2HLXS6c__VzWs8XZBHHsPW77egi-W-FQw2mAEr5F-GgCJU0wn3Nc__uaCwYofnUZLAnB7x3Q6WyVKHfqU6f9iB6Wi31ydea6c.js"></script>
<script type="text/javascript" src="/sites/all/libraries/webrh/dist/js/webrh.vendor.min.js?rcei41"></script>
<script type="text/javascript" src="/sites/all/libraries/webrh/dist/js/webrh.webcomponents.min.js?rcei41"></script>
<script type="text/javascript" src="/sites/all/libraries/webrh/dist/js/webrh.min.js?rcei41"></script>
<script type="text/javascript" src="/sites/default/files/advagg_js/js__pDOiYGKaYbdKNp1gvMxR0fWhWZnfUemYDUhADyCn3oM__jCrCuWCJIPYPe1FzZoUvsJWEjkNMmRIQHYek1h7idBE__uaCwYofnUZLAnB7x3Q6WyVKHfqU6f9iB6Wi31ydea6c.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
document.createElement( "picture" );
//--><!]]>
</script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
window.rh = window.rh || {}; window.rh.drupalTrustArcLoaded = true;
//--><!]]>
</script>
<script type="text/javascript" src="/sites/default/files/advagg_js/js__f27SEy1GKT9ouERmo5kuM0Q2VDJ2zZHupN3GT1ogqAI__GvN6i9IaMwXpYKjBLQK-jMoJCxL8-ExTeBSe2Eepqmw__uaCwYofnUZLAnB7x3Q6WyVKHfqU6f9iB6Wi31ydea6c.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"en\/","ajaxPageState":{"theme":"redhatdotcom","theme_token":"KG3dU_ap8TTMe9frCTyznpq-xGIe3O3_AcYe1_F39X4","css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"misc\/ui\/jquery.ui.core.css":1,"misc\/ui\/jquery.ui.theme.css":1,"sites\/all\/libraries\/webrh\/dist\/css\/webrh.webcomponents.min.css":1,"sites\/all\/libraries\/webrh\/dist\/css\/webrh.min.css":1,"https:\/\/static.redhat.com\/libs\/redhat\/marketing\/latest\/trustarc\/trustecm\/css\/trustecm.css":1,"https:\/\/static.redhat.com\/libs\/redhat\/redhat-theme\/6\/advanced-theme.css":1,"modules\/locale\/locale.css":1,"https:\/\/static.redhat.com\/libs\/redhat\/redhat-font\/4\/webfonts\/red-hat-font.min.css":1,"0":1,"sites\/all\/libraries\/rh_iconfont\/dist\/files\/rh-iconfont.css":1,"sites\/all\/libraries\/rh_iconfont\/dist\/files\/rh-web-iconfont.css":1,"sites\/all\/libraries\/patternfly-elements\/pfe-styles\/pfe-typography-classes.css":1,"profiles\/rh\/themes\/redhatdotcom\/css\/site-switcher.css":1,"profiles\/rh\/themes\/redhatdotcom\/css\/bootstrap.css":1,"profiles\/rh\/themes\/redhatdotcom\/css\/chrome.css":1,"profiles\/rh\/themes\/redhatdotcom\/css\/pfe-nav-light-dom.css":1,"profiles\/rh\/themes\/redhatdotcom\/css\/universal-nav.css":1,"profiles\/rh\/themes\/redhatdotcom\/js\/jquery.selectBoxIt\/jquery.selectBoxIt.css":1,"profiles\/rh\/themes\/redhatdotcom\/css\/print.css":1,"profiles\/rh\/themes\/redhatdotcom\/css\/style.css":1,"profiles\/rh\/themes\/redhatdotcom\/css\/editorial.css":1},"js":{"profiles\/rh\/modules\/redhat_www_analytics\/libraries\/dist\/js\/rhdc_analytics_eddl_user.min.js":1,"profiles\/rh\/modules\/redhat_www_analytics\/libraries\/dist\/js\/rhdc_analytics_eddl_bottom.min.js":1,"sites\/all\/modules\/jquery_update\/replace\/jquery\/1.10\/jquery.min.js":1,"misc\/jquery-extend-3.4.0.js":1,"misc\/jquery-html-prefilter-3.5.0-backport.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"profiles\/rh\/modules\/redhat_www_ddo\/dist\/post-jquery.min.js":1,"sites\/all\/libraries\/webrh\/dist\/js\/webrh.vendor.min.js":1,"sites\/all\/libraries\/webrh\/dist\/js\/webrh.webcomponents.min.js":1,"sites\/all\/libraries\/webrh\/dist\/js\/webrh.min.js":1,"sites\/all\/modules\/jquery_update\/replace\/ui\/ui\/minified\/jquery.ui.core.min.js":1,"sites\/all\/modules\/jquery_update\/replace\/ui\/ui\/minified\/jquery.ui.widget.min.js":1,"profiles\/rh\/modules\/redhat_www_menu\/js\/rh_nav.js":1,"profiles\/rh\/modules\/redhat_www_analytics\/libraries\/dist\/js\/rhdc_analytics_eddl_top.min.js":1,"profiles\/rh\/modules\/redhat_www_share\/js\/rh_share.js":1,"profiles\/rh\/modules\/redhat_www_solr\/js\/rh_solr.js":1,"profiles\/rh\/modules\/redhat_www_solr\/js\/redhat_www_solr_suggestions.js":1,"profiles\/rh\/modules\/redhat_www_type_blog_post\/js\/redhat_www_type_blog_post_contextual.js":1,"sites\/all\/libraries\/jquery-cookie\/jquery.cookie-1.4.1.min.js":1,"profiles\/rh\/themes\/redhatdotcom\/js\/jquery.pushmenu.js":1,"profiles\/rh\/themes\/redhatdotcom\/js\/jquery-scrolltofixed.js":1,"profiles\/rh\/themes\/redhatdotcom\/js\/rh-chrome.js":1,"profiles\/rh\/themes\/redhatdotcom\/js\/jquery.fitvids.js":1,"profiles\/rh\/themes\/redhatdotcom\/js\/jquery.switchIt.js":1,"profiles\/rh\/themes\/redhatdotcom\/js\/jquery.selectBoxIt\/jquery.selectBoxIt.js":1,"profiles\/rh\/themes\/redhatdotcom\/js\/jquery.viewport\/jquery.viewport.min.js":1,"profiles\/rh\/themes\/redhatdotcom\/js\/sass-bootstrap.min.js":1}},"redhat_www_menu":{"path":"node\/468001"},"rh_analytics_enabled":false,"urlIsAjaxTrusted":{"\/en\/search\/node":true},"redhat_www_type_blog_post":{"ajaxUrlBlogDetail":"\/en\/blog\/detail-ajax\/468001"}});
//--><!]]>
</script>
    <noscript>
        <link href="/sites/all/libraries/webrh/dist/css/webrh.webcomponents.noscript.min.css" rel="stylesheet" >
    </noscript>
  
                    <script>var w=window;if(w.performance||w.mozPerformance||w.msPerformance||w.webkitPerformance){var d=document;AKSB=w.AKSB||{},AKSB.q=AKSB.q||[],AKSB.mark=AKSB.mark||function(e,_){AKSB.q.push(["mark",e,_||(new Date).getTime()])},AKSB.measure=AKSB.measure||function(e,_,t){AKSB.q.push(["measure",e,_,t||(new Date).getTime()])},AKSB.done=AKSB.done||function(e){AKSB.q.push(["done",e])},AKSB.mark("firstbyte",(new Date).getTime()),AKSB.prof={custid:"751264",ustr:"",originlat:"0",clientrtt:"12",ghostip:"88.221.24.31",ipv6:true,pct:"10",clientip:"2a02:a462:c281:1:f152:1249:d37f:eef",requestid:"2f789c72",region:"34527",protocol:"",blver:14,akM:"dscx",akN:"ae",akTT:"O",akTX:"1",akTI:"2f789c72",ai:"477224",ra:"false",pmgn:"",pmgi:"",pmp:"",qc:""},function(e){var _=d.createElement("script");_.async="async",_.src=e;var t=d.getElementsByTagName("script"),t=t[t.length-1];t.parentNode.insertBefore(_,t)}(("https:"===d.location.protocol?"https:":"http:")+"//ds-aksb-a.akamaihd.net/aksb.min.js")}</script>
                    </head>
  <body class="bands-index html not-front not-logged-in no-sidebars page-node page-node- page-node-468001 node-type-blog-post i18n-en" >
    <div class="page">
            <!-- Legacy migrated page support with body.migrated-page-hero -->
<div class="header-background-image">
</div>

  <div id="main-content">
                      <div class="region region-content">
    <div id="block-system-main" class="block block-system">

      
    <!-- Pattern | article -->

                                                   
                
        

    
                
        
    


    


<div class="header-background-image"></div>

<!-- Skip navigation -->
<a href="#rh-main-content" class="visually-hidden skip-link">Skip to content</a>


  <nav id="universal-nav" class="unav" aria-labelledby="unav-label" data-analytics-region="universal-navigation">
    <h2 id="unav-label" class="unav__visually-hidden">Featured links</h2>
    <div class="unav__wrapper">
      <ul class="unav__menu">
                              <li>
              <a class="unav__link"
                href="https://cloud.redhat.com/"
                data-analytics-category="Featured Links"
                data-analytics-text="Console"
              >Console</a>
            </li>
                                        <li>
              <a class="unav__link"
                href="https://access.redhat.com"
                data-analytics-category="Featured Links"
                data-analytics-text="Support"
              >Support</a>
            </li>
                                        <li>
              <a class="unav__link"
                href="https://developers.redhat.com"
                data-analytics-category="Featured Links"
                data-analytics-text="Developers"
              >Developers</a>
            </li>
                                        <li>
              <a class="unav__link"
                href="/en/partners"
                data-analytics-category="Featured Links"
                data-analytics-text="Partners"
              >Partners</a>
            </li>
                                        <li>
              <a class="unav__link"
                href="/en"
                data-analytics-category="Featured Links"
                data-analytics-text="Redhat.com"
              >Redhat.com</a>
            </li>
                                        <li>
              <a class="unav__link unav__trial"
                href="/en/products/trials"
                data-analytics-category="Featured Links"
                data-analytics-linkType="cta"
                data-analytics-text="Start a trial"
              >
                <span class="unav__trial-button">Start a trial</span>
              </a>
            </li>
                          </ul>
    </div>
  </nav>

<pfe-navigation  id="pfe-navigation" class="main-header" search-button-translation="Search" pfe-sticky pfe-full-width pfe-close-on-click="external" pfe-menu-label="Menu" role="banner" data-analytics-region="mega menu">

  <nav class="pfe-navigation" aria-label="Main Navigation" data-analytics-region="main nav">

    <!-- Site logo -->
    <div class="pfe-navigation__logo-wrapper" id="pfe-navigation__logo-wrapper">
      <a href="/en" title="Red Hat" class="pfe-navigation__logo-link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145" class="redhat-logo" style="margin:0; width: 135px; display:block" height="32" width="135">
          <path d="M127.47 83.49c12.51 0 30.61-2.58 30.61-17.46a14 14 0 0 0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89 8.69 103.76.5 97.51.5 91.69.5 90 8 83.06 8c-6.68 0-11.64-5.6-17.89-5.6-6 0-9.91 4.09-12.93 12.5 0 0-8.41 23.72-9.49 27.16a6.43 6.43 0 0 0-.22 1.94c0 9.22 36.3 39.45 84.94 39.45M160 72.07c1.73 8.19 1.73 9.05 1.73 10.13 0 14-15.74 21.77-36.43 21.77-46.76.03-87.72-27.37-87.72-45.48a18.45 18.45 0 0 1 1.51-7.33C22.27 52 .5 55 .5 74.22c0 31.48 74.59 70.28 133.65 70.28 45.28 0 56.7-20.48 56.7-36.65 0-12.72-11-27.16-30.83-35.78" fill="#e00"/>
          <path d="M160 72.07c1.73 8.19 1.73 9.05 1.73 10.13 0 14-15.74 21.77-36.43 21.77-46.76.03-87.72-27.37-87.72-45.48a18.45 18.45 0 0 1 1.51-7.33l3.66-9.06a6.43 6.43 0 0 0-.22 1.9c0 9.22 36.3 39.45 84.94 39.45 12.51 0 30.61-2.58 30.61-17.46a14 14 0 0 0-.31-3.42Z"/>
          <path d="M579.74 92.8c0 11.89 7.15 17.67 20.19 17.67a52.11 52.11 0 0 0 11.89-1.68V95a24.84 24.84 0 0 1-7.68 1.16c-5.37 0-7.36-1.68-7.36-6.73V68.3h15.56V54.1h-15.56v-18l-17 3.68V54.1h-11.29v14.2h11.25Zm-53 .32c0-3.68 3.69-5.47 9.26-5.47a43.12 43.12 0 0 1 10.1 1.26v7.15a21.51 21.51 0 0 1-10.63 2.63c-5.46 0-8.73-2.1-8.73-5.57m5.2 17.56c6 0 10.84-1.26 15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52 0-16.94 2-26 6.1l6.1 12.52c6.52-2.74 12-4.42 16.83-4.42 7 0 10.62 2.73 10.62 8.31v2.73a49.53 49.53 0 0 0-12.62-1.58c-14.31 0-22.93 6-22.93 16.73 0 9.78 7.78 17.24 20.19 17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12h-18.07v28.29h-30.29V36.12h-18.09Zm-68.86-27.9c0-8 6.31-14.1 14.62-14.1A17.22 17.22 0 0 1 397 72.09v19.45A16.36 16.36 0 0 1 385.24 96c-8.2 0-14.62-6.1-14.62-14.09m26.61 27.87h16.83V32.44l-17 3.68v20.93a28.3 28.3 0 0 0-14.2-3.68c-16.19 0-28.92 12.51-28.92 28.5a28.25 28.25 0 0 0 28.4 28.6 25.12 25.12 0 0 0 14.93-4.83ZM320 67c5.36 0 9.88 3.47 11.67 8.83h-23.2C310.15 70.3 314.36 67 320 67m-28.67 15c0 16.2 13.25 28.82 30.28 28.82 9.36 0 16.2-2.53 23.25-8.42l-11.26-10c-2.63 2.74-6.52 4.21-11.14 4.21a14.39 14.39 0 0 1-13.68-8.83h39.65v-4.23c0-17.67-11.88-30.39-28.08-30.39a28.57 28.57 0 0 0-29 28.81M262 51.58c6 0 9.36 3.78 9.36 8.31S268 68.2 262 68.2h-17.89V51.58Zm-36 58.16h18.09V82.92h13.77l13.89 26.82H292l-16.2-29.45a22.27 22.27 0 0 0 13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z" fill="#fff"/>
        </svg>
      </a>
    </div>

    <!-- Main navigation -->
    <pfe-navigation-main>
      <ul>
                <li>
          <pfe-navigation-item>
            <div slot="trigger">
              <a href="/en/technologies" data-analytics-text="Products" data-analytics-level="1">Products</a>
            </div>
            <div slot="tray" data-column="10311" hidden>
            </div>
          </pfe-navigation-item>
        </li>        <li>
          <pfe-navigation-item>
            <div slot="trigger">
              <a href="/en/solutions" data-analytics-text="Solutions" data-analytics-level="1">Solutions</a>
            </div>
            <div slot="tray" data-column="10331" hidden>
            </div>
          </pfe-navigation-item>
        </li>        <li>
          <pfe-navigation-item>
            <div slot="trigger">
              <a href="/en/services" data-analytics-text="Services &amp; support" data-analytics-level="1">Services & support</a>
            </div>
            <div slot="tray" data-column="138281" hidden>
            </div>
          </pfe-navigation-item>
        </li>        <li>
          <pfe-navigation-item>
            <div slot="trigger">
              <a href="/en/resources" data-analytics-text="Resources" data-analytics-level="1">Resources</a>
            </div>
            <div slot="tray" data-column="169591" hidden>
            </div>
          </pfe-navigation-item>
        </li>        <li>
          <pfe-navigation-item>
            <div slot="trigger">
              <a href="/en/about" class="active" data-analytics-text="Red Hat &amp; open source" data-analytics-level="1">Red Hat & open source</a>
            </div>
            <div slot="tray" data-column="10351" hidden>
            </div>
          </pfe-navigation-item>
        </li>        <!-- Mobile specific links -->
                  <li class="universal-nav-link hidden-at-desktop" data-analytics-region="universal-navigation">
            <pfe-navigation-item>
              <div slot="trigger">
                <a href="#"
                  data-analytics-category="Featured Links"
                  data-analytics-text="Featured Links"
                  data-analytics-level="1"
                >Featured links</a>
              </div>
              <div slot="tray">
                <div class="pfe-navigation-item__tray--container">
                  <div class="pfe-navigation-grid">
                    <div class="pfe-navigation--column">
                      <div class="pfe-link-list">
                        <ul class="pfe-link-list--group">
                                                                                    <li class="pfe-link-list--group-item">
                                <a href="https://cloud.redhat.com/"
                                  data-analytics-category="Featured Links"
                                  data-analytics-text="Console"
                                >Console</a>
                              </li>
                                                                                                                <li class="pfe-link-list--group-item">
                                <a href="https://access.redhat.com"
                                  data-analytics-category="Featured Links"
                                  data-analytics-text="Support"
                                >Support</a>
                              </li>
                                                                                                                <li class="pfe-link-list--group-item">
                                <a href="https://developers.redhat.com"
                                  data-analytics-category="Featured Links"
                                  data-analytics-text="Developers"
                                >Developers</a>
                              </li>
                                                                                                                <li class="pfe-link-list--group-item">
                                <a href="/en/partners"
                                  data-analytics-category="Featured Links"
                                  data-analytics-text="Partners"
                                >Partners</a>
                              </li>
                                                                                                                <li class="pfe-link-list--group-item">
                                <a href="/en"
                                  data-analytics-category="Featured Links"
                                  data-analytics-text="Redhat.com"
                                >Redhat.com</a>
                              </li>
                                                                                                                <li class="pfe-link-list--group-item">
                                <pfe-cta>
                                  <a href="/en/products/trials"
                                    data-analytics-category="Featured Links"
                                    data-analytics-text="Start a trial"
                                  >Start a trial</a>
                                </pfe-cta>
                              </li>
                                                                                </ul>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </pfe-navigation-item>
          </li>
              </ul>
    </pfe-navigation-main>

  </nav>

  <!-- Search -->
  <form class="search-form" slot="search" id="utility-search" autocomplete="off" action="/en/search/node" method="post" accept-charset="UTF-8">
    <form class="search-form" autocomplete="off" action="/en/search/node" method="post" id="redhat-www-solr-search-box" accept-charset="UTF-8"><div><div class="container-inline form-wrapper" id="edit-basic"><div class="form-item form-type-textfield form-item-keys">
  <label class="element-invisible" for="edit-keys">Enter your keywords </label>
 <input maxlength="128" size="15" placeholder="Enter your search term" type="text" id="edit-keys" name="keys" value="" class="form-text" />
</div>
<div class="form-actions form-wrapper" id="edit-actions"><input type="submit" id="edit-submit" name="op" value="Search" class="form-submit" /></div></div><input type="hidden" name="form_build_id" value="form-7MhgDKp4xh9QH-5qf0g53U4Fk764saevmHbSJck9R8c" />
<input type="hidden" name="form_id" value="redhat_www_solr_search_box" />
</div></form>  </form>


  <!-- Contact us -->
  <div slot="secondary-links">
    <a href="/en/contact" data-analytics-category="utility" data-analytics-text="contact" data-analytics-level="1">
      <pfe-icon icon="local-talk-bubble" pfe-size="md" aria-hidden="true"></pfe-icon>
      Contact us    </a>
  </div>

  <!-- Language -->
  <div slot="secondary-links" id="utility-globe">
    <button class="pfe-navigation__secondary-link" data-analytics-text="English" data-analytics-level="1">
      <pfe-icon icon="web-globe" size="sm" aria-hidden="true"></pfe-icon>
      English    </button>
    <pfe-navigation-dropdown dropdown-width="full">
      <div class="pfe-navigation-item__tray--container">
        <div class="language-picker">  <h3 class="pfe-headline-2" data-analytics-level="2" data-analytics-category="English" data-analytics-text="Select a language">Select a language</h3>
  <ul><li class="pfe-headline-5"><a href="/zh/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot" class="language-link" xml:lang="zh" hreflang="zh" data-analytics-text="简体中文" data-analytics-level="3" data-analytics-category="Language">简体中文</a></li><li class="pfe-headline-5"><a href="/en/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot" class="language-link active" xml:lang="en" hreflang="en" data-analytics-text="English" data-analytics-level="3" data-analytics-category="Language">English</a></li><li class="pfe-headline-5"><a href="/fr/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot" class="language-link" xml:lang="fr" hreflang="fr" data-analytics-text="Français" data-analytics-level="3" data-analytics-category="Language">Français</a></li><li class="pfe-headline-5"><a href="/de/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot" class="language-link" xml:lang="de" hreflang="de" data-analytics-text="Deutsch" data-analytics-level="3" data-analytics-category="Language">Deutsch</a></li><li class="pfe-headline-5"><a href="/it/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot" class="language-link" xml:lang="it" hreflang="it" data-analytics-text="Italiano" data-analytics-level="3" data-analytics-category="Language">Italiano</a></li><li class="pfe-headline-5"><a href="/ja/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot" class="language-link" xml:lang="ja" hreflang="ja" data-analytics-text="日本語" data-analytics-level="3" data-analytics-category="Language">日本語</a></li><li class="pfe-headline-5"><a href="/ko/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot" class="language-link" xml:lang="ko" hreflang="ko" data-analytics-text="한국어" data-analytics-level="3" data-analytics-category="Language">한국어</a></li><li class="pfe-headline-5"><a href="/pt-br/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot" class="language-link" xml:lang="pt-br" hreflang="pt-br" data-analytics-text="Português" data-analytics-level="3" data-analytics-category="Language">Português</a></li><li class="pfe-headline-5"><a href="/es/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot" class="language-link" xml:lang="es" hreflang="es" data-analytics-text="Español" data-analytics-level="3" data-analytics-category="Language">Español</a></li></ul></div>      </div>
    </pfe-navigation-dropdown>
  </div>

  <!-- Log in -->
  <div slot="account" id="utility-account" class="hidden-at-tablet hidden-at-mobile">
    <button class="pfe-navigation__account-toggle" data-analytics-level="1">
      <pfe-icon icon="web-icon-user" size="sm" aria-hidden="true"></pfe-icon>
      <span class="rh-user-loggedin">Account</span>
      <span class="rh-user-loggedout">Log in</span>
    </button>
    <pfe-navigation-dropdown dropdown-width="full">
      <section class="account-tray">
  <header>
    <div class="container">
              <p class="rh-login-heading rh-user-loggedin">Welcome, <span class='rh-name'></span></p>
                    <p class="rh-login-heading rh-user-loggedout">Log in to your Red Hat account</p>
          </div>
  </header>
  <div class="content">
    <div class="container">
      <section class="account-login rh-user-loggedout">
        <div class="account-login-wrapper">
                      <a href="https://sso.redhat.com/auth/realms/redhat-external/protocol/saml/clients/legacy-idp-servlets" id="redhat-account-login-link" class="account-login-link utility-user-login-link" data-analytics-region="utility" data-analytics="Log in" data-analytics-text="Log in">Log in</a>                                <p>Your Red Hat account gives you access to your member profile and preferences, and the following services based on your customer status:</p>
                                <div class="utility-user-additional-links"><div class="item-list"><ul><li class="first">Customer Portal</li>
<li class="last">Red Hat Connect for Business Partners</li>
</ul></div><div class="item-list"><ul><li class="first">User management</li>
<li class="last">Certification Central</li>
</ul></div></div>                  </div>
        <div class="account-register-wrapper">
                      <a href="https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/registrations?client_id=https%3A%2F%2Fwww.redhat.com%2Fwapps%2Fugc-oidc&amp;redirect_uri=https%3A%2F%2Fwww.redhat.com%2Fwapps%2Fugc%2Fprotected%2Faccount.html&amp;response_type=code&amp;scope=openid" class="account-register-link" data-analytics-region="utility" data-analytics="Register now" data-analytics-text="Register now">Register now</a>                                <p class="account-register-heading">Not registered yet? Here are a few reasons why you should be:</p><div class="item-list"><ul><li class="first">Browse Knowledgebase articles, manage support cases and subscriptions, download updates, and more from one place.</li>
<li>View users in your organization, and edit their account information, preferences, and permissions.</li>
<li class="last">Manage your Red Hat certifications, view exam history, and download certification-related logos and documents.</li>
</ul></div>                  </div>
      </section>
      <section class="account-logout rh-user-loggedin">
        <div class="account-welcome-wrapper">
                      <a href="https://www.redhat.com/wapps/ugc/protected/account.html" class="account-edit-link" data-analytics-region="utility" data-analytics="Edit your profile and preferences" data-analytics-label="Edit your profile and preferences">Edit your profile and preferences</a>                                <p>Your Red Hat account gives you access to your member profile, preferences, and other services depending on your customer status.</p>
                            </div>
        <div class="account-logout-wrapper">
                      <p>For your security, if you&#039;re on a public computer and have finished using your Red Hat services, please be sure to log out.</p>
                                <a href="https://sso.redhat.com/auth/realms/redhat-external/logout" id="redhat-account-logout-link" class="account-logout-link" data-analytics-region="utility" data-analytics="Log out" data-analytics-label="Log out">Log out</a>                  </div>
      </section>
    </div>
  </div>
</section>
    </pfe-navigation-dropdown>
  </div>

  <!-- Mobile Log In -->
  <div slot="account" class="hidden-at-desktop">
    <a class="rh-user-loggedin" href="https://www.redhat.com/wapps/ugc/protected/account.html" data-analytics-text="Account" data-analytics-level="1"><pfe-icon icon="web-user" pfe-size="md" aria-hidden="true"></pfe-icon>Account</a>
    <a class="rh-user-loggedout" href="https://sso.redhat.com/auth/realms/redhat-external/protocol/saml/clients/legacy-idp-servlets" data-analytics-text="Log in" data-analytics-level="1"><pfe-icon icon="web-user" pfe-size="md" aria-hidden="true"></pfe-icon>Log in</a>
  </div>

  <!-- Products node slot -->
  <div slot="products">
  </div>

</pfe-navigation>
<span id="rh-main-content"></span>
    
<div class="rh-push-pull-group--layout" >
            <div class="rh-push-pull-group-pull-content">
                            
        



                



<div class="rh-pull-content--layout"      data-rh-background="rich-black"                      >
        <div class="rh-pull-content-container"      data-rh-layout="pull-aside"    >
        <section class="rh-pull-content-main"      data-rh-theme="dark">
                            <!-- Pattern | article_hero -->

                

    

    
    
  
<div class="rh-band--layout"   data-rh-band-collapse="both"  data-rh-background="transparent"><div class="rh-band-container"data-rh-layout="stacked"  ><section class="rh-band-main"    data-rh-layout="stacked"
><header class="rh-band-header"         data-rh-theme="dark subtle"><section class="rh-divider--layout"     ><div class="rh-divider-container"><div class="rh-divider-main"     data-rh-layout="stacked"
            data-eq-pts="xs-divider: 0, lg-divider: 600"
><header class="rh-divider-header"        data-rh-show-rule="sm md lg "
><!-- Group layout --><div class="rh-group--layout"     data-rh-misc=hero-header                    data-eq-pts="xxs-group: 0, xs-group: 220, sm-group: 320, md-group: 420, lg-group: 620"
><div class="rh-group-body"      data-rh-layout="flex-edges-desktop"     ><div class="rh-band-header--component"         ><p class="rh-band-header-title">Red Hat blog</p></div><!-- Subpattern | subnavigation --><div class="rh-accordion-card--layout"     data-rh-no-accordion-at="sm md lg "

             data-rh-blog-menu    data-eq-pts="xs-accordion-card: 0, sm-accordion-card: 220, md-accordion-card: 420, lg-accordion-card: 520, xl-accordion-card: 620" ><div class="rh-accordion-card-header"             data-rh-toggle-open="click"
        data-rh-state="closed"
                data-rh-background="rich-black"
        data-rh-theme="dark"
        data-rh-hidden="sm md lg "     data-rh-spacing="none"     data-rh-border="full-mobile"><header class="rh-standard-header--component"     data-rh-align=left
     data-rh-indicator-align="right"     data-rh-hover-style="xxs xs "        ><div class="rh-standard-header-container"><h2 class="rh-standard-header-title-small"      >
                    Blog menu
                                                                            </h2></div><span class="rh-standard-header-indicator" data-rh-indicator-symbol="arrow-right" data-rh-hidden-at="sm md lg "></span></header></div><div class="rh-accordion-card-body"             data-rh-toggle-target="xxs xs "
        data-rh-state="closed"
                 data-rh-spacing="none"    data-rh-border="full-mobile"    data-rh-indicator-alignment="right"><!-- Group layout --><div class="rh-group--layout"     data-rh-misc=subnav                    data-eq-pts="xxs-group: 0, xs-group: 220, sm-group: 320, md-group: 420, lg-group: 620"
><div class="rh-group-body"      data-rh-layout="flex-end-end"     ><nav class="rh-dropdown--component"><a class="rh-dropdown-parent"href="/en/blog">Latest posts</a></nav><nav class="rh-dropdown--component"><a class="rh-dropdown-parent"id="rh-8lg8c-parent" aria-haspopup="true" aria-owns="rh-8lg8c" aria-controls="rh-8lg8c"href="#"data-rh-toggle-open="click single" data-rh-toggle-id="rh-8lg8c">By product</a><ul class="rh-dropdown-children" id="rh-8lg8c" data-rh-background="black" data-rh-theme="dark"
                data-rh-toggle-target role="group" aria-labelledby="rh-8lg8c-parent"><li class="rh-dropdown-child"><a class="rh-dropdown-child-link"
                            href="/en/blog/channel/red-hat-enterprise-linux"title="Red Hat Enterprise Linux">Red Hat Enterprise Linux</a></li><li class="rh-dropdown-child"><a class="rh-dropdown-child-link"
                            href="/en/blog/channel/red-hat-insights"title="Red Hat Insights">Red Hat Insights</a></li><li class="rh-dropdown-child"><a class="rh-dropdown-child-link"
                            href="/en/blog/channel/red-hat-openshift"title="Red Hat OpenShift">Red Hat OpenShift</a></li><li class="rh-dropdown-child"><a class="rh-dropdown-child-link"
                            href="/en/blog/channel/red-hat-ansible-automation"title="Red Hat Ansible Automation">Red Hat Ansible Automation</a></li><li class="rh-dropdown-child"><a class="rh-dropdown-child-link"
                            href="/en/blog/channel/red-hat-openstack-platform"title="Red Hat OpenStack Platform">Red Hat OpenStack Platform</a></li><li class="rh-dropdown-child"><a class="rh-dropdown-child-link"
                            href="/en/blog/channel/red-hat-storage"title="Red Hat Cloud Storage and Data Services">Red Hat Cloud Storage and Data Services</a></li><li class="rh-dropdown-child"><a class="rh-dropdown-child-link"
                            href="/en/blog/products"title="All products" data-rh-link-type="featured">All products</a></li></ul></nav><nav class="rh-dropdown--component"><a class="rh-dropdown-parent"id="rh-eq9of-parent" aria-haspopup="true" aria-owns="rh-eq9of" aria-controls="rh-eq9of"href="#"data-rh-toggle-open="click single" data-rh-toggle-id="rh-eq9of">By channel</a><ul class="rh-dropdown-children" id="rh-eq9of" data-rh-background="black" data-rh-theme="dark"
                data-rh-toggle-target role="group" aria-labelledby="rh-eq9of-parent"><li class="rh-dropdown-child"><a class="rh-dropdown-child-link"
                            href="/en/blog/channel/red-hat-news"title="Red Hat News">Red Hat News</a></li><li class="rh-dropdown-child"><a class="rh-dropdown-child-link"
                            href="/en/blog/channel/red-hat-services-speak"title="Red Hat Services Speak">Red Hat Services Speak</a></li><li class="rh-dropdown-child"><a class="rh-dropdown-child-link"
                            href="/en/blog/channel/cloud-native-computing"title="Cloud native computing">Cloud native computing</a></li><li class="rh-dropdown-child"><a class="rh-dropdown-child-link"
                            href="/en/blog/channel/security"title="Red Hat Security">Red Hat Security</a></li><li class="rh-dropdown-child"><a class="rh-dropdown-child-link"
                            href="/en/blog/channel/hybrid-cloud-infrastructure"title="Open Hybrid Cloud">Open Hybrid Cloud</a></li><li class="rh-dropdown-child"><a class="rh-dropdown-child-link"
                            href="/en/blog/channel/management-and-automation"title="Management and automation">Management and automation</a></li><li class="rh-dropdown-child"><a class="rh-dropdown-child-link"
                            href="/en/blog/channels"title="All channels" data-rh-link-type="featured">All channels</a></li></ul></nav></div></div></div></div></div></div><hr class="rh-divider-header-rule"/></header></div></div></section></header><div class="rh-band-content"    
                     data-rh-layout="9-flex-end"                 data-rh-theme="dark subtle"><div class="rh-article-teaser--component"><h1 class="rh-article-teaser-hero-headline">Insights about tuning an Apache Camel application deployed into Spring Boot        </h1><div class="rh-article-teaser-meta"><span class="rh-article-teaser-hero-date">October 15, 2018<span class="rh-article-teaser-pipe"></span></span><span class="rh-article-teaser-hero-author"><a href="/en/authors/ricardo-zanini-fernandes" title="See more by Ricardo Zanini Fernandes">Ricardo Zanini Fernandes</a></span></div></div></div></section></div></div>                    </section>
                <aside class="rh-pull-content-aside"          data-rh-theme="dark"
            data-eq-pts="xxs-box: 0, sm-aside: 290">
                            <!-- Pattern | raw_html -->

<div class="rh-group--layout" data-eq-pts="small: 0, medium: 220, large: 320" data-eq-state="small"><div class="rh-group-body" data-rh-layout="flex-left-end fixed-at-2"><!-- Component | social_icon -->

    <div class="rh-social-icon--component"
        data-rh-icon-background="white"
         data-rh-align="left"          data-rh-position="below"          data-rh-icon-size="xsmall"         >

        <span class="rh-social-icon-label">Share</span>
        <a class="rh-social-icon-link"    href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=https%3A%2F%2Fwww.redhat.com%2Fen%2Fblog%2Finsights-about-tuning-apache-camel-application-deployed-spring-boot"
                    onclick="return !window.open(this.href, 'Facebook', 'menubar=no,toolbar=no,resizable=no,scrollbars=no,height=600,width=600')"
        target="_blank"
    >
            <span class="rh-social-icon-logo"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M18.087 10.225h4.587l-.538 5.07h-4.05V30h-6.088V15.294h-3.03v-5.07h3.03v-3.05c0-2.162.512-3.805 1.537-4.918s2.706-1.67 5.05-1.67h4.05v5.07h-2.538c-.462 0-.837.037-1.113.12-.28.074-.48.218-.606.418-.125.2-.206.406-.244.612-.038.206-.056.5-.056.88l.006 2.54z"/></svg></span>
                    </a>
    </div>
<!-- Component | social_icon -->

    <div class="rh-social-icon--component"
        data-rh-icon-background="white"
         data-rh-align="left"          data-rh-position="below"          data-rh-icon-size="xsmall"         >

        
        <a class="rh-social-icon-link"    href="https://www.linkedin.com/shareArticle?mini=true&amp;title=Insights+about+tuning+an+Apache+Camel+application+deployed+into+Spring+Boot&amp;summary=Introduction%0ATuning+is+a+very+interesting+topic+in+the+field+of+Software+Engineering.+Everybody+can+agree+that+it%E2%80%99s+important+but+I+have+%C2%A0rarely+seen+people+actually+doing+it.+This+can+be+especially+true+when+people+have+spare+computational+resources+to+spend%2C+or+if+they+are+following+these+mantras%3A+%E2%80%9Cthe+load+won%E2%80%99t+reach+at+this+point%E2%80%9D+or+%E2%80%9Clet+the+cloud+scale+it.%E2%80%9D&amp;url=https%3A%2F%2Fwww.redhat.com%2Fen%2Fblog%2Finsights-about-tuning-apache-camel-application-deployed-spring-boot"
                    onclick="return !window.open(this.href, 'LinkedIn', 'menubar=no,toolbar=no,resizable=no,scrollbars=no,height=600,width=600')"
        target="_blank"
    >
            <span class="rh-social-icon-logo"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M6.63 25.238h4.126v-12.38H6.63v12.38zm4.39-16.2c-.013-.62-.226-1.132-.645-1.538-.42-.406-.97-.606-1.662-.606-.688 0-1.25.2-1.688.606-.438.406-.65.92-.65 1.537 0 .606.213 1.12.63 1.525s.976.613 1.65.613h.02c.7 0 1.27-.206 1.694-.613s.65-.92.65-1.525zm10.442 16.2h4.125v-7.1c0-1.83-.438-3.22-1.306-4.156s-2.018-1.412-3.443-1.412c-1.62 0-2.863.694-3.73 2.088h.037v-1.8H13.02c.036.787.036 4.913 0 12.387h4.124v-6.93c0-.45.044-.79.125-1 .18-.42.443-.77.805-1.064.356-.293.8-.437 1.32-.437 1.38 0 2.068.93 2.068 2.8v6.625zm8.35-17.807v17.132c0 1.42-.5 2.625-1.505 3.63s-2.22 1.507-3.63 1.507H7.538c-1.42 0-2.626-.5-3.632-1.507-1-1.006-1.506-2.212-1.506-3.63V7.43c0-1.418.5-2.624 1.506-3.63s2.22-1.512 3.63-1.512H24.67c1.42 0 2.625.5 3.63 1.506 1.013 1.012 1.513 2.22 1.513 3.637z"/></svg></span>
                    </a>
    </div>
<!-- Component | social_icon -->

    <div class="rh-social-icon--component"
        data-rh-icon-background="white"
         data-rh-align="left"          data-rh-position="below"          data-rh-icon-size="xsmall"         >

        
        <a class="rh-social-icon-link"    href="https://twitter.com/share?text=Insights+about+tuning+an+Apache+Camel+application+deployed+into+Spring+Boot&amp;url=https%3A%2F%2Fwww.redhat.com%2Fen%2Fblog%2Finsights-about-tuning-apache-camel-application-deployed-spring-boot"
                    onclick="return !window.open(this.href, 'Twitter', 'menubar=no,toolbar=no,resizable=no,scrollbars=no,height=600,width=600')"
        target="_blank"
    >
            <span class="rh-social-icon-logo"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M30.23 6.713c-.793 1.17-1.76 2.156-2.893 2.98.012.17.02.42.02.75 0 1.545-.226 3.09-.682 4.632-.45 1.544-1.137 3.02-2.063 4.43-.925 1.414-2.02 2.67-3.294 3.757-1.275 1.087-2.806 1.956-4.606 2.606-1.794.65-3.72.97-5.762.975-3.225 0-6.175-.863-8.85-2.587.42.05.88.07 1.394.07 2.675 0 5.062-.82 7.156-2.463-1.25-.025-2.37-.406-3.356-1.15s-1.67-1.694-2.038-2.844c.394.055.756.086 1.088.086.513 0 1.02-.063 1.52-.194-1.332-.275-2.44-.938-3.314-1.988s-1.313-2.275-1.313-3.67v-.068c.806.45 1.675.694 2.606.73-.787-.524-1.412-1.205-1.875-2.05-.462-.843-.694-1.76-.694-2.75 0-1.043.263-2.018.788-2.905C5.5 6.837 7.256 8.256 9.318 9.318s4.275 1.656 6.63 1.775c-.093-.45-.143-.894-.143-1.32 0-1.593.562-2.955 1.687-4.074 1.125-1.125 2.48-1.688 4.075-1.688 1.67 0 3.07.606 4.213 1.82 1.294-.25 2.52-.714 3.656-1.395-.438 1.37-1.288 2.425-2.538 3.175 1.113-.125 2.22-.425 3.33-.9z"/></svg></span>
                    </a>
    </div>
<!-- Component | social_icon -->

    <div class="rh-social-icon--component"
        data-rh-icon-background="white"
         data-rh-align="left"          data-rh-position="below"          data-rh-icon-size="xsmall"         >

        
        <a class="rh-social-icon-link"    href="mailto:?subject=Check out this redhat.com page: Insights about tuning an Apache Camel application deployed into Spring Boot&amp;body=I saw this on redhat.com and thought you might be interested.  Click the following link to read: https://www.redhat.com/en/blog/insights-about-tuning-apache-camel-application-deployed-spring-boot"
            >
            <span class="rh-social-icon-logo"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M29.714 26.857V13.143q-.57.643-1.232 1.18-4.786 3.678-7.607 6.035-.91.768-1.482 1.196t-1.545.866-1.83.438h-.036q-.857 0-1.83-.438t-1.545-.866-1.482-1.196Q8.305 18 3.518 14.322q-.66-.536-1.232-1.18v13.715q0 .232.17.402t.402.17h26.286q.232 0 .402-.17t.17-.403zm0-18.768v-.44l-.01-.23-.053-.224-.097-.16-.16-.135-.25-.044H2.855q-.232 0-.402.17t-.17.402q0 3 2.625 5.07 3.445 2.715 7.16 5.662.107.09.625.527t.82.67.796.563.903.49.768.162h.037q.357 0 .768-.16t.902-.492.795-.563.82-.67.626-.527q3.714-2.946 7.16-5.66.965-.77 1.796-2.064t.83-2.348zM32 7.43v19.428q0 1.18-.84 2.018t-2.017.84H2.857q-1.18 0-2.018-.84T0 26.858V7.428Q0 6.25.84 5.412t2.017-.838h26.286q1.18 0 2.018.84T32 7.428z"/></svg></span>
                    </a>
    </div>
<!-- Component | social_icon -->

    <div class="rh-social-icon--component"
        data-rh-icon-background="white"
         data-rh-align="left"          data-rh-position="below"          data-rh-icon-size="xsmall"         >

        
        <a class="rh-social-icon-link"    href="javascript:window.print()"
            >
            <span class="rh-social-icon-logo"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M8.02 30.02h16v-6.045h-16v6.044zm0-14h16V8.77h-3.076c-.512 0-.95-.182-1.306-.538-.356-.356-.538-.794-.538-1.306V3.982H8.02V16.02zm21.518 1.655c0-.33-.12-.62-.363-.87-.244-.243-.53-.368-.87-.362-.33 0-.624.125-.868.363-.244.244-.363.53-.363.87 0 .336.12.624.363.868.244.244.53.363.87.363.33 0 .624-.12.868-.363.244-.25.363-.538.363-.87zm2.462 0v7.713c0 .17-.063.313-.18.43-.126.126-.27.182-.432.182h-5.363v4.156c0 .512-.18.95-.538 1.306-.356.356-.794.538-1.306.538H7.826c-.513 0-.95-.18-1.306-.538-.357-.356-.538-.794-.538-1.306V26H.62c-.17 0-.313-.063-.43-.18S0 25.55 0 25.38v-7.71c0-1.013.363-1.882 1.088-2.607s1.594-1.088 2.606-1.088h2.33V3.87c0-.514.182-.95.538-1.307s.794-.538 1.306-.538h11.23c1.632 0 2.795.95 3.157 1.306l2.462 2.926c.356.356 1.306 1.438 1.306 3.156v4.575h2.288c1.013 0 1.882.363 2.607 1.088s1.08 1.58 1.08 2.6z"/></svg></span>
                    </a>
    </div>
</div></div>                    </aside>
            </div>
</div>
                    </div>
                <div class="rh-push-pull-group-push-content">
                            




<div class="rh-push-content--layout"     data-rh-promo-context=inline     data-rh-background="gray"             >
    <div class="rh-push-content-container"       data-rh-layout="push-aside"     >
        <section class="rh-push-content-main"      data-rh-background="white"      data-rh-layout="stacked"    >
                            






    <section class="rh-divider--layout"     >
        <div class="rh-divider-container">
            <div class="rh-divider-main"     data-rh-layout="stacked"
            data-eq-pts="xs-divider: 0, lg-divider: 600"
>
                                                    <div class="rh-divider-content"     data-rh-layout="stacked"    >
                                                    




<!-- Group layout -->
    <div class="rh-group--layout"     id=blob                    data-eq-pts="xxs-group: 0, xs-group: 220, sm-group: 320, md-group: 420, lg-group: 620"
>
                            <div class="rh-group-body"      data-rh-layout="min-stacked"     >
                                    <!-- Subpattern | results_nav -->

    
    
    


    






    <section class="rh-divider--layout"     >
        <div class="rh-divider-container">
            <div class="rh-divider-main"     data-rh-layout="stacked"
            data-eq-pts="xs-divider: 0, lg-divider: 600"
>
                                    <header class="rh-divider-header"        data-rh-show-rule="xxs xs sm md lg "
>
                                                    




<!-- Group layout -->
    <div class="rh-group--layout"              data-rh-layout="min-stacked"            data-eq-pts="xxs-group: 0, xs-group: 220, sm-group: 320, md-group: 420, lg-group: 620"
>
                            <div class="rh-group-body"      data-rh-layout="flex-between-base"     >
                                    <ul class="rh-navigation-link--component"            data-rh-nav-type="back"
                    ><li class="rh-navigation-link-container"><a class="rh-navigation-link-item"                                                        href="/en/blog"
                                                >                                Back to all posts                            </a></li></ul>                                    <p class="rh-tags--component"                    ><span class="rh-tags-label">Tags:</span><a class="rh-tags-link" href="/en/blog?f%5B0%5D=taxonomy_blog_post_category_tid%3A85" >Middleware</a></p>                            </div>
                    </div>
                            <hr class="rh-divider-header-rule"/>
                                            </header>
                                            </div>
        </div>
    </section>
                                    

    <div class="rh-generic--component"         data-eq-pts="xxs-hr: 0, lg-hr: 450"
                     >
        <h2>Introduction</h2>
<p>Tuning is a very interesting topic in the field of Software Engineering. Everybody can agree that it’s important but I have  rarely seen people actually doing it. This can be especially true when people have spare computational resources to spend, or if they are following these mantras: “the load won’t reach at this point” or “let the cloud scale it.”</p>
<p>The goal of this post is to share some insights regarding tuning an Apache Camel application deployed into Spring Boot. This is not an ultimate guide for tuning and performance tests in Spring Boot applications, but more of an experience sharing during a tuning process.</p>
<p>When talking about tuning and performance tests, one thing that needs to be clear is the requirements, or what do you want to achieve by tuning an application. For example, one could say that with the computational resources they have, they aim for a 10% increase of requests the application can handle.</p>
<!--more--><p>
We created a fictional scenario to make things easier and to define a requirement where we can apply the proposed tuning configurations. Also, for you to be able to replicate the topics discussed in this post, there is a demonstration lab <a href="https://github.com/ricardozanini/camel-spring-boot-tuning">available at Github</a>. This lab has what you should need to create the environment and run the load tests while exploring the configuration changes addressed in the following sections.</p>
<h2>The Scenario</h2>
<p>Things get clearer when we demonstrate by example, so let’s use a fictional scenario to do so.</p>
<p>A customer is asking to improve the number of transactions per second (TPS) that their REST Apache Camel application deployed into Spring Boot can handle. The requirements are very strict:</p>
<ol>
<li>Can’t increase memory, CPU or disks</li>
<li>The architecture must remain intact</li>
<li>Can’t change application source code</li>
</ol>
<p>The following figure illustrates the scenario architecture:</p>
<p><a href="/cms/managed-files/2018/10/fuse_macro_architecture.png"><img class="media-element file-wysiwyg aligncenter wp-image-1977 size-full" style="" width="810" height="465" alt="" src="https://www.redhat.com/cms/managed-files/styles/wysiwyg_full_width/s3/2018/10/fuse_macro_architecture.png?itok=zeOvnnFw" /></a></p>
<p>In this use case, the Apache HTTPD Web Server acts as a proxy server, load balancer and also offers TLS support for application servers. The Web Server is proxying requests to a REST application based on <a href="http://camel.apache.org/">Apache Camel</a> and <a href="https://spring.io/projects/spring-boot">Spring Boot</a> with an embedded <a href="http://tomcat.apache.org/">Tomcat</a>. This architecture is always used by the customer when implementing REST services that are being integrated with external web services and third party applications.</p>
<p>In this scenario, requests are treated by the proxy server through an encrypted connection and then passed to the underlying Spring Boot application. The application connects to an external service, transforms or composes the received data and then returns a response to the client.</p>
<p>Every component of this architecture is compressed inside a virtual machine with 512MB of RAM and 2 vCPUs. The resources are sparse to emulate a possible real world scenario, where a  potential customer is asking for performance improvements in this environment, without having to invest in hardware resources nor modifying the architecture or the application source code.</p>
<p>With such narrow requirements, where would you start? Let’s begin our tuning plan using a very old war strategy: <i>dīvide et imperā</i> (divide and conquer).</p>
<p>Let’s navigate by each component in the architecture and explore what was done in this scenario to tune the environment. Each configuration change proposed is documented in a demonstration lab that could be replicated in other environments. In the next sections, we’re going to discuss each decision based on this example scenario.</p>
<h3>Apache HTTPD Web Server</h3>
<p>The Apache HTTPD Web Server plays an important role in the architecture by implementing connection encryption and proxying requests to underlying JVM processes.</p>
<p>When installed in a Linux machine, the HTTPD web server comes with default values that could fit most use case scenarios, but when the workload starts to increase, you might face performance problems like proxy timeout errors, low throughout, and high machine resources usage.</p>
<p>Here we’ll work with Apache 2.4, since it’s the current version and includes several bug and security fixes. The links, docs, and codes here will be related to Apache HTTPD 2.4.</p>
<h4></h4>
<h4>Switching the MPM</h4>
<p>The first thing that was done was choosing the right <a href="https://httpd.apache.org/docs/2.4/mpm.html">Multi-Processing Module</a> (MPM) for our use case scenario. By default, the MPM configured in HTTPD is prefork, which fits for <a href="https://httpd.apache.org/docs/2.4/mod/prefork.html">use cases that need compatibility with libraries that are non-thread safe</a>, like some old PHP libraries.</p>
<p>In this case, we are going to change to the worker MPM that is much more performatic and suitable for our scenario, since we don’t need HTTPD to load any non-thread safe library nor serve dynamic scripts. The worker MPM implements a multi-process multi-threaded server, and according to <a href="https://httpd.apache.org/docs/2.4/mod/worker.html">the worker documentation</a>, by using threads to serve requests, it is able to serve a large number of requests with fewer system resources than a process-based server.</p>
<p>It’s worth noting that the worker MPM might be better than prefork in other scenarios as well, as long as you don’t need compatibility with non-thread safe libraries.</p>
<p>Another approach that could be used was the <a href="https://httpd.apache.org/docs/2.4/mod/event.html">event MPM</a>, but because of a <a href="https://bz.apache.org/bugzilla/show_bug.cgi?id=53555">bug in the HTTPD version</a> we were working with at the time of this article, we decided to stick with worker.</p>
<h4></h4>
<h4>Setting the connection parameters</h4>
<p>Once the worker <a href="https://access.redhat.com/solutions/2063063">MPM is configured</a>, the next thing that to do is define a consistent number for the <a href="https://httpd.apache.org/docs/2.4/mod/mpm_common.html#maxrequestworkers">MaxRequestWorkers</a> parameter. In general, <a href="https://access.redhat.com/solutions/94773">we use 300 times the number of CPU cores for worker MPM</a>, but of course a lot of fine-tuning and experimentation have to be done. Don’t blindly set this parameter without properly testing.</p>
<p>If we just followed the general advice of 300 * CPU cores, the max number of connections that the HTTPD server would serve in our architecture is 600 (we have 2 vCPUs for each machine). But is this number realistic?</p>
<p>In our scenario, the HTTPD server and the Tomcat server are in the same machine, so they are competing for resources. The HTTPD server  should serve more requests than the Tomcat because it’s acting simply as a proxy server, while the Tomcat server is the one who is performing all the heavy work by processing our integration services.</p>
<p>Having said that, the proxy server should act like a gatekeeper to help avoid processing more requests than the underlying application server can handle. To came up with an ideal number, a lot of experimentation with load tests have to be done at the application server to figure out how many concurrent requests it can handle. After that, set a number below this one to the HTTPD. This is the final configuration I came up with:</p>
<pre>&lt;IfModule mpm_worker_module&gt;
    ThreadLimit 30
    ServerLimit 10
    StartServers 3
    MinSpareThreads 5
    MaxSpareThreads 20
    MaxRequestWorkers 300
    ThreadsPerChild 30
    MaxRequestsPerChild 0
    Timeout 30
    ProxyTimeout 30
&lt;/IfModule&gt;

</pre><p>Taking into account the machine resources that we had, in our scenario the maximum number of requests that Tomcat handled without errors, while leaving some room for the other processes in the machine, was 400. So we set the max connections to 300 in the proxy server, which proved to be a fine configuration for this scenario. This way, the workload on Tomcat won’t reach the maximum, preserving its healthy state in most situations. Also, 300 simultaneous connections was enough to address the customer’s requirements.</p>
<p>Other important parameters to pay attention to are <a href="https://httpd.apache.org/docs/2.4/mod/core.html#timeout">Timeout</a> and <a href="https://httpd.apache.org/docs/2.4/mod/mod_proxy.html#proxytimeout">ProxyTimeout</a>. Those numbers should be set equally to the underlying Tomcat server, so if the application times out, the error propagates to the client. Otherwise, you could have connections opened at the proxy server, spending valuable machine resources.</p>
<h4></h4>
<h4>Changing Proxy Pass connector to AJP</h4>
<p>The last tuning configuration that was set in this scenario is the AJP connection to the Tomcat server. A <a href="https://httpd.apache.org/docs/2.4/mod/mod_proxy.html">basic proxy pass configuration</a> is to bypass requests to the underlying server using the HTTP protocol. Instead, we used the AJP protocol, which is a binary protocol representation of the HTTP protocol that also skips HTTP header re-processing by the underlying server. This way we save a little bit of processing power. The final configuration looked like:</p>
<pre>&lt;Location /svc&gt;
    ProxyPass ajp://localhost:8009
&lt;/Location&gt;</pre><h4></h4>
<h4>Final thoughts</h4>
<p>These are the tuned configuration done so far at the HTTP server side:</p>
<ul>
<li>Switched the MPM from prefork to worker</li>
<li>Adjusted the max connections that the proxy server can handle to preserve machine resources and also protect the application server from a workload that it can’t handle</li>
<li>Set a proper timeout configuration aligned with the Tomcat server</li>
<li>Changed the proxy pass protocol from HTTP to AJP</li>
</ul>
<p>Of course, there are a lot of other things that could be done. There are other guides on the internet describing how to tune an Apache HTTPD server, but for this scenario and use case, we found that these configurations were enough to accomplish our customer requirements.</p>
<h3>Embedded Tomcat</h3>
<p>The role of the Tomcat Server in this architecture is to serve as a servlet container to the Apache Camel REST component. This implementation is managed by the Spring Boot Web as an embedded server. There are other servlet implementations to work with Spring Boot and Apache Camel like Undertow and Jetty that might perform better, but the requirements of the customer were not to change any piece of their architecture.</p>
<p>Having said that, what can be done at the configuration level to have the Apache Tomcat Server perform better?</p>
<h4></h4>
<h4>Adjusting the connection parameters</h4>
<p>First of all, like we said in the Apache HTTPD section, the Tomcat server was tested alone to figure out how many requests it could handle in the most common use cases.</p>
<p>For this task you could use the Pareto distribution to have a sample amount of requests to test the application. For example, using an API which reads, creates, and deletes customers, the read and create operation could be the most common use case. You can create a small set of sample requests and start putting some workload on your server. JMeter is a reasonable tool to do that, and we used this tool in our lab.</p>
<p>Having come up with the max concurrent requests that the application could handle during a certain period of time without breaking, we adjusted the server parameters like this:</p>
<table>
<tbody>
<tr style="padding:3px 2px;border:1px solid #000000;">
<td style="padding:3px 2px;border:1px solid #000000;"><b>Parameter</b></td>
<td style="padding:3px 2px;border:1px solid #000000;text-align:center;"><b>Value</b></td>
<td style="padding:3px 2px;border:1px solid #000000;"><b>Description</b></td>
</tr>
<tr style="padding:3px 2px;border:1px solid #000000;">
<td style="padding:3px 2px;border:1px solid #000000;">Connection Timeout (ms)</td>
<td style="padding:3px 2px;border:1px solid #000000;text-align:center;">30000</td>
<td style="padding:3px 2px;border:1px solid #000000;">This value <b>is aligned with the Apache HTTPD proxy server timeout </b>and has shown to be a reasonable number for our scenario.</td>
</tr>
<tr>
<td style="padding:3px 2px;border:1px solid #000000;">Compression</td>
<td style="padding:3px 2px;border:1px solid #000000;text-align:center;">False</td>
<td style="padding:3px 2px;border:1px solid #000000;">We are serving only small JSON payloads, and in our tests the compression didn’t make any noticeable difference. Besides, this can be set only at the proxy server level.</td>
</tr>
<tr>
<td style="padding:3px 2px;border:1px solid #000000;">Max Connections</td>
<td style="padding:3px 2px;border:1px solid #000000;text-align:center;">400</td>
<td style="padding:3px 2px;border:1px solid #000000;">A little more than the <b>max connections at the proxy server side</b>, so we had room to handle extra connections that could come between requests.</td>
</tr>
<tr>
<td style="padding:3px 2px;border:1px solid #000000;">Max Threads</td>
<td style="padding:3px 2px;border:1px solid #000000;text-align:center;">300</td>
<td style="padding:3px 2px;border:1px solid #000000;">This number seems reasonable for our resources and number of connections to handle. <a href="https://tomcat.apache.org/tomcat-8.0-doc/config/ajp.html#Standard_Implementations"><b>Each thread can handle more than one connection</b></a>.</td>
</tr>
<tr>
<td style="padding:3px 2px;border:1px solid #000000;">Min Spare Threads</td>
<td style="padding:3px 2px;border:1px solid #000000;text-align:center;">300</td>
<td style="padding:3px 2px;border:1px solid #000000;">There’s no warm up for this server, which means that during high load there is <b>no need to create more threads reaching the max to handle all the requests</b>. But during idle or low workloads, these threads are up, although doing nothing. In our scenario, there wasn’t too much idle time that would justify decreasing this number.</td>
</tr>
<tr>
<td style="padding:3px 2px;border:1px solid #000000;">Accept Count</td>
<td style="padding:3px 2px;border:1px solid #000000;text-align:center;">100</td>
<td style="padding:3px 2px;border:1px solid #000000;">The number of connections waiting to be handled. If we reach the max connection number, the server starts to stack requests in this queue before denying a reply to the client.</td>
</tr>
</tbody>
</table>
<p>&#160;</p>
<p>Of course, a lot of experimentation and load tests had been done. These numbers are for reference only and are the ones set in our lab. These numbers can be completely different depending on your requirements. Just keep in mind the responsibility of evaluating each parameter and determining what you can do to improve the performance of your server by fine-tuning each one. Take a look at the <a href="https://tomcat.apache.org/tomcat-8.0-doc/config/ajp.html#Standard_Implementations">documentation</a> to understand the parameters that can be configured in the Tomcat connectors.</p>
<h4></h4>
<h4>Using Tomcat Native Connectors</h4>
<p>The next adjustment made on the Tomcat server was to use the native connectors to handle the connections coming up from the proxy server. Quoting from <a href="http://tomcat.apache.org/native-doc/">the official documentation</a>:</p>
<p>“<i>The Apache Tomcat Native Library is an optional component for use with Apache Tomcat that allows Tomcat to use certain native resources for performance, compatibility, etc.</i>”</p>
<p>The decision to use the native libraries was guided by the <a href="https://github.com/spring-projects/spring-boot/issues/7376">performance improvements</a> this can offer versus the standard Java libraries like BIO or NIO, leveraging from the OS capabilities to handle I/O operations.</p>
<p>For this to work we had to <a href="https://tomcat.apache.org/tomcat-8.0-doc/apr.html#Linux">install the APR library</a> on our server, employ the native connectors, and create <a href="https://github.com/ricardozanini/camel-spring-boot-tuning/blob/master/src/main/java/samples/camel/spring/boot/CamelRestApplication.java">a custom embedded Tomcat server constructor</a> on the Spring Boot side. The custom constructor was also used to set the configuration listed in the table above, because not all the Tomcat configurations can be set using the default application properties from the Spring Boot Tomcat embedded server.</p>
<pre>@Bean
public EmbeddedServletContainerFactory servletContainer() {
  TomcatEmbeddedServletContainerFactory tomcat = new TomcatEmbeddedServletContainerFactory();
  tomcat.addConnectorCustomizers(this.customizer(tomcat));
  if (ajpPort != null) {
    Connector ajpConnector = new Connector(PROTOCOL);
    if (enableApr) {
      tomcat.addContextLifecycleListeners(new AprLifecycleListener());
      ajpConnector = new Connector("org.apache.coyote.ajp.AjpAprProtocol");
    }

  ajpConnector.setPort(ajpPort);
  tomcat.addAdditionalTomcatConnectors(ajpConnector);
  }
  return tomcat;
}</pre><h4></h4>
<h4>Final thoughts</h4>
<p>The customizations made on the Tomcat side to tune our environment were:</p>
<ul>
<li>Set the max connections and timeout values to align with the Apache HTTPD web server and prevent excessive load on the Tomcat server.</li>
<li>Installed APR and used the native AJP connector for I/O performance improvements.</li>
<li>Customized the default Spring Boot embedded Tomcat constructor to set the properties not externalized by the Spring Boot properties component.</li>
<li>Tweaked the connection and thread parameters to establish numbers that performed well during our load tests.</li>
</ul>
<p>Besides the requirement from our customer to not change the source code, this custom embedded Tomcat can be placed in the actual embedded server dependency of a project. Alternately, we can go further and create a patch, since the Spring Boot project limits our ability to change the default connector.</p>
<p>There isn’t much to do at the Tomcat side besides experimentation. The main focus should be with the application that is using its servlet capabilities. A common scenario is a bad performatic application taking too long to return a reply, resulting in a bad experience for the client. But we can leverage several Tomcat parameters and connector implementations to improve the way that the server handles connections.</p>
<h3>Apache Camel and Spring Boot</h3>
<p>We finally arrive at the application layer after tweaking several knobs on the proxy and servlet server.</p>
<h4></h4>
<h4>Tuning the GC algorithm</h4>
<p>The Spring Boot component ties the embedded Tomcat server and the Apache Camel routes and components together. All of these components run on the same Java Virtual Machine (JVM) process, so we decided to start by tuning the JVM Garbage Collector (GC) algorithm.</p>
<p>Garbage Collector tuning deserves an entire article dedicated to it. As with the Apache HTTPD server tuning, there’s other articles on the internet talking about this subject. If you’re interested in a deep dive into it, give it a try using <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/index.html">Oracle’s JVM Tuning documentation</a>. This documentation doesn’t cover any particular use cases, but it provides good explanations of the structure of each algorithm.</p>
<p>If not set, the JVM tries to tune the GC by itself in a process called <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/ergonomics.html#ergonomics">ergonomics</a>. This could work in environments with a small load, but in our scenario, we decided to take control of our GC algorithm and experiment with it. In the end, the G1 was the chosen one. The decision was based on the following criteria:</p>
<ol>
<li>It’s the algorithm that performed better at our tests, taking into account our scenario, resources and architecture.</li>
<li>It’s optimized to maximize the throughput with small pauses during the application life cycle, favoring REST applications that have high-throughput requirements.</li>
</ol>
<p>If you have little or no knowledge about GC tuning, a starting point could be <a href="https://access.redhat.com/labs/jvmconfig/">Red Hat’s JVM configuration Lab</a> (subscription required). The Lab gives you some options to configure your GC that can lead you into fine-tuning once an algorithm is chosen.</p>
<p>Some aspects of the GC that you should take care of:</p>
<ol>
<li><b>Too many “full GCs” during application load</b>. To perform a full GC, the GC starts an event called “stop the world” that is a pause in every running thread to free up memory. During those pauses, nothing is processed at the JVM, which might increase the application response time.</li>
<li><b>Long pauses</b>. Even if the GC are not performing too many “stop the world” events, it’s important to take a look into the pause times. Depending on your requirements, pauses of 1 second or more could impact your application. There are configurations to try to control such behavior.</li>
</ol>
<p>A good tool to analyse the GC is <a href="https://github.com/mgm3746/garbagecat">Garbagecat</a> or the gceasy website. The last one can give you a high level GC analysis based on your logs and could be a good starting point to understand the behavior of your GC.</p>
<p>Besides the GC algorithm chosen, there are two configurations that you should always set in any JVM configuration:</p>
<ol>
<li><b>GC logs output</b>: to examine your GC behavior during the application load, you must enable the GC logs. You should not  worry since you shouldn’t lose any performance and the logs will come in handy during troubleshooting.</li>
<li><b>Heap dump on out of memory error</b>: this is a must if you’re running into memory problems. The heap dump is a valuable artifact for memory leak troubleshooting or memory usage analysis. Just add the following option to your JVM configuration: -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=&lt;path&gt;. To analyze the heap generated by the JVM, you could use the Eclipse Memory Analyzer Tool (MAT).</li>
</ol>
<h4></h4>
<h4>Switching to a async log appender</h4>
<p>In this particular scenario we observed that the application had heavy audit log requirements. In our scenario, the application logged every input and output message for auditing and monitoring purposes. In a high load environment this could lead to a high disk usage during the current execution thread.</p>
<p>The default implementation of popular logs frameworks in Java is the synchronous log, that is, every time the application needs to log something in the disk, the current execution thread is responsible for writing the log content to the disk.</p>
<p>To avoid interfering in the current execution thread while writing to the disk, we switched the log appender to an asynchronous one. The log implementation is Logback, which has an <a href="https://logback.qos.ch/manual/appenders.html#AsyncAppender">interesting async feature</a> that can minimize the risk of losing logs. We ended up with the following configuration:</p>
<pre>&lt;appender name="ASYNC-app" class="ch.qos.logback.classic.AsyncAppender"&gt;
   &lt;appender-ref ref="app" /&gt;
   &lt;discardingThreshold&gt;0&lt;/discardingThreshold&gt;
   &lt;queueSize&gt;500&lt;/queueSize&gt;
&lt;/appender&gt;</pre><p>Setting the option “discardingThreshold” to zero, the appender won’t discard any log events even if the queue is full, but the blocking queue will stop until everything is written. Some experimentation is needed to adjust queue size with the expected load. Ideally, this queue does not reach its limit.</p>
<h4></h4>
<h4>Final thoughts</h4>
<p>Finally, in the end we came up with the following conclusions:</p>
<ol>
<li>JVM tuning and experimentation: we decided to go with with G1 algorithm due to its throughput maximization nature.</li>
<li>GC logs were turned on to capture data to be analyzed later, giving us valuable information used to configure the GC algorithm.</li>
<li>Turned the log appenders to async due to the high audit log usage by the Apache Camel routes.</li>
</ol>
<p>The Spring Boot Apache Camel Java application was the last part of our scenario’s architecture to be reviewed.</p>
<h2>The Replication Lab</h2>
<p>Each tuning aspect discussed up to this point in our example scenario can be explored using a demonstration lab available at our repository in Github.</p>
<p>This lab replicates  tools and machines used during our experience of tuning this architecture. The lab was created to support this article and to serve as a sandbox for anyone who wants to experiment with this scenario and compare each aspect of tuning. The figure below illustrates the components provided by this lab:</p>
<p><a href="/cms/managed-files/2018/10/screenshot-from-2018-10-11-11-50-07.png"><img class="media-element file-wysiwyg aligncenter size-full wp-image-1978" style="" alt="" src="https://www.redhat.com/cms/managed-files/styles/wysiwyg_full_width/s3/2018/10/screenshot-from-2018-10-11-11-50-07.png?itok=xeJzTrVN" width="825" height="384" /></a></p>
<p>The lab is composed of a Vagrant file, ansible playbooks and a demo Spring Boot Apache Camel application. With Vagrant you can set up a virtual environment in an operating system. Ansible also plays an important role since we used it to:</p>
<ol>
<li><b>Install the required software</b>: the HTTPD Server, Java, Python 3 and PCP (Performance Co-Pilot).</li>
<li><b>Deploy the application and the mock external service</b>: the Spring Boot application is installed as a systemd service with its configuration set in the startup scripts. Ansible also runs a script to provide a Python 3 web service for mocking external calls from the Apache Camel routes.</li>
<li><b>Open the required ports</b> for PCP and JMX monitoring.</li>
<li><b>Apply the tuned configurations</b> on every component of the architecture: HTTPD and Spring Boot configuration, APR and Tomcat native connectors.</li>
</ol>
<p>For more detailed information about how Ansible was used in this lab, take a look at the <a href="https://github.com/ricardozanini/camel-spring-boot-tuning/blob/master/vagrant/ansible/playbook.yml">playbooks</a>.</p>
<p>To be able to run this lab in your environment, you must first install the required tools, which are basically Maven, Vagrant and Ansible. After that, just run the script start.sh and you should be ready to go. For a detailed explanation of how to use this demo, refer to the <a href="https://github.com/ricardozanini/camel-spring-boot-tuning/blob/master/README.md">instructions in the Github repository</a>.</p>
<h3>Load Tests</h3>
<p>The <a href="https://github.com/ricardozanini/camel-spring-boot-tuning">demo lab</a> also includes a JMeter <a href="https://github.com/ricardozanini/camel-spring-boot-tuning/blob/master/jmeter/load_test.jmx">load test project</a> ready to be used. This load test was configured to run simultaneously in both machines (default and tuned) to be able to compare the benchmarks and their behavior at the same time.</p>
<p>The test spares 150 threads and has a ramp-up period curve of two and a half minutes. This means that every second one user is added to the test until a total of 150 is reached. Once this threshold is reached, the test continues indefinitely.</p>
<p>In our tests, after approximately ten minutes the machine that hadn’t been tuned stopped answering our requests and started to return proxy errors. After investigation, we discovered that the JVM just stopped responding, or the process exhausted its resources and stopped itself. The tuned machine kept responding to approximately almost all of the requests until we stopped the test.</p>
<p>The table below illustrates the test results of one of our test runs, performed during 20 minutes:</p>
<p><a href="/cms/managed-files/2018/10/statistics_load.png"><img class="media-element file-wysiwyg aligncenter size-full wp-image-1979" style="" alt="" src="https://www.redhat.com/cms/managed-files/styles/wysiwyg_full_width/s3/2018/10/statistics_load.png?itok=PA3kybHo" width="1022" height="246" /></a></p>
<p>The tuned machine kept a regular pacing of responses while the untouched one started to time out our requests:</p>
<pre>Non HTTP response code: org.apache.http.conn.ConnectTimeoutException/Non HTTP response message: Connect to app.local:80 timed out</pre><p>Looking at the transactions per second (TPS) chart, we can visually confirm the difference between them:</p>
<p><a href="/cms/managed-files/2018/10/tps.png"><img class="media-element file-wysiwyg aligncenter size-full wp-image-1980" style="" alt="" src="https://www.redhat.com/cms/managed-files/styles/wysiwyg_full_width/s3/2018/10/tps.png?itok=x4u2Qgx9" width="1082" height="536" /></a></p>
<p>At first, both machines kept almost the same TPS, but over time the tuned one was more reliable.</p>
<p>Observing each machine’s resource usage, things get more interesting. The charts below were taken from running this same test using PCP:</p>
<p><a href="/cms/managed-files/2018/10/load_average_app1.png"><img class="media-element file-wysiwyg aligncenter size-full wp-image-1981" style="" alt="" src="https://www.redhat.com/cms/managed-files/styles/wysiwyg_full_width/s3/2018/10/load_average_app1.png?itok=F5obMt1k" width="659" height="302" /></a></p>
<p><a href="/cms/managed-files/2018/10/load_average_app2.png"><img class="media-element file-wysiwyg aligncenter size-full wp-image-1982" style="" alt="" src="https://www.redhat.com/cms/managed-files/styles/wysiwyg_full_width/s3/2018/10/load_average_app2.png?itok=28RzMDWK" width="659" height="300" /></a></p>
<p>The load average on the default machine, executing the same processes, with the same workload as the tuned machine, had twice the system load when compared to the tuned one.</p>
<p>You can try this performance test for yourself by using the <a href="https://github.com/ricardozanini/camel-spring-boot-tuning">Github repository</a> as a reference to set up your own environment. You should be able to expect similar results to the results discussed in this post. Try running other kinds of tests like bursting a ton of requests in a short period of time, or even increasing the load above 150 users.</p>
<h2>Conclusion</h2>
<p>In this post we discussed some aspects of tuning an Apache Camel REST application deployed into Spring Boot serving HTTP requests behind a proxy server, and how to exercise what was discussed by replicating the fictional scenario using a demonstration lab.</p>
<p>It’s worth noting that even if a component or software comes out of the box ready to use, such as the HTTPD server using the MPM prefork or the JVM ergonomics, your application can be extensively improved by running performance tests and configuring the environment accordingly.</p>
<p>The tuning topics addressed in this post aren’t rocket science nor should  they be too difficult to implement. Today, if you neglect tuning, the platform could hide bottlenecks from you by scaling your application once it reaches a certain limit, or by restarting the container if the application stops responding.</p>
<p>Even if your cloud platforms are engineered to maintain application reliability at high levels, it should be worth the time required to properly tune your application. Tuning allows you to leverage the platform and your computational resources even more, while still improving your overall application quality metrics.</p>

    </div>
                            </div>
                    </div>
                                                            <hr class="rh-divider-content-rule"/>
                                                                                




<!-- Group layout -->
    <div class="rh-group--layout"                         data-eq-pts="xxs-group: 0, xs-group: 220, sm-group: 320, md-group: 420, lg-group: 620"
>
                            <div class="rh-group-body"      data-rh-layout="stacked"     >
                                    




<!-- Group layout -->
    <div class="rh-group--layout"                         data-eq-pts="xxs-group: 0, xs-group: 220, sm-group: 320, md-group: 420, lg-group: 620"
>
                            <div class="rh-group-body"      data-rh-layout="stacked"     >
                                    <div class="rh-card-header--component"                            ><h3 class="rh-card-header-title">About the author</h3></div>                                    




<!-- Group layout -->
    <div class="rh-group--layout"                         data-eq-pts="xxs-group: 0, xs-group: 220, sm-group: 320, md-group: 420, lg-group: 620, wide-box: 640"
>
                            <div class="rh-group-body"      data-rh-layout="wide-two-col"     >
                                    <!-- Subpattern | speaker -->


    





                        
        
    

    



   
    







    





<!-- Group layout -->
    <div class="rh-group--layout"                         data-eq-pts="xxs-group: 0, xs-group: 220, sm-group: 320, md-group: 420, lg-group: 620, small: 200, medium: 320, large: 600, xlarge: 700"
>
                            <div class="rh-group-body"      data-rh-layout="stacked"     >
                                    




<!-- Group layout -->
    <div class="rh-group--layout"                         data-eq-pts="xxs-group: 0, xs-group: 220, sm-group: 320, md-group: 420, lg-group: 620"
>
                            <div class="rh-group-body"      data-rh-layout="media-object-sm"     >
                                    


    <div class="rh-image-embed--component"
                 data-rh-align="center"         data-rh-ratio="circle"        
         data-rh-image-embed=no-speaker         data-rh-img-background="gray"        >

        <div class="rh-image-embed-container">
                            <a class="rh-image-embed-link" href="/en/authors/ricardo-zanini-fernandes">
                                                                      </a>
                                </div>
            </div>
                                    




<!-- Group layout -->
    <div class="rh-group--layout"     id=name_social_image_group                    data-eq-pts="xxs-group: 0, xs-group: 220, sm-group: 320, md-group: 420, lg-group: 620, social-md: 460, social-xl: 460"
>
                            <div class="rh-group-body"      data-rh-layout="min-stacked"     >
                                    <div class="rh-person--component"        itemscope itemtype="http://schema.org/Person"
         data-rh-align="left"                 data-rh-link-wrap      ><a class="rh-person-link-wrap" href="/en/authors/ricardo-zanini-fernandes"><h3 class="rh-person-name-small" itemprop="name">
                Ricardo Zanini Fernandes            </h3></a></div>                            </div>
                    </div>
                            </div>
                    </div>
                                    




<!-- Group layout -->
                            </div>
                    </div>
                            </div>
                    </div>
                            </div>
                    </div>
                            </div>
                    </div>
                                                                        </div>
                            </div>
        </div>
    </section>
                    </section>
                    <aside class="rh-push-content-aside"      data-rh-layout="stacked"    

            data-eq-pts="xxs-box: 0, sm-aside: 290">
                                    




<!-- Group layout -->
    <div class="rh-group--layout"     data-rh-push=left                    data-eq-pts="xxs-group: 0, xs-group: 220, sm-group: 320, md-group: 420, lg-group: 620"
>
                            <div class="rh-group-body"      data-rh-layout="stacked"     >
                                    <!-- Pattern | raw_html -->

<form><div class="rh-search--component" >
    <label class="rh-search-label" for="search">Search all Red Hat blogs</label>
    <input class="rh-search-field" required maxlength="128" size="15" placeholder="Search all Red Hat blogs" type="text" id="search" data-rh-search-input name="search" value="">
    <div class="rh-search-clear" data-rh-search-clear tabindex="0"></div>
    <button class="rh-search-link" data-rh-cta-type="button" type="submit" formaction="/en/blog/search-proxy" title="">
        Search    </button>
</div>
</form>                                    <!-- Subpattern | subscribe -->
<!-- Component | social_icon -->

    <div class="rh-social-icon--component"
        data-rh-icon-background="orange"
         data-rh-align="left"                  data-rh-icon-size="xsmall"          data-rh-nobreak>

        <span class="rh-social-icon-label">Subscribe via RSS</span>
        <a class="rh-social-icon-link"    href="/en/rss/blog/"
     title="Subscribe via RSS"                onclick="return !window.open(this.href, 'RSS', 'menubar=no,toolbar=no,resizable=no,scrollbars=no,height=600,width=600')"
        target="_blank"
    >
            <span class="rh-social-icon-logo"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M9.63 26.194c0 2.11-1.71 3.82-3.818 3.82-2.11 0-3.82-1.71-3.82-3.82s1.71-3.82 3.82-3.82 3.82 1.71 3.82 3.82zM2 12.144c9.863 0 17.856 7.994 17.856 17.856H14.65c0-6.98-5.662-12.644-12.644-12.644v-5.213z"/><path d="M2 2.02c15.45 0 27.98 12.524 27.98 27.98h-5.374C24.606 17.52 14.486 7.394 2 7.394V2.02z"/></svg></span>
                    </a>
    </div>
                                    <!-- Pattern | raw_html -->

<!-- Subpattern | teaser_list -->

        

<!-- For related_posts on blog pages -->
                

            









    






<!-- Card layout -->
<div class="rh-card--layout"    data-rh-background="white"
            data-rh-theme="light"
        
        data-rh-bg-align="cover"
    
        data-rh-layout="min-stacked"

            data-eq-pts="xxs-box: 0, xs-box: 202, sm-box: 302, md-box: 402, lg-box: 502, xl-box: 602, xxl-box: 702, box-edges: 262"
                        
            data-rh-border="thin"><header class="rh-card-header"        >
                            
                    
                    




                        


        <header class="rh-standard-header--component"     data-rh-align=left
                  >
        <div class="rh-standard-header-container">
                                    <p class="rh-standard-header-headline-small" >Related posts</p>                    </div>
            </header>
                    </header>
    <div class="rh-card-content"    data-rh-layout="stacked"
    >
                            


    <ul class="rh-list--layout"         
            data-eq-pts="xs-list: 0, sm-list: 220, md-list: 320"
     data-rh-list-style="flush">
                                    <li class="rh-list-item">
                    
<div class="rh-mini-article-teaser--component">
            <h5 class="rh-mini-article-teaser-headline" data-rh-style="small"><a href="/en/blog/evolution-application-connectivity-multicloud-environment" title="">                The evolution of application connectivity in a multicloud environment            </a></h5>        </div>
                </li>
                            <li class="rh-list-item">
                    
<div class="rh-mini-article-teaser--component">
            <h5 class="rh-mini-article-teaser-headline" data-rh-style="small"><a href="/en/blog/application-connectivity-hybrid-cloud" title="">                Application connectivity in a hybrid cloud            </a></h5>        </div>
                </li>
                            <li class="rh-list-item">
                    
<div class="rh-mini-article-teaser--component">
            <h5 class="rh-mini-article-teaser-headline" data-rh-style="small"><a href="/en/blog/red-hat-response-java-release-cadence-change" title="">                Red Hat response to Java release cadence change            </a></h5>        </div>
                </li>
                        </ul>
                    </div>
    </div>
                            </div>
                    </div>
                            </aside>
            </div>
</div>
                    </div>
    </div>

</div>
  </div>
        
  </div>

  <footer>
      <section class="rc-footer-menu" data-rc-toggle-id="footer-extended" >
      <div class="container rc-footer-menu-container">
        <nav class="row rc-footer-menu-about-items"><div class="rc-footer-menu-about-col foot-about foot-about"><div class="rc-footer-menu-list-header"><h3 class="rc-footer-menu-list-header-title">About</h3></div><p class="rc-footer-menu-about-description">We’re the world’s leading provider of enterprise open source solutions, using a community-powered approach to deliver high-performing Linux, cloud, container, and Kubernetes technologies. We help you standardize across environments, develop cloud-native applications, and integrate, automate, secure, and manage complex environments with award-winning support, training, and consulting services.</p><ul class="rc-footer-menu-about-list"><li><a href="/en/about/company">Company information</a></li>
<li><a href="/en/jobs-overview">Jobs</a></li>
<li><a href="/en/about/office-locations">Locations</a></li>
<li><a href="/en/about/development-model">Development model</a></li>
<li><a href="/en/events">Events</a></li>
<li><a href="/en/about/newsroom">Newsroom</a></li>
<li><a href="/en/blog">Blog</a></li>
<li><a href="https://coolstuff.redhat.com/">Cool Stuff Store</a></li>
<li><a href="/en/about/our-culture/diversity-equity-inclusion/statement">Diversity, equity, and inclusion</a></li>
<li><span class="nolink"><span></span></span></li>
</ul><div class="rc-footer-menu-social-links"><nav id="foot-social"><ul><li class="first leaf"><a href="http://www.linkedin.com/company/red-hat" class="icon-linkedin-sign"></a></li>
<li class="leaf"><a href="http://www.youtube.com/user/RedHatVideos" class="icon-youtube"></a></li>
<li class="leaf"><a href="https://www.facebook.com/redhatinc" class="icon-facebook"></a></li>
<li class="last leaf"><a href="https://twitter.com/RedHat" class="icon-twitter"></a></li>
</ul></nav></div></div>
</nav>        <nav class="row rc-footer-menu-items"><div class="rc-footer-menu-col foot-products"><div class="rc-footer-menu-list-header" data-rc-state="closed" data-rc-toggle-visuals="xxs xs sm " aria-expanded="false" tabindex="0"><span class="rc-footer-menu-list-header-indicator" data-rc-indicator-symbol="plus" data-rc-hidden-at="lg "></span><h3 class="rc-footer-menu-list-header-title">Products</h3></div><ul class="rc-footer-menu-list" data-rc-toggle-target="xxs xs sm" data-rc-state="closed" data-rc-toggle="hide" aria-expanded="false"><li><a href="/en/technologies/management/ansible">Red Hat Ansible Automation Platform</a></li>
<li><a href="/en/technologies/linux-platforms/enterprise-linux">Red Hat Enterprise Linux</a></li>
<li><a href="/en/technologies/cloud-computing/openshift">Red Hat OpenShift</a></li>
<li><a href="/en/technologies/cloud-computing/openshift-data-foundation">Red Hat OpenShift Data Foundation</a></li>
<li><a href="/en/technologies/linux-platforms/openstack-platform">Red Hat  OpenStack Platform</a></li>
<li><a href="/en/technologies/all-products">See all products</a></li>
</ul></div>
<div class="rc-footer-menu-col foot-tools"><div class="rc-footer-menu-list-header" data-rc-state="closed" data-rc-toggle-visuals="xxs xs sm " aria-expanded="false" tabindex="0"><span class="rc-footer-menu-list-header-indicator" data-rc-indicator-symbol="plus" data-rc-hidden-at="lg "></span><h3 class="rc-footer-menu-list-header-title">Tools</h3></div><ul class="rc-footer-menu-list" data-rc-toggle-target="xxs xs sm" data-rc-state="closed" data-rc-toggle="hide" aria-expanded="false"><li><a href="https://sso.redhat.com">My account</a></li>
<li><a href="https://access.redhat.com">Customer support</a></li>
<li><a href="https://connect.redhat.com/">Partner resources</a></li>
<li><a href="https://developers.redhat.com/">Developer resources</a></li>
<li><a href="/en/services/training-and-certification">Training and certification</a></li>
<li><a href="https://learn.redhat.com/">Learning community</a></li>
<li><a href="https://catalog.redhat.com/">Red Hat Ecosystem Catalog</a></li>
<li><a href="/en/resources">Resource library</a></li>
</ul></div>
<div class="rc-footer-menu-col foot-try-buy-sell"><div class="rc-footer-menu-list-header" data-rc-state="closed" data-rc-toggle-visuals="xxs xs sm " aria-expanded="false" tabindex="0"><span class="rc-footer-menu-list-header-indicator" data-rc-indicator-symbol="plus" data-rc-hidden-at="lg "></span><h3 class="rc-footer-menu-list-header-title">Try, buy, sell</h3></div><ul class="rc-footer-menu-list" data-rc-toggle-target="xxs xs sm" data-rc-state="closed" data-rc-toggle="hide" aria-expanded="false"><li><a href="/en/products/trials">Product trial center</a></li>
<li><a href="https://www.redhat.com/en/store">Red Hat Store</a></li>
<li><a href="https://marketplace.redhat.com">Red Hat Marketplace</a></li>
<li><a href="/en/about/japan-buy">Buy online (Japan)</a></li>
<li><a href="http://redhat.force.com/finder/">Find a partner</a></li>
<li><a href="/en/contact">Contact sales</a></li>
<li><a href="/en/services/training-and-certification/contact-us">Contact training</a></li>
<li><a href="/en/services/consulting-overview#contact-us">Contact consulting</a></li>
</ul></div>
<div class="rc-footer-menu-col foot-communicate"><div class="rc-footer-menu-list-header" data-rc-state="closed" data-rc-toggle-visuals="xxs xs sm " aria-expanded="false" tabindex="0"><span class="rc-footer-menu-list-header-indicator" data-rc-indicator-symbol="plus" data-rc-hidden-at="lg "></span><h3 class="rc-footer-menu-list-header-title">Communicate</h3></div><ul class="rc-footer-menu-list" data-rc-toggle-target="xxs xs sm" data-rc-state="closed" data-rc-toggle="hide" aria-expanded="false"><li><a href="/en/contact">Contact us</a></li>
<li><a href="/en/about/feedback">Feedback</a></li>
<li><a href="/en/about/social">Social</a></li>
<li><a href="https://engage.redhat.com/Global-Preference-Center?newsletter=RH-Shares&amp;intcmp=7016000000154xCAAQ">Red Hat newsletter</a></li>
</ul></div>
</nav>      </div>
    </section>
        <section class="rc-footer-traditional">
      <div class="container rc-footer-traditional-container">
        <section class="rc-footer-traditional-section">
          <div class="rc-footer-traditional-logo">
            <div class="row">
              <a href="/en">
                <img src="/profiles/rh/themes/redhatdotcom/img/logo.svg" class="screen" title="Red Hat" />
                </a>
            </div>
          </div>
          <div id="legal" class="rc-footer-traditional-legal">
            <div class="row">
              <div class="copyright">© 2022 Red Hat, Inc.</div>
              <div >
                <ul class="menu"><li class="first leaf"><a href="/en/about/privacy-policy">Privacy statement</a></li>
<li class="leaf"><a href="/en/about/terms-use">Terms of use</a></li>
<li class="leaf"><a href="/en/about/all-policies-guidelines">All policies and guidelines</a></li>
<li class="leaf"><a href="/en/about/digital-accessibility">Digital accessibility</a></li>
<li class="last leaf"><span id="teconsent" class="nolink">|</span></li>
</ul>              </div>
            </div>
                      </div>
          <div class="rc-footer-traditional-event-logo">
            <div id="block-block-5" class="block block-block block-footer-promote">

      
  <a href="https://www.redhat.com/summit"><img src="https://www.redhat.com/cms/managed-files/Logo-Red_Hat-Summit-A-Standard-RGB-02_0.svg" alt="Red Hat Summit" style="float: right;" width="72px"></a>
</div>
          </div>
        </section>
      </div>
    </section>
  </footer>
        <script type="text/javascript" src="/sites/default/files/advagg_js/js__Wqei0xAeTP7iRc2zw0xoCasBBIyh1kCF4fU7LpOh3PE__zVrfOovDoGMapT3lFo2ebFG3Ez8gEOxRdOuoBNBb4jY__uaCwYofnUZLAnB7x3Q6WyVKHfqU6f9iB6Wi31ydea6c.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
  if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
      _satellite.pageBottom();
  }
//--><!]]>
</script>
    </div>
  <script type="text/javascript"  src="/12h0D-ZO7Bhy5/9jU8uh1aiY8/Ye8/abbubmDw/KmVoZEZJ/XG0vJCZA/eG0"></script></body>
</html>
