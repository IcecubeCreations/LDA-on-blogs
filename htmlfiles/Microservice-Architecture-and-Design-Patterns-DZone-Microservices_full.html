
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Learn about the design patterns of microservice software architecture to overcome challenges like loosely coupled services, defining databases, and more.">
  <meta name="keywords" content="microservice, web service, mobile app, Database, Design, Relational database, requests, Circuit Breaker Pattern, data, Spring Cloud">

  <meta property="og:description" content="Learn about the design patterns of microservice software architecture to overcome challenges like loosely coupled services, defining databases, and more.">
  <meta property="og:site_name" content="dzone.com">
  <meta property="og:title" content="Microservice Architecture and Design Patterns - DZone Microservices">
  <meta property="og:url" content="https://dzone.com/articles/design-patterns-for-microservices">
  <meta property="og:image" content="https://dz2cdn2.dzone.com/storage/article-thumb/10477269-thumb.jpg">
  <meta property="og:type" content="article">

  <meta name="twitter:site" content="@DZoneInc">
  <meta name="twitter:image" content="https://dz2cdn2.dzone.com/storage/article-thumb/10477269-thumb.jpg">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:description" content="Learn about the design patterns of microservice software architecture to overcome challenges like loosely coupled services, defining databases, and more.">
  <meta name="twitter:title" content="Microservice Architecture and Design Patterns - DZone Microservices">

  <meta name="referrer" content="origin-when-cross-origin">
  <meta name="google-site-verification" content="kndbhxcupfEqWmZclhCpB6vlgOs7QSmx2UHAGGnP2mA">
  <meta name="df-verify" content="df0d76632b4543">

  <link rel="icon" type="image/x-icon" href="https://dz2cdn2.dzone.com/themes/dz20/images/favicon.png">
  <link rel="image_src" href="https://dz2cdn2.dzone.com/storage/article-thumb/10477269-thumb.jpg">
  <link rel="canonical" href="https://dzone.com/articles/design-patterns-for-microservices">

  <title>Microservice Architecture and Design Patterns - DZone Microservices</title>

  <link rel="preload" href="https://fonts.dzone.com/themes/dz20/font/fontello.woff?11773374" as="font" type="font/woff" crossorigin="anonymous">

  <link rel="stylesheet" media="all" href="https://dz2cdn2.dzone.com/themes/dz20/ftl/icons.css">
  <link rel="stylesheet" media="all" href="https://dz2cdn2.dzone.com/themes/dz20/lib/static/bootstrap/bootstrap.min.css">
  <link rel="stylesheet" media="all" href="https://dz2cdn2.dzone.com/themes/dz20/ftl/article/global.css">
  <link rel="stylesheet" media="all" href="https://dz2cdn2.dzone.com/themes/dz20/ftl/header/styles.css">
</head>
<body>
<div id="ftl-header">
  <div class="container-fluid header">
    <div class="row">
      <div class="col-md-12" style="padding: 0;">
        <div class="header-top">
          <div class="header-container">
            <div class="pull-left logo-container">
              <div class="logo">
                <a class="inner" href="/">
                  <picture>
                    <source srcset="https://dz2cdn2.dzone.com/themes/dz20/images/dz_logo_2021_cropped.webp" type="image/webp">
                    <source srcset="https://dz2cdn2.dzone.com/themes/dz20/images/dz_logo_2021_cropped.png" type="image/png">
                    <img src="https://dz2cdn2.dzone.com/themes/dz20/images/dz_logo_2021_cropped.png" width="160" height="52" alt="DZone">
                  </picture>
                </a>
              </div>

                <div class="active-portal"><a href="/microservices-news-tutorials-tools">Microservices Zone</a></div>
            </div>

            <div class="pull-right login-and-search">
              <div id="authenticated-block" class="logged-in">
                <div class="welcome-back">Thanks for visiting DZone today,</div>
                <div id="user-header" class="user-info">
                  <button class="user-avatar">
                    <span id="header-username" class="username"></span>
                    <img id="header-avatar" src="" alt="user avatar">
                  </button>
                  <div id="user-dropdown" class="browse-user-menu">
                    <div class="user-content">
                      <a id="header-user-plug" href="#" class="user-description"></a>
                      <a id="header-user-edit" href="#" class="edit-profile">Edit Profile</a>
                    </div>
                    <ul class="user-actions">
                      <li id="first-user-action"><a id="header-dropdown-manage-email" href="#">Manage Email Subscriptions</a></li>
                      <li>
                        <a href="/articles/how-to-submit-a-post-to-dzone?utm_source=DZone&utm_medium=user_dropdown&utm_campaign=how_to_post">
                          How to Post to DZone
                        </a>
                      </li>
                      <li>
                        <a href="/articles/dzones-article-submission-guidelines">
                          Article Submission Guidelines
                        </a>
                      </li>
                    </ul>
                    <div class="bottom">
                      <a href="/users/logout.html" class="sign-out">Sign Out</a>
                      <a id="dropdown-view-profile" href="#" class="view-profile">View Profile</a>
                    </div>
                  </div>
                </div>

                <div class="post-content">
                  <button id="post-button" class="post-content--button">
                    <span class="post-class">Post</span>
                    <i class="icon-plus"></i>
                  </button>

                  <div id="post-menu" class="posting-links">
                    <div class="posting-links-menu">
                      <ul>
                        <li>
                          <img src="/themes/dz20/images/dz-postarticle.svg">
                          <a href="/content/article/post.html">Post an Article</a>
                        </li>
                        <li>
                          <a id="drafts-link" href="#">Manage My Drafts</a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>

              <div id="unauthenticated-block">
                <div class="dz-intro">Over 2 million developers have joined DZone.</div>
                <div class="mobile-invisible sign-in-join">
                  <a href="/users/login.html">Log In</a>
                  <span class="dz-intro-span">/</span>
                  <a href="/static/registration.html">Join</a>
                </div>
                <a class="join-icon" href="/users/login.html"><i class="icon-user"></i></a>
              </div>
              <div class="headerSearch">
                <a class="icon-search dropdown-toggle" href="/search"></a>
              </div>
            </div>
          </div>
        </div>

        <div class="header-bottom">


          <ul class="portals header-container scrollable-ul">
            <li>
              <a href="/refcardz" id="header-refcardz">
                <em>Refcardz</em>
              </a>
            </li>
            <li>
              <a href="/trendreports" id="header-research">
                <em>Trend Reports</em>
              </a>
            </li>
            <li>
              <a href="/webinars" id="header-webinars">
                <em>Webinars</em>
              </a>
            </li>
            <li class="last-portal-link">
              <a href="#" id="header-portals">
                <em>
                  Zones
                  <span id="zone-arrow" class="collapsible-toggle">
                    <i class="icon-angle-down"></i>
                    <i class="icon-angle-up"></i>
                  </span>
                </em>
              </a>
            </li>

            <li class="separator" aria-hidden="true" style="color: #d9dcdd;">|</li>
            <li id="portal-list" class="portal-topics">
              <ul>
                  <li>
                    <a href="/agile-methodology-training-tools-news" id="header-2">Agile</a>
                  </li>
                  <li>
                    <a href="/artificial-intelligence-tutorials-tools-news" id="header-4001">AI</a>
                  </li>
                  <li>
                    <a href="/big-data-analytics-tutorials-tools-news" id="header-3">Big Data</a>
                  </li>
                  <li>
                    <a href="/cloud-computing-tutorials-tools-news" id="header-4">Cloud</a>
                  </li>
                  <li>
                    <a href="/database-sql-nosql-tutorials-tools-news" id="header-5">Database</a>
                  </li>
                  <li>
                    <a href="/devops-tutorials-tools-news" id="header-6">DevOps</a>
                  </li>
                  <li>
                    <a href="/enterprise-integration-training-tools-news" id="header-7">Integration</a>
                  </li>
                  <li>
                    <a href="/iot-developer-tutorials-tools-news-reviews" id="header-8">IoT</a>
                  </li>
                  <li>
                    <a href="/java-jdk-development-tutorials-tools-news" id="header-1">Java</a>
                  </li>
                  <li>
                    <a href="/microservices-news-tutorials-tools" id="header-6001">Microservices</a>
                  </li>
                  <li>
                    <a href="/open-source-news-tutorials-tools" id="header-7001">Open Source</a>
                  </li>
                  <li>
                    <a href="/apm-tools-performance-monitoring-optimization" id="header-10">Performance</a>
                  </li>
                  <li>
                    <a href="/application-web-network-security" id="header-2001">Security</a>
                  </li>
                  <li>
                    <a href="/web-development-programming-tutorials-tools-news" id="header-11">Web Dev</a>
                  </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<script async src="https://dz2cdn2.dzone.com/themes/dz20/ftl/header/bundle.js"></script><link rel="stylesheet" media="all" href="https://dz2cdn2.dzone.com/themes/dz20/ftl/article/styles.css">




<div id="ftl-article" >
  <div class="container-fluid body">
    <div class="row">
      <div class="col-md-12">
        <div class="articles-wrap">
              <div class="ad-container">
                <div id="div-gpt-ad-1435246566686-0" class="ads-billboard-article" data-gpt-slot="top"></div>
              </div>


          <div class="article-stream widget-top-border">
                <div class="content-right-images">
                  <div id="div-gpt-ad-1435246566686-2" class="sidebar-ad" data-gpt-desktop="true" data-gpt-slot="sidebar1"></div>
                </div>

                <script type="application/ld+json">
                  {
                    "@context": "http://schema.org",
                    "@type": "Article",
                    "headline": "Design Patterns for Microservices",
                    "author": {
                      "@type": "Person",
                      "name": "Rajesh Bhojwani"
                    },
                    "audience": "software developers",
                    "keywords": "microservices,software architecture,design patterns,integration,observability,tutorial",
                    "timeRequired": "PT12M",
                    "commentCount": 14,
                    "wordCount": "2859",
                    "accessMode": "textual, visual",
                    "dateCreated": "2018-10-17T05:05:01Z",
                    "datePublished": "2018-10-17T00:00:00Z",
                    "dateModified": "2021-09-29T19:24:59Z",
                    "articleSection": "microservices-news-tutorials-tools",
                    "publisher": {
                      "@type": "Organization",
                      "name": "DZone",
                      "url": "https://dzone.com",
                      "logo": {
                        "@type": "ImageObject",
                        "url": "https://dzone.com/themes/dz20/images/dz_logo_2021_cropped.png"
                      }
                    },
                    "articleBody": "Note: When you purchase through links on our site, we may receive an affiliate commission. Microservice architecture has become the de facto choice for modern application development. Though it solves certain problems, it is not a silver bullet. It has several drawbacks and when using this architecture, there are numerous issues that must be addressed. This brings about the need to learn common patterns in these problems and solve them with reusable solutions. Thus, design patterns for microservices need to be discussed. Before we dive into the design patterns, we need to understand on what principles microservice architecture has been built: Scalability Availability Resiliency Independent, autonomous Decentralized governance Failure isolation Auto-Provisioning Continuous delivery through DevOps Applying all these principles brings several challenges and issues. Let's discuss those problems and their solutions. You might also be interested in this course from Pluralsight called Microservices Architectural Design Patterns Playbook. Start a free 10-day trial. 1. Decomposition Patterns a. Decompose by Business Capability Problem Microservices is all about making services loosely coupled, applying the single responsibility principle. However, breaking an application into smaller pieces has to be done logically. How do we decompose an application into small services? Solution One strategy is to decompose by business capability. A business capability is something that a business does in order to generate value. The set of capabilities for a given business depend on the type of business. For example, the capabilities of an insurance company typically include sales, marketing, underwriting, claims processing, billing, compliance, etc. Each business capability can be thought of as a service, except it’s business-oriented rather than technical. b. Decompose by Subdomain Problem Decomposing an application using business capabilities might be a good start, but you will come across so-called \"God Classes\" which will not be easy to decompose. These classes will be common among multiple services. For example, the Order class will be used in Order Management, Order Taking, Order Delivery, etc. How do we decompose them? Solution For the \"God Classes\" issue, DDD (Domain-Driven Design) comes to the rescue. It uses subdomains and bounded context concepts to solve this problem. DDD breaks the whole domain model created for the enterprise into subdomains. Each subdomain will have a model, and the scope of that model will be called the bounded context. Each microservice will be developed around the bounded context. Note: Identifying subdomains is not an easy task. It requires an understanding of the business. Like business capabilities, subdomains are identified by analyzing the business and its organizational structure and identifying the different areas of expertise. c. Strangler Pattern Problem So far, the design patterns we talked about were decomposing applications for greenfield, but 80% of the work we do is with brownfield applications, which are big, monolithic applications. Applying all the above design patterns to them will be difficult because breaking them into smaller pieces at the same time it's being used live is a big task. Solution The Strangler pattern comes to the rescue. The Strangler pattern is based on an analogy to a vine that strangles a tree that it’s wrapped around. This solution works well with web applications, where a call goes back and forth, and for each URI call, a service can be broken into different domains and hosted as separate services. The idea is to do it one domain at a time. This creates two separate applications that live side by side in the same URI space. Eventually, the newly refactored application “strangles” or replaces the original application until finally you can shut off the monolithic application. 2. Integration Patterns a. API Gateway Pattern Problem When an application is broken down to smaller microservices, there are a few concerns that need to be addressed: How to call multiple microservices abstracting producer information. On different channels (like desktop, mobile, and tablets), apps need different data to respond for the same backend service, as the UI might be different. Different consumers might need a different format of the responses from reusable microservices. Who will do the data transformation or field manipulation? How to handle different type of Protocols some of which might not be supported by producer microservice. Solution An API Gateway helps to address many concerns raised by microservice implementation, not limited to the ones above. An API Gateway is the single point of entry for any microservice call. It can work as a proxy service to route a request to the concerned microservice, abstracting the producer details. It can fan out a request to multiple services and aggregate the results to send back to the consumer. One-size-fits-all APIs cannot solve all the consumer's requirements; this solution can create a fine-grained API for each specific type of client. It can also convert the protocol request (e.g. AMQP) to another protocol (e.g. HTTP) and vice versa so that the producer and consumer can handle it. It can also offload the authentication/authorization responsibility of the microservice. b. Aggregator Pattern Problem We have talked about resolving the aggregating data problem in the API Gateway Pattern. However, we will talk about it here holistically. When breaking the business functionality into several smaller logical pieces of code, it becomes necessary to think about how to collaborate the data returned by each service. This responsibility cannot be left with the consumer, as then it might need to understand the internal implementation of the producer application. Solution The Aggregator pattern helps to address this. It talks about how we can aggregate the data from different services and then send the final response to the consumer. This can be done in two ways: 1. A composite microservice will make calls to all the required microservices, consolidate the data, and transform the data before sending back. 2. An API Gateway can also partition the request to multiple microservices and aggregate the data before sending it to the consumer. It is recommended if any business logic is to be applied, then choose a composite microservice. Otherwise, the API Gateway is the established solution. c. Client-Side UI Composition Pattern Problem When services are developed by decomposing business capabilities/subdomains, the services responsible for user experience have to pull data from several microservices. In the monolithic world, there used to be only one call from the UI to a backend service to retrieve all data and refresh/submit the UI page. However, now it won't be the same. We need to understand how to do it. Solution With microservices, the UI has to be designed as a skeleton with multiple sections/regions of the screen/page. Each section will make a call to an individual backend microservice to pull the data. That is called composing UI components specific to service. Frameworks like AngularJS and ReactJS help to do that easily. These screens are known as Single Page Applications (SPA). This enables the app to refresh a particular region of the screen instead of the whole page. 3. Database Patterns a. Database per Service Problem There is a problem of how to define database architecture for microservices. Following are the concerns to be addressed: 1. Services must be loosely coupled. They can be developed, deployed, and scaled independently. 2. Business transactions may enforce invariants that span multiple services. 3. Some business transactions need to query data that is owned by multiple services. 4. Databases must sometimes be replicated and sharded in order to scale. 5. Different services have different data storage requirements. Solution To solve the above concerns, one database per microservice must be designed; it must be private to that service only. It should be accessed by the microservice API only. It cannot be accessed by other services directly. For example, for relational databases, we can use private-tables-per-service, schema-per-service, or database-server-per-service. Each microservice should have a separate database id so that separate access can be given to put up a barrier and prevent it from using other service tables. b. Shared Database per Service Problem We have talked about one database per service being ideal for microservices, but that is possible when the application is greenfield and to be developed with DDD. But if the application is a monolith and trying to break into microservices, denormalization is not that easy. What is the suitable architecture in that case? Solution A shared database per service is not ideal, but that is the working solution for the above scenario. Most people consider this an anti-pattern for microservices, but for brownfield applications, this is a good start to break the application into smaller logical pieces. This should not be applied for greenfield applications. In this pattern, one database can be aligned with more than one microservice, but it has to be restricted to 2-3 maximum, otherwise scaling, autonomy, and independence will be challenging to execute. c. Command Query Responsibility Segregation (CQRS) Problem Once we implement database-per-service, there is a requirement to query, which requires joint data from multiple services — it's not possible. Then, how do we implement queries in microservice architecture? Solution CQRS suggests splitting the application into two parts — the command side and the query side. The command side handles the Create, Update, and Delete requests. The query side handles the query part by using the materialized views. The event sourcing pattern is generally used along with it to create events for any data change. Materialized views are kept updated by subscribing to the stream of events. d. Saga Pattern Problem When each service has its own database and a business transaction spans multiple services, how do we ensure data consistency across services? For example, for an e-commerce application where customers have a credit limit, the application must ensure that a new order will not exceed the customer’s credit limit. Since Orders and Customers are in different databases, the application cannot simply use a local ACID transaction. Solution A Saga represents a high-level business process that consists of several sub requests, which each update data within a single service. Each request has a compensating request that is executed when the request fails. It can be implemented in two ways: Choreography — When there is no central coordination, each service produces and listens to another service’s events and decides if an action should be taken or not. Orchestration — An orchestrator (object) takes responsibility for a saga’s decision making and sequencing business logic. 4. Observability Patterns a. Log Aggregation Problem Consider a use case where an application consists of multiple service instances that are running on multiple machines. Requests often span multiple service instances. Each service instance generates a log file in a standardized format. How can we understand the application behavior through logs for a particular request? Solution We need a centralized logging service that aggregates logs from each service instance. Users can search and analyze the logs. They can configure alerts that are triggered when certain messages appear in the logs. For example, PCF does have Loggeregator, which collects logs from each component (router, controller, diego, etc...) of the PCF platform along with applications. AWS Cloud Watch also does the same. b. Performance Metrics Problem When the service portfolio increases due to microservice architecture, it becomes critical to keep a watch on the transactions so that patterns can be monitored and alerts sent when an issue happens. How should we collect metrics to monitor application perfomance? Solution A metrics service is required to gather statistics about individual operations. It should aggregate the metrics of an application service, which provides reporting and alerting. There are two models for aggregating metrics: Push — the service pushes metrics to the metrics service e.g. NewRelic, AppDynamics Pull — the metrics services pulls metrics from the service e.g. Prometheus c. Distributed Tracing Problem In microservice architecture, requests often span multiple services. Each service handles a request by performing one or more operations across multiple services. Then, how do we trace a request end-to-end to troubleshoot the problem? Solution We need a service which Assigns each external request a unique external request id. Passes the external request id to all services. Includes the external request id in all log messages. Records information (e.g. start time, end time) about the requests and operations performed when handling an external request in a centralized service. Spring Cloud Slueth, along with Zipkin server, is a common implementation. d. Health Check Problem When microservice architecture has been implemented, there is a chance that a service might be up but not able to handle transactions. In that case, how do you ensure a request doesn't go to those failed instances? With a load balancing pattern implementation. Solution Each service needs to have an endpoint which can be used to check the health of the application, such as /health. This API should o check the status of the host, the connection to other services/infrastructure, and any specific logic. Spring Boot Actuator does implement a /health endpoint and the implementation can be customized, as well. 5. Cross-Cutting Concern Patterns a. External Configuration Problem A service typically calls other services and databases as well. For each environment like dev, QA, UAT, prod, the endpoint URL or some configuration properties might be different. A change in any of those properties might require a re-build and re-deploy of the service. How do we avoid code modification for configuration changes? Solution Externalize all the configuration, including endpoint URLs and credentials. The application should load them either at startup or on the fly. Spring Cloud config server provides the option to externalize the properties to GitHub and load them as environment properties. These can be accessed by the application on startup or can be refreshed without a server restart. b. Service Discovery Pattern Problem When microservices come into the picture, we need to address a few issues in terms of calling services: With container technology, IP addresses are dynamically allocated to the service instances. Every time the address changes, a consumer service can break and need manual changes. Each service URL has to be remembered by the consumer and become tightly coupled. So how does the consumer or router know all the available service instances and locations? Solution A service registry needs to be created which will keep the metadata of each producer service. A service instance should register to the registry when starting and should de-register when shutting down. The consumer or router should query the registry and find out the location of the service. The registry also needs to do a health check of the producer service to ensure that only working instances of the services are available to be consumed through it. There are two types of service discovery: client-side and server-side. An example of client-side discovery is Netflix Eureka and an example of server-side discovery is AWS ALB. c. Circuit Breaker Pattern Problem A service generally calls other services to retrieve data, and there is the chance that the downstream service may be down. There are two problems with this: first, the request will keep going to the down service, exhausting network resources and slowing performance. Second, the user experience will be bad and unpredictable. How do we avoid cascading service failures and handle failures gracefully? Solution The consumer should invoke a remote service via a proxy that behaves in a similar fashion to an electrical circuit breaker. When the number of consecutive failures crosses a threshold, the circuit breaker trips, and for the duration of a timeout period, all attempts to invoke the remote service will fail immediately. After the timeout expires the circuit breaker allows a limited number of test requests to pass through. If those requests succeed, the circuit breaker resumes normal operation. Otherwise, if there is a failure, the timeout period begins again. Netflix Hystrix is a good implementation of the circuit breaker pattern. It also helps you to define a fallback mechanism which can be used when the circuit breaker trips. That provides a better user experience. d. Blue-Green Deployment Pattern Problem With microservice architecture, one application can have many microservices. If we stop all the services then deploy an enhanced version, the downtime will be huge and can impact the business. Also, the rollback will be a nightmare. How do we avoid or reduce downtime of the services during deployment? Solution The blue-green deployment strategy can be implemented to reduce or remove downtime. It achieves this by running two identical production environments, Blue and Green. Let's assume Green is the existing live instance and Blue is the new version of the application. At any time, only one of the environments is live, with the live environment serving all production traffic. All cloud platforms provide options for implementing a blue-green deployment. For more details on this topic, check out this article. There are many other patterns used with microservice architecture, like Sidecar, Chained Microservice, Branch Microservice, Event Sourcing Pattern, Continuous Delivery Patterns, and more. The list keeps growing as we get more experience with microservices. I am stopping now to hear back from you on what microservice patterns you are using. Additional Resources: For additional information on Microservices Architectural Design Patterns try this course on Pluralsight. In this course learn how to implement and apply the approach using tools, design patterns and techniques. Start a free 10-day trial with Pluralsight.",
                    "mainEntityOfPage": {
                      "@type": "WebPage",
                      "@id": "https://dzone.com/articles/design-patterns-for-microservices"
                    },
                    "image": {
                      "@type": "ImageObject",
                      "url": "https://dzone.com//dz2cdn2.dzone.com/storage/article-thumb/10477269-thumb.jpg"
                    }
                  }
                </script>

                  <script type="application/ld+json">
                    {
                      "@context": "https://schema.org",
                      "@type": "BreadcrumbList",
                      "itemListElement": [{
                        "@type": "ListItem",
                        "position": 1,
                        "name": "DZone",
                        "item": "https://dzone.com"
                      }, {
                        "@type": "ListItem",
                        "position": 2,
                        "name": "Microservices Zone",
                        "item": "https://dzone.com/microservices-news-tutorials-tools"
                      }, {
                        "@type": "ListItem",
                        "position": 3,
                        "name": "Design Patterns for Microservices",
                        "item": "https://dzone.com/articles/design-patterns-for-microservices"
                      }]
                    }
                  </script>

            <article>
              <div class="content">
                <div class="header">
                  <div class="col-xs-12 breadcrumb-padding">
                    <a href="/">DZone</a>
                    >
                      <a href="/microservices-news-tutorials-tools">Microservices Zone</a>
                      >
                      <a href="#">Design Patterns for Microservices</a>
                  </div>


                  <div class="header-title">
                    <div class="title">
                      <h1 class="article-title">Design Patterns for Microservices</h1>
                    </div>

                    <div class="subhead">
                      <h3>Learn about the design patterns of microservice architecture to overcome its challenges.</h3>
                    </div>

                    <div class="publish-meta">
                        <div class="article-author-meta">
                          <img src="https://dz2cdn1.dzone.com/thumbnail?fid=10341811&w=80" class="avatar" alt="Rajesh Bhojwani user avatar" width="40">
                          by

                          <div class="author-info">
                            <span class="author-name">
                              <a href="/users/468979/rajesh.bhojwani.html" rel="nofollow">Rajesh Bhojwani</a>
                            </span>
                          </div>


                            <div class="mvb-award">
                              <i title="Most Valuable Blogger" class="icon-mvb-1"></i>
                            </div>


                          &middot;
                        </div>
                      <span class="author-date">
                        Oct. 17, 18
                      </span>
                      &middot;
                        <a href="/microservices-news-tutorials-tools" id="portal-name">
                          <span class="portal-name">Microservices Zone</span>
                        </a>
                      &middot;
                      <span>Tutorial</span>
                    </div>
                  </div>
                </div>

                <div class="author-n-useraction">
                  <div class="like action">
                    <div id="activity-like-icon" class="dz-like icon-thumbs-up">
                      <span class="action-label">
                        <span id="activity-like-text">Like</span>
                      </span>
                      <a href="#">
                        <span id="activity-like-counter">(205)</span>
                      </a>
                    </div>
                  </div>

                  <div class="action">

                    <button class="comment">
                      <i class="icon-comment"></i>
                      Comment
                      <span id="activity-comment-counter" class="comment-count"></span>
                    </button>
                  </div>

                  <div class="save action">
                    <div id="activity-save-icon" class="save icon-star-empty">
                      <span id="activity-save-text" class="action-label">Save</span>
                    </div>
                  </div>

                  <div class="tweet action">
                    <a id="tweet-link" href="" class="title" target="_blank">
                      <span><i class="icon-twitter"></i></span>
                      <span class="action-label">Tweet</span>
                    </a>
                  </div>

                  <div class="pull-right">
                    <div id="activity-view-container" class="article-views action">
                      <i class="icon-eye"></i> 462.69K
                      <span class="action-label">Views</span>
                    </div>
                  </div>
                </div>

                    <div class="signin-prompt">
                      <p>Join the DZone community and get the full member experience.</p>
                      <a id="article-signin-prompt" href="/static/registration.html">Join For Free</a>
                    </div>
                    <div class="arrow-down"></div>

                  <div id="top-bumper-container"></div>

                <div>
                  <div class="content-html"><p><span style="font-size:11.0pt;"><em>Note: When you purchase through links on our site, we may receive an affiliate commission.</em></span></p>
<p>Microservice architecture has become the de facto choice for modern application development. Though it solves certain problems, it is not a silver bullet. It has several drawbacks and when using this architecture, there are numerous issues that must be addressed. This brings about the need to learn common patterns in these problems and solve them with reusable solutions. Thus,&nbsp;design patterns for microservices need&nbsp;to be discussed. Before&nbsp;we dive into the design patterns, we need to understand on what principles microservice architecture has been built:</p>
<ol>
 <li>Scalability</li>
 <li>Availability</li>
 <li>Resiliency</li>
 <li>Independent, autonomous</li>
 <li>Decentralized governance</li>
 <li>Failure isolation</li>
 <li>Auto-Provisioning</li>
 <li>Continuous delivery through DevOps</li>
</ol>
<p>Applying all these principles brings several challenges and issues. Let's discuss those problems and their solutions.</p>
<p>You might also be interested in this course from Pluralsight called <a href="https://pluralsight.pxf.io/c/2891898/731142/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fmicroservices-architectural-design-patterns-playbook" rel="noopener noreferrer" target="_blank">Microservices Architectural Design Patterns Playbook</a>. Start a free 10-day trial.</p>
<h2>1. Decomposition Patterns</h2>
<h3>a. Decompose by Business Capability</h3>
<h4><strong>Problem</strong></h4>
<p>Microservices is all about making services loosely coupled, applying the single responsibility principle. However, breaking an application into smaller pieces has to be done logically. How do we decompose an application into small services?</p>
<h4><strong>Solution</strong></h4>
<p>One&nbsp;strategy is to decompose by business capability. A business capability is something that a business does in order to generate value. The set of capabilities for a given business depend on the type of business. For example, the capabilities of an insurance company typically include sales, marketing, underwriting, claims processing, billing, compliance, etc. Each business capability can be thought of as a service, except it’s business-oriented rather than technical.</p>
<h3>b. Decompose by Subdomain</h3>
<h4><strong>Problem</strong></h4>
<p>Decomposing an application using business capabilities might be a good start, but you will come across so-called "God Classes" which will not be easy to decompose. These classes will be common among multiple services. For example, the Order class will be used in Order Management, Order Taking, Order Delivery, etc. How do we decompose them?</p>
<h4><strong>Solution</strong></h4>
<p>For the "God Classes" issue, DDD (Domain-Driven Design) comes to the rescue. It uses subdomains and bounded context concepts to solve this problem. DDD&nbsp;breaks the whole domain model created for the enterprise into subdomains. Each subdomain will have a model, and the scope of that model will be called the bounded context. Each microservice will be developed around the bounded context.</p>
<p><strong>Note</strong>: Identifying subdomains is not an easy task. It requires an understanding of the business. Like business capabilities, subdomains are identified by analyzing the business and its organizational structure and identifying the different areas of expertise.</p>
<h3>c. Strangler Pattern</h3>
<h4><strong>Problem</strong></h4>
<p>So far, the design patterns we talked about were decomposing applications for greenfield, but 80% of the work we do is with brownfield applications, which are big, monolithic applications. Applying all the above design patterns to them will be difficult because breaking them into smaller pieces at the same time&nbsp;it's being used live is a big task.</p>
<h4><strong>&nbsp;Solution</strong></h4>
<p>The Strangler pattern comes to the rescue. The Strangler pattern is based on an analogy to a vine that strangles a tree that it’s wrapped around. This solution works well with web applications, where a&nbsp;call goes back and forth, and for each URI call, a service can be broken into different domains and hosted as separate services. The idea is to do it one domain at a time. This creates two separate applications that live side by side in the same URI space. Eventually, the newly refactored application “strangles” or replaces the original application until finally you can shut off the monolithic application.</p>
<h2>2. Integration Patterns</h2>
<h3>a. API Gateway Pattern</h3>
<h4><strong>Problem</strong></h4>
<p>When an application is broken down to smaller microservices, there are a few concerns that need to be addressed:</p>
<ol>
 <li><p>How to call multiple microservices abstracting producer information.</p></li>
 <li><p>On different channels (like desktop, mobile, and tablets), apps need different data to respond for the same backend service, as the UI might be different.</p></li>
 <li><p>Different consumers might need a different format of the responses from reusable microservices. Who will do the data transformation or field manipulation?</p></li>
 <li><p>How to handle different type of Protocols some of which might not be supported by producer microservice.</p></li>
</ol>
<h4><strong>&nbsp;Solution</strong></h4>
<p>An API Gateway helps to address many concerns raised by microservice implementation, not limited to the ones above.</p>
<ol>
 <li><p>An API Gateway is the single point of entry for any microservice call.</p></li>
 <li><p>It can work as a proxy service to route a request to the concerned microservice, abstracting the producer details.</p></li>
 <li><p>It can fan out a request to multiple services and aggregate the results to send back to the consumer.</p></li>
 <li><p>One-size-fits-all APIs cannot solve all the consumer's requirements; this solution can create a fine-grained API for each specific type of client.</p></li>
 <li><p>It can also convert the protocol request (e.g. AMQP) to another protocol (e.g. HTTP) and vice versa so that the producer and consumer can handle it.</p></li>
 <li><p>It can also offload the authentication/authorization responsibility of the microservice.</p></li>
</ol>
<h3>b. Aggregator Pattern</h3>
<h4><strong>Problem</strong></h4>
<p>We have talked about resolving the aggregating data problem in the API Gateway Pattern. However, we will talk about it here holistically. When breaking the business functionality into several smaller logical pieces of code, it becomes necessary to think about how to collaborate the data returned by each service. This responsibility cannot be left with the consumer, as then it might need to understand the internal implementation of the producer application.</p>
<h4><strong>&nbsp;Solution</strong></h4>
<p>The Aggregator pattern helps to address this. It talks about how we can aggregate the data from different services and then send the final response to the consumer. This can be done in two ways:</p>
<p>1. A <strong>composite microservice</strong> will make calls to all the required microservices, consolidate the data, and transform the data before sending back.</p>
<p>2. An <strong>API Gateway</strong> can also partition the request to multiple microservices and aggregate the data before sending it to the consumer.</p>
<p>It is recommended if any business logic is to be applied, then choose a composite microservice. Otherwise, the API Gateway is the established solution.</p>
<h3>c. Client-Side UI Composition Pattern</h3>
<h4><strong>Problem</strong></h4>
<p>When services are developed by decomposing business capabilities/subdomains, the services responsible for user experience have to pull data from several microservices. In the monolithic world, there used to be only one call from the UI to a backend service to retrieve all data and refresh/submit the UI page. However, now it won't be the same. We need to understand how to do it.</p>
<h4><strong>&nbsp;Solution</strong></h4>
<p>With microservices, the UI has to be designed as a skeleton with multiple sections/regions of the screen/page. Each section will make a call to an individual backend microservice to pull the data. That is called composing UI components specific to service. Frameworks like AngularJS and ReactJS help to do that easily. These screens are known as Single Page Applications (SPA). This enables the app to refresh a particular region of the screen instead of the&nbsp;whole page.</p>
<h2>3. Database Patterns</h2>
<h3>a. Database per Service</h3>
<h4><strong>Problem</strong></h4>
<p>There is a problem of how to define database architecture for microservices. Following are the concerns to be addressed:</p>
<p>1. Services must be loosely coupled. They can be developed, deployed, and scaled independently.</p>
<p>2. Business transactions may enforce invariants that span multiple services.</p>
<p>3. Some business transactions need to query data that is owned by multiple services.</p>
<p>4. Databases must sometimes be replicated and sharded in order to scale.</p>
<p>5. Different services have different data storage requirements.</p>
<h4><strong>Solution</strong></h4>
<p>To solve the above concerns, one database per microservice must be designed; it must be private to that service only. It should be accessed by the microservice API only. It cannot be accessed by other services directly. For example, for relational databases, we can use private-tables-per-service, schema-per-service, or database-server-per-service. Each microservice should have a separate database id so that separate access can be given to put&nbsp;up a barrier and prevent it from using other service tables.</p>
<h3>b. Shared Database per Service</h3>
<h4><strong>Problem</strong></h4>
<p>We have talked about one database per service being ideal for microservices, but that is possible when the application is greenfield and to be developed with DDD. But if the application is a monolith and trying to break into microservices, denormalization is not that easy. What is the suitable architecture in that case?</p>
<h4><strong>Solution</strong></h4>
<p>A shared database per service is not ideal, but that is the working solution for the above scenario. Most people consider this an&nbsp;anti-pattern for microservices, but for brownfield applications, this is a good start to break the application into smaller logical pieces. This should not be applied for greenfield applications. In this pattern, one database can be aligned with more than one microservice, but it has to be restricted to 2-3 maximum, otherwise scaling, autonomy, and independence will be challenging to execute.</p>
<h3>c. Command Query Responsibility Segregation (CQRS)</h3>
<h4><strong>Problem</strong></h4>
<p>Once we implement database-per-service, there is a requirement to query, which requires joint data from multiple services — it's not possible. Then, how do we implement queries in microservice architecture?</p>
<h4><strong>&nbsp;Solution</strong></h4>
<p>CQRS suggests splitting the application into two parts — the command side and the query side. The command side handles the Create, Update, and Delete requests. The query side handles the query part by using the materialized views. The <strong>event sourcing pattern</strong> is generally used along with it to create events for any data change. Materialized views are kept updated by subscribing to the stream of events.</p>
<h3>d. Saga Pattern</h3>
<h4><strong>Problem</strong></h4>
<p>When each service has its own database and a business transaction spans multiple services, how do we ensure data consistency across services? For example, for an e-commerce application where customers have a credit limit, the application must ensure that a new order will not exceed the customer’s credit limit. Since Orders and Customers are in different databases, the application cannot simply use a local ACID transaction.</p>
<h4><strong>Solution</strong></h4>
<p>A Saga represents a high-level business process that consists of several sub requests, which each update data within a single service. Each request has a compensating request that is executed when the request fails. It can be implemented in two ways:</p>
<ol>
 <li><p>Choreography — When there is no central coordination, each service produces and listens to another service’s events and decides if an action should be taken or not.</p></li>
 <li><p>Orchestration — An orchestrator (object) takes responsibility for a saga’s decision making and sequencing business logic.</p></li>
</ol>
<h2>4. Observability Patterns</h2>
<h3>a. Log Aggregation</h3>
<h4><strong>Problem</strong></h4>
<p>Consider a use case where an application consists of multiple service instances that are running on multiple machines. Requests often span multiple service instances. Each service instance generates a log file in a standardized format. How can we understand the application behavior through logs for a particular request?</p>
<h4><strong>&nbsp;Solution</strong></h4>
<p>We need a centralized logging service that aggregates logs from each service instance. Users can search and analyze the logs. They can configure alerts that are triggered when certain messages appear in the logs. For example, PCF does have Loggeregator, which collects logs from each component (router, controller, diego, etc...) of the PCF platform along with applications. AWS Cloud Watch also does the same.</p>
<h3>b. Performance Metrics</h3>
<h4><strong>Problem</strong></h4>
<p>When the service portfolio increases due to microservice architecture, it becomes critical to keep a watch on the transactions so that patterns can be monitored and&nbsp;alerts sent when an issue happens. How should we collect metrics to monitor application perfomance?</p>
<h4><strong>Solution</strong></h4>
<p>A metrics service is required to gather statistics about individual operations. It should aggregate the metrics of an application service, which provides reporting and alerting. There are two models for aggregating metrics:</p>
<ul>
 <li><p>Push — the service pushes metrics to the metrics service e.g. NewRelic, AppDynamics</p></li>
 <li><p>Pull — the metrics services pulls metrics from the service e.g. Prometheus</p></li>
</ul>
<h3>c. Distributed Tracing</h3>
<h4><strong>&nbsp;Problem</strong></h4>
<p>In microservice architecture, requests often span multiple services. Each service handles a request by performing one or more operations across multiple services. Then, how do we trace a request end-to-end to troubleshoot the problem?</p>
<h4><strong>Solution</strong></h4>
<p>We need a service which</p>
<ul>
 <li><p>Assigns each external request a unique external request id.</p></li>
 <li><p>Passes the external request id to all services.</p></li>
 <li><p>Includes the external request id in all log messages.</p></li>
 <li><p>Records information (e.g. start time, end time) about the requests and operations performed when handling an external request in a centralized service.</p></li>
</ul>
<p>Spring Cloud Slueth, along with Zipkin server, is a common implementation.</p>
<h3>d. Health Check</h3>
<h4><strong>Problem</strong></h4>
<p>When microservice architecture has been implemented, there is a chance that a service might be up but not able to handle transactions. In that case, how do you ensure a request doesn't go to those failed instances? With a load balancing pattern implementation.</p>
<h4><strong>Solution</strong></h4>
<p>Each service needs to have an endpoint which can be used to check the health of the application, such as <code>/health</code>. This API should o check the status of the host, the connection to other services/infrastructure, and any specific logic.</p>
<p>Spring Boot Actuator does implement a /health endpoint and the implementation can be customized, as well.</p>
<h2>5. Cross-Cutting Concern Patterns</h2>
<h3>a. External Configuration</h3>
<h4><strong>Problem</strong></h4>
<p>A service typically calls other services and databases as well. For each environment like dev, QA, UAT, prod, the endpoint URL or some configuration properties might be different. A change in any of those properties might require a re-build and re-deploy of the service. How do we avoid code modification for configuration changes?</p>
<h4><strong>Solution</strong></h4>
<p>Externalize all the configuration, including endpoint URLs and credentials. The application should load them either at startup or on the fly.</p>
<p>Spring Cloud config server provides the option to externalize the properties to GitHub and load them as environment properties. These can be accessed by the application on startup or can be refreshed without a server restart.</p>
<h3>b. Service Discovery Pattern</h3>
<h4><strong>Problem</strong></h4>
<p>When microservices come into the picture, we need to address a few issues in terms of calling services:</p>
<ol>
 <li><p>With container technology, IP addresses are dynamically allocated to the service instances. Every time the address changes, a consumer service can break and need manual changes.</p></li>
 <li><p>Each service URL has to be remembered by the consumer and become tightly coupled.</p></li>
</ol>
<p>So how does the consumer or router know all the available service instances and locations?</p>
<h4><strong>Solution</strong></h4>
<p>A service registry needs to be created which will keep the metadata of each producer service. A service instance should register to the registry when starting and should de-register when&nbsp;shutting down. The consumer or router should query the&nbsp;registry and find out the location of the service. The registry also needs to do a health check of the producer service to ensure that&nbsp;only working instances of the services are available to be consumed through it. There are two types of service discovery: client-side and server-side. An example of&nbsp;client-side discovery is Netflix Eureka and an example of&nbsp;server-side discovery is AWS ALB.</p>
<h3>c. Circuit Breaker Pattern</h3>
<h4><strong>Problem</strong></h4>
<p>A service generally calls other services to retrieve data, and there is the chance that the downstream service may be down. There are two problems with this: first, the request will keep going to the down service, exhausting network resources and slowing performance. Second, the user experience will be bad and unpredictable. How do we avoid cascading service failures and handle failures gracefully?</p>
<h4><strong>Solution</strong></h4>
<p>The consumer should invoke a remote service via a proxy that behaves in a similar fashion to an electrical circuit breaker. When the number of consecutive failures crosses a threshold, the circuit breaker trips, and for the duration of a timeout period, all attempts to invoke the remote service will fail immediately. After the timeout expires the circuit breaker allows a limited number of test requests to pass through. If those requests succeed, the circuit breaker resumes normal operation. Otherwise, if there is a failure, the timeout period begins again.</p>
<p>Netflix Hystrix is a good implementation of the circuit breaker pattern. It also helps you to define a fallback mechanism which can be used when the circuit breaker trips. That provides a better user experience.</p>
<h3>d. Blue-Green Deployment Pattern</h3>
<h4><strong>&nbsp;Problem</strong></h4>
<p>With microservice architecture, one application can have many microservices. If we stop all the services then deploy an enhanced version, the downtime will be huge and can impact the business. Also, the rollback will be a nightmare. How do we avoid or reduce downtime of the services during deployment?</p>
<h4><strong>Solution</strong></h4>
<p>The blue-green deployment strategy can be implemented to reduce or remove downtime. It achieves this by running two identical production environments, Blue and Green. Let's assume Green is the existing live instance and Blue is the new version of the application. At any time, only one of the environments is live, with the live environment serving all production traffic. All cloud platforms provide options for implementing a blue-green deployment. For more details on this topic, check out <a href="https://dzone.com/articles/blue-green-deployment-for-cloud-native-application" target="_blank">this article</a>.</p>
<p>There are many other patterns used with microservice architecture, like Sidecar, Chained Microservice, Branch Microservice, Event Sourcing Pattern, Continuous Delivery Patterns, and more. The list keeps growing as we get more experience with microservices. I am stopping now to hear back from you on what microservice patterns you are using.</p>
<p><br></p>
<p><strong>Additional Resources:</strong></p>
<p>For additional information on <a href="https://pluralsight.pxf.io/c/2891898/731142/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fmicroservices-architectural-design-patterns-playbook" rel="noopener noreferrer" target="_blank">Microservices Architectural Design Patterns</a> try this course on Pluralsight. In this course learn how to implement and apply the approach using tools, design patterns and techniques. <a href="https://pluralsight.pxf.io/c/2891898/731142/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fmicroservices-architectural-design-patterns-playbook" rel="noopener noreferrer" target="_blank">Start a free 10-day trial</a> with Pluralsight.</p></div>
                </div>

                  <div id="bottom-bumper-container"></div>
                  <div class="article-tag-pill-container">
                      <span class="article-tag-pill">microservice</span>
                      <span class="article-tag-pill">Web Service</span>
                      <span class="article-tag-pill">mobile app</span>
                      <span class="article-tag-pill">Database</span>
                      <span class="article-tag-pill">Design</span>
                      <span class="article-tag-pill">Relational database</span>
                      <span class="article-tag-pill">Requests</span>
                      <span class="article-tag-pill">Circuit Breaker Pattern</span>
                      <span class="article-tag-pill">Data (computing)</span>
                      <span class="article-tag-pill">Spring Cloud</span>
                  </div>

                  <div class="attribution">
                    <p>Opinions expressed by DZone contributors are their own.</p>
                  </div>

                    <div class="related">
                      <h3>Popular on DZone</h3>
                        <ul>
                            <li class="relateddiv">
                              <a href="/articles/comparing-distributed-databases?fromrel=true">Comparing Distributed Databases</a>
                            </li>
                            <li class="relateddiv">
                              <a href="/articles/an-overview-of-key-components-of-a-data-pipeline?fromrel=true">An Overview of Key Components of a Data Pipeline</a>
                            </li>
                            <li class="relateddiv">
                              <a href="/articles/ultra-fast-microservices-when-microstream-meets-pa?fromrel=true">Ultra-Fast Microservices: When Microstream Meets Payara</a>
                            </li>
                            <li class="relateddiv">
                              <a href="/articles/database-btree-indexing-in-sqlite?fromrel=true">How Database B-Tree Indexing Works</a>
                            </li>
                        </ul>
                      </div>
<div class="comments-overlay"></div>
<div id="comment-box">
  <div class="comment-box-wrapper">
    <div id="comment-input-editor"></div>
  </div>
  <div class="info hidden"></div>
  <div class="comments-content">
    <div class="comment-header">
      <hr />
      <span class="icon-comment">
        <span class="numOfComments"></span> Comments
      </span>
    </div>
    <div class="comments"></div>
  </div>
</div>
            </article>
          </div>

            <div id="above-pr-ad" class="bottom-ad-container">
              <div id="div-gpt-ad-1435246566686-11" data-gpt-slot="bottom"></div>
            </div>
            <div class="layout-card widget-top-border partner-resources-block" style="width:100%; margin-bottom: 1em;">
              <div class="main-container">
                <div class="featured-header">
                  <h2>
                      Microservices<span> Partner Resources</span>
                  </h2>
                </div>
                <div class="partner-resources-container">
                  <div id="div-gpt-ad-1435246566686-5" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr1"></div>
                  <div id="div-gpt-ad-1435246566686-6" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr2"></div>
                  <div id="div-gpt-ad-1435246566686-7" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr3"></div>
                </div>
              </div>
            </div>
        </div>
      </div>
    </div>
  </div>

    <div id="bsa-parent" class="bottom-sticky-ad-container hide">
      <div class="container">
        <div class="col-md-9">
          <div class="fixed-bottom-div">
            <div class="inline-block">
              <div id="div-gpt-ad-1635294790718-12" data-gpt-desktop="true" class="bottom-sticky-ad"></div>
            </div>
            <div class="inline-block">
              <span id="close" class="bottom-sticky-ad-close-button" onclick="removeBottomStickyAd()">
                X
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>

  <div class="modal fade bd-example-modal-lg" id="modal-message" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header"></div>
        <div class="modal-body"></div>
      </div>
    </div>
  </div>
</div>

<script async>const articleTitle = 'Design Patterns for Microservices'
const articleUrl = 'https://dzone.com/articles/design-patterns-for-microservices'

const retweetLink = document.querySelector('#tweet-link')

function retweet(event) {
    event.preventDefault()
    event.stopPropagation()

    const twitter = 'https://twitter.com/intent/tweet'
    const params = '?text=' + encodeURIComponent(articleTitle) + '&url=' + articleUrl + '&ref=dzone.com&via=DZoneInc'
    const win = window.open(twitter + params, '_blank')
    win.focus()
}

retweetLink.addEventListener('click', retweet);

function showStatusMessage(options) {
  var modal = document.getElementById("modal-message");

  if(modal) {
    modal.classList.add(options.type);
    var modalBody = modal.querySelector(".modal-content .modal-body");
    var modalHeader = modal.querySelector(".modal-content .modal-header");

    modalHeader.innerText = options.header ? options.header : "";
    modalBody.innerText = options.body ? options.body : "" ;

    $(modal).modal("show");

    $(modal).on('hidden.bs.modal', function () {
      modal.classList.remove(options.type);
    });
  }
}

function showConfirmMessage(options) {
  var modal = document.getElementById("modal-message");

  if(modal) {
    modal.classList.add(options.type);
    var modalBody = modal.querySelector(".modal-content .modal-body");
    var modalHeader = modal.querySelector(".modal-content .modal-header");

    modalHeader.innerText = options.header ? options.header : "";
    modalBody.innerText = options.body ? options.body : "" ;

    if (options.textarea) {
      const textareaDiv = document.createElement('div')
      const textareaLabel = document.createElement('label')
      textareaLabel.setAttribute('for', 'modal-textarea')
      textareaLabel.innerText = options.textarea.label

      const textarea = document.createElement('textarea')
      textarea.id = 'modal-textarea'
      textarea.placeholder = (options.textarea.placeholder || '')
      textarea.setAttribute('rows', (options.textarea.rows || 3))
      textarea.classList.add('form-control', 'not-resizable')

      if (options.textarea.maxlength) {
        textarea.maxLength = options.textarea.maxlength
      }

      textareaDiv.appendChild(textareaLabel)
      textareaDiv.appendChild(textarea)
      modalBody.appendChild(textareaDiv)
    }

    var btnContainer = document.createElement("div");
    btnContainer.classList.add("btn-container");

    var noBtn = document.createElement("button");
    noBtn.innerText = options.noBtnText ? options.noBtnText : "No";
    noBtn.classList.add("no-btn");

    var yesBtn = document.createElement("button");
    yesBtn.innerText = options.yesBtnText ? options.yesBtnText : "Yes";
    yesBtn.classList.add("yes-btn");

    btnContainer.appendChild(noBtn);
    btnContainer.appendChild(yesBtn);

    modalBody.appendChild(btnContainer);

    $(modal).modal("show");

    $(noBtn).one("click", function() {
      $(modal).modal("hide");

      if(options.noCallback) {
        $(modal).one('hidden.bs.modal', function () {
          options.noCallback();
        });
      }
    });

    $(yesBtn).one("click", function() {
      $(modal).modal("hide");

      if(options.yesCallback) {
        $(modal).one('hidden.bs.modal', function () {
          options.yesCallback();
        });
      }
    });

    $(modal).on('hidden.bs.modal', function () {
      modal.classList.remove(options.type);
    });
  }
}
</script><link rel="stylesheet" media="all" href="https://dz2cdn2.dzone.com/themes/dz20/ftl/footer/styles.css">

<div id="ftl-footer">
  <div class="container-fluid footerOuter">
    <div class="row">
      <div class="col-md-12">
        <div class="container">
          <div class="row footer">
            <div class="col-md-12 footerWidget">
              <div class="row footerContainer footer">
                <div class="left col-xs-12 col-sm-7">
                  <div class="col-xs-12 social-media-icons footer-mobile">
                    <ul class="icons-only">
                      <li class="rss-icon" id="rss-footer-1">
                        <a href="/pages/feeds" target="_blank" rel="noreferrer noopener">
                          <i class="icon-rss-1"></i>
                        </a>
                      </li>
                      <li class="twitter-icon">
                        <a href="https://twitter.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-twitter"></i>
                        </a>
                      </li>
                      <li class="facebook-icon">
                        <a href="https://www.facebook.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-facebook-1"></i>
                        </a>
                      </li>
                      <li class="linkedin-icon">
                        <a href="https://www.linkedin.com/company/dzone/" target="_blank"
                           rel="noreferrer noopener">
                          <i class="icon-linkedin-1"></i>
                        </a>
                      </li>
                    </ul>
                  </div>

                  <div class="top-section col-xs-12">
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">ABOUT US</p>
                      <ul class="link-group">
                        <li><a href="/pages/about" rel="noreferrer noopener">About DZone</a></li>
                        <li><a href="mailto:support@dzone.com" rel="noreferrer noopener">Send feedback</a></li>
                        <li><a href="https://careers.dzone.com/" target="_blank" rel="noreferrer noopener">Careers</a></li>
                          <li><a href="/sitemap" rel="noreferrer noopener">Sitemap</a></li>
                      </ul>
                    </div>
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">ADVERTISE</p>
                      <ul class="link-group">
                        <li><a href="https://advertise.dzone.com" target="_blank" rel="noreferrer noopener">Advertise with DZone</a></li>
                      </ul>
                    </div>
                  </div>

                  <div class="bottom-section col-xs-12">
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">CONTRIBUTE ON DZONE</p>
                      <ul class="bottom-top-list link-group">
                        <li><a href="/articles/dzones-article-submission-guidelines">Article Submission Guidelines</a></li>
                        <li><a href="/pages/mvb" rel="noreferrer noopener">MVB Program</a></li>
                        <li><a href="/pages/contribute" rel="noreferrer noopener">Become a Contributor</a></li>
                        <li><a href="/writers-zone" rel="noreferrer noopener">Visit the Writers' Zone</a></li>
                      </ul>

                      <p class="section-header">LEGAL</p>
                      <ul class="link-group">
                        <li><a href="/pages/tos" rel="noreferrer noopener">Terms of Service</a></li>
                        <li><a href="/pages/privacy" rel="noreferrer noopener">Privacy Policy</a></li>
                      </ul>
                    </div>
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">CONTACT US</p>
                      <ul class="link-group">
                        <li>600 Park Offices Drive</li>
                        <li>Suite 300</li>
                        <li>Durham, NC 27709</li>
                        <li><a href="mailto:support@dzone.com" rel="noreferrer noopener">support@dzone.com</a></li>
                        <li><a href="tel:+19196780300" rel="noreferrer noopener">+1 (919) 678-0300</a></li>
                      </ul>
                    </div>
                  </div>
                </div>

                <div class="right col-xs-12 col-sm-5">

                  <p class="connect-text">Let's be friends:</p>
                  <div class="col-xs-12 social-media-icons footer-wide">
                    <ul class="icons-only">
                      <li class="rss-icon" id="rss-footer-1">
                        <a href="/pages/feeds" target="_blank" rel="noreferrer noopener">
                          <i class="icon-rss-1"></i>
                        </a>
                      </li>
                      <li class="twitter-icon">
                        <a href="https://twitter.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-twitter"></i>
                        </a>
                      </li>
                      <li class="facebook-icon">
                        <a href="https://www.facebook.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-facebook-1"></i>
                        </a>
                      </li>
                      <li class="linkedin-icon">
                        <a href="https://www.linkedin.com/company/dzone/" target="_blank"
                           rel="noreferrer noopener">
                          <i class="icon-linkedin-1"></i>
                        </a>
                      </li>
                    </ul>
                  </div>

                  <div class="col-xs-12 powered-by">
                    <p>DZone.com is powered by&nbsp;</p>
                    <a href="https://devada.com/answerhub/" rel="noreferrer noopener">
                      <img src=""
                           data-src="https://dz2cdn2.dzone.com/themes/dz20/images/answerhub_logo_white_footer.png"
                           width="150"
                           height="56"
                           class="lazyload"
                           alt="AnswerHub logo">
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
  <script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>

  <script async>
      (function(w, d, s, l, i) {
          w[l] = w[l] || [];
          w[l].push({'gtm.start': new Date().getTime(), event: 'gtm.js'});
          var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
          j.async = true;
          j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
          f.parentNode.insertBefore(j,f);
      })(window, document, 'script', 'dataLayer', 'GTM-K25QL22');
  </script>

  <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-410289-1', 'auto');
      ga('require', 'linkid', 'linkid.js');
      ga('require', 'GTM-TSD9TZP');
      ga('set', 'siteSpeedSampleRate', 25);
  </script>
  <script async src="https://www.google-analytics.com/analytics.js"></script>
  <script async>const analytics = {
    'dimension1': 'microservices',
    'dimension2': 'article/tutorial',
    'dimension3': '2018-10-17',
    'dimension4': '0',
    'dimension5': '',
    'dimension7': 'microservice, web service, mobile app, Database, Design, Relational database, requests, Circuit Breaker Pattern, data, Spring Cloud',
    'dimension8': 'rajesh.bhojwani',
    'dimension9': 'undefined',
    'dimension10': 'DELLEMC'
}

if (window.ga) {
    Object.keys(analytics).forEach(function(key) {
        window.ga('set', key, analytics[key])
    })

    window.ga('send', 'pageview')
}</script>

  <script>
      !function (e, o, n, i) {
          if (!e) {
              e = e || {}, window.permutive = e, e.q = [];
              var t = function () {
                  return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, function (e) {
                      return (e ^ (window.crypto || window.msCrypto).getRandomValues(new Uint8Array(1))[0] & 15 >> e / 4).toString(16)
                  })
              };
              e.config = i || {}, e.config.apiKey = o, e.config.workspaceId = n, e.config.environment = e.config.environment || "production", (window.crypto || window.msCrypto) && (e.config.viewId = t());
              for (var g = ["addon", "identify", "track", "trigger", "query", "segment", "segments", "ready", "on", "once", "user", "consent"], r = 0; r < g.length; r++) {
                  var w = g[r];
                  e[w] = function (o) {
                      return function () {
                          var n = Array.prototype.slice.call(arguments, 0);
                          e.q.push({
                              functionName: o,
                              arguments: n
                          })
                      }
                  }(w)
              }
          }
      }(window.permutive, "bca90777-e088-4f2a-96c2-13ad18deeccc", "18ad0c5b-460c-4d19-a729-dc537805538f", {});
      window.googletag = window.googletag || {}, window.googletag.cmd = window.googletag.cmd || [], window.googletag.cmd.push(function () {
          if (0 === window.googletag.pubads().getTargeting("permutive").length) {
              var e = window.localStorage.getItem("_pdfps");
              window.googletag.pubads().setTargeting("permutive", e ? JSON.parse(e) : []);
              var o = window.localStorage.getItem("permutive-id");
              o && (window.googletag.pubads().setTargeting("puid", o), window.googletag.pubads().setTargeting("ptime", Date.now().toString())), window.permutive.config.viewId && window.googletag.pubads().setTargeting("prmtvvid", window.permutive.config.viewId), window.permutive.config.workspaceId && window.googletag.pubads().setTargeting("prmtvwid", window.permutive.config.workspaceId)
          }
      });


      permutive.addon('web', {
          'page': {
              'category': 'Microservices',
              'node': {
                  'authorCompany': 'DELLEMC',
                  'authors': [468979, ],
                  'publishDate': new Date(1539734400000),
                  'sponsorAuthor': false,
                  'tags': ['microservice', 'web service', 'mobile app', 'Database', 'Design', 'Relational database', 'requests', 'Circuit Breaker Pattern', 'data', 'Spring Cloud', ],
                  'title': 'Design Patterns for Microservices',
                  'type': 'article',
              },
              'section': 'article',
          }
      });
  </script>
  <script async src="https://18ad0c5b-460c-4d19-a729-dc537805538f.edge.permutive.app/18ad0c5b-460c-4d19-a729-dc537805538f-web.js"></script>

  <script>
      const csrf = '-8703321414112456592'
      const articleId = 2509239
      const likes = 205
      const assetDomain = 'https://dz2cdn2.dzone.com'
      const codemirrorVars = {
          modeURI: 'https://dz2cdn2.dzone.com/themes/dz20/lib/codemirror/mode/',
          requiredScripts: [
              'https://dz2cdn2.dzone.com/themes/dz20/lib/codemirror/lib/codemirror.js',
              'https://dz2cdn2.dzone.com/themes/dz20/lib/codemirror/mode/meta.js'
          ]
      }

      const gptTags = {
          'zone': 'microservices',
          'topicTag': 'microservice,web service,mobile app,Database,Design,Relational database,requests,Circuit Breaker Pattern,data,Spring Cloud',
          'company': '',
          'siteSection': 'Zones',
          'articleCategory': 'tutorial',
          'nodeID': '2509239',
          'authorID': '468979',
          'publishYear': '2018',
          'publishMonth': '10',
          'jobRole': '',
          'companySize': ''
      }

      const minCommentChar = 10;
      const peer39Enabled = true;
  </script>

  <script src="https://dz2cdn2.dzone.com/themes/dz20/lib/static/jquery/jquery.min.js"></script>
  <script async src="https://dz2cdn2.dzone.com/themes/dz20/lib/static/bootstrap/bootstrap.min.js"></script>
  <script async src="https://dz2cdn2.dzone.com/themes/dz20/ftl/article/ads.js"></script>



  <script>
      function loadScript(src) {
          return new Promise(function (resolve, reject) {
              const s = document.createElement('script')
              s.src = src
              s.onload = resolve
              s.onerror = reject
              document.head.appendChild(s)
          })
      }

      function loadStyle(href) {
          const link = document.createElement('link')
          link.rel = 'stylesheet'
          link.href = href
          document.head.appendChild(link)
      }

      function loadScriptsSync(deferred) {
          var p = Promise.resolve()
          for (var i = 0; i < deferred.length; i++) {
              let script = deferred[i]
              p = p.then(function() {
                  return loadScript(script)
              })
          }
          return p
      }

      function loadStyles() {
          const deferred = [
              'https://dz2cdn2.dzone.com/themes/dz20/lib/codemirror/lib/codemirror.css',
              'https://dz2cdn2.dzone.com/themes/dz20/ftl/comments/styles.css',
              'https://dz2cdn2.dzone.com/themes/dz20/lib/froala3/css/froala_editor.pkgd.min.css',
              'https://dz2cdn2.dzone.com/themes/dz20/lib/froala3/css/themes/gray.min.css',
              'https://dz2cdn2.dzone.com/themes/dz20/ftl/article/mini-profile.css'
          ]

          for (var i = 0; i < deferred.length; i++) {
              loadStyle(deferred[i])
          }
      }

      window.addEventListener('load', function(event) {
          loadStyles()
          loadScriptsSync([
              'https://dz2cdn2.dzone.com/themes/dz20/ftl/header/auth-status.js',
              'https://dz2cdn2.dzone.com/themes/dz20/lib/lazysizes.min.js',
              'https://dz2cdn2.dzone.com/themes/dz20/ftl/article/codeblocks.js',
              'https://dz2cdn2.dzone.com/themes/dz20/ftl/article/activity-bar.js',
              'https://dz2cdn2.dzone.com/themes/dz20/lib/froala3/js/froala_editor.pkgd.min.js',
              'https://dz2cdn2.dzone.com/themes/dz20/ftl/froala/content.js',
              'https://dz2cdn2.dzone.com/themes/dz20/ftl/comments/content.js',
              'https://dz2cdn2.dzone.com/themes/dz20/ftl/article/content.js'
          ])
      })
  </script>
</body>
</html>